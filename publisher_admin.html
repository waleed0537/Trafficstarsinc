<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Publisher Dashboard - TrafficStars</title>

    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 24px;
        }

        .settings-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 32px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
        }

        .settings-card.danger-zone {
            border-color: rgba(239, 68, 68, 0.2);
        }

        .settings-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
        }

        .settings-card-title {
            font-size: 20px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .settings-card-subtitle {
            font-size: 14px;
            color: #64748b;
        }

        .settings-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, rgba(23, 28, 107, 0.1) 0%, rgba(45, 78, 245, 0.1) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 52px;
            height: 28px;
            flex-shrink: 0;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #cbd5e1;
            transition: 0.3s;
            border-radius: 28px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        input:checked+.toggle-slider {
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
        }

        input:checked+.toggle-slider:before {
            transform: translateX(24px);
        }

        /* Notification Items */
        .notification-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(23, 28, 107, 0.06);
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-info {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .notification-desc {
            font-size: 14px;
            color: #64748b;
        }

        /* Session Item */
        .session-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: rgba(248, 250, 255, 0.8);
            border-radius: 12px;
            margin-bottom: 12px;
        }

        .session-info {
            flex: 1;
        }

        .session-device {
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .session-details {
            font-size: 13px;
            color: #64748b;
        }

        .session-current {
            display: inline-block;
            padding: 4px 8px;
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            margin-top: 4px;
        }
.user-dropdown {
        position: relative;
        cursor: pointer;
        margin-left: 20px;
    }

    .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 16px;
        transition: transform 0.2s;
    }

    .user-dropdown:hover .user-avatar {
        transform: scale(1.05);
    }

    .user-dropdown-menu {
        position: absolute;
        top: calc(100% + 10px);
        right: 0;
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        min-width: 200px;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: all 0.3s ease;
        z-index: 1000;
    }

    .user-dropdown-menu.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }

    .user-dropdown-menu::before {
        content: '';
        position: absolute;
        top: -6px;
        right: 15px;
        width: 12px;
        height: 12px;
        background: white;
        transform: rotate(45deg);
    }

    .dropdown-item-custom {
        padding: 12px 20px;
        display: flex;
        align-items: center;
        gap: 12px;
        color: #333;
        text-decoration: none;
        transition: background-color 0.2s;
        cursor: pointer;
    }

    .dropdown-item-custom:first-child {
        border-radius: 8px 8px 0 0;
    }

    .dropdown-item-custom:last-child {
        border-radius: 0 0 8px 8px;
    }

    .dropdown-item-custom:hover {
        background-color: #f8f9fa;
    }

    .dropdown-item-custom svg {
        width: 20px;
        height: 20px;
        stroke: currentColor;
    }

    .dropdown-divider-custom {
        height: 1px;
        background-color: #e9ecef;
        margin: 0;
    }
        /* Danger Button */
        .btn-danger {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(220, 38, 38, 0.3);
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(220, 38, 38, 0.4);
        }

        /* Mobile Responsive */
        @media (max-width: 1200px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .settings-card {
                padding: 24px 20px;
            }

            .notification-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .toggle-switch {
                align-self: flex-end;
            }

            .session-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }
        }

        @media (max-width: 480px) {
            .settings-card-header {
                flex-direction: column;
                gap: 16px;
            }

            .settings-icon {
                align-self: flex-start;
            }
        }

        .analytics-metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 24px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
            display: flex;
            align-items: flex-start;
            gap: 16px;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(23, 28, 107, 0.12);
        }

        .metric-icon {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            flex-shrink: 0;
        }

        .metric-content {
            flex: 1;
        }

        .metric-label {
            font-size: 13px;
            color: #64748b;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 28px;
            font-weight: 800;
            color: #171C6B;
            line-height: 1;
            margin-bottom: 8px;
        }

        .metric-change {
            font-size: 13px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .metric-change.positive {
            color: #10b981;
        }

        .metric-change.negative {
            color: #ef4444;
        }

        .metric-change span:first-child {
            font-size: 16px;
        }

        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin-bottom: 32px;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 28px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .chart-title {
            font-size: 20px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .chart-subtitle {
            font-size: 14px;
            color: #64748b;
        }

        .chart-legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: #64748b;
            font-weight: 500;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        /* Analytics Grid */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin-bottom: 32px;
        }

        .analytics-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 28px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
        }

        .card-header-analytics {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .btn-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            border: 1px solid rgba(23, 28, 107, 0.15);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .btn-icon:hover {
            background: #171C6B;
            color: white;
            transform: translateX(2px);
        }

        /* Geographic List */
        .geo-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .geo-item {
            display: grid;
            grid-template-columns: auto 1fr auto auto;
            gap: 12px;
            align-items: center;
            padding: 16px;
            background: rgba(248, 250, 255, 0.8);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .geo-item:hover {
            background: rgba(23, 28, 107, 0.05);
            transform: translateX(4px);
        }

        .geo-flag {
            font-size: 24px;
        }

        .geo-country {
            font-weight: 600;
            color: #171C6B;
        }

        .geo-stats {
            text-align: right;
            font-size: 13px;
            color: #64748b;
        }

        .geo-revenue {
            font-weight: 700;
            color: #10b981;
            font-size: 15px;
        }

        /* Placements List */
        .placements-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .placement-item {
            padding: 16px;
            background: rgba(248, 250, 255, 0.8);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .placement-item:hover {
            background: rgba(23, 28, 107, 0.05);
        }

        .placement-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .placement-item-name {
            font-weight: 600;
            color: #171C6B;
            font-size: 15px;
        }

        .placement-item-revenue {
            font-weight: 700;
            color: #10b981;
            font-size: 16px;
        }

        .placement-item-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .placement-stat {
            text-align: center;
        }

        .placement-stat-value {
            font-weight: 600;
            color: #171C6B;
            font-size: 14px;
        }

        .placement-stat-label {
            font-size: 11px;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Additional Metrics */
        .additional-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 32px;
        }

        .metrics-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 28px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
        }

        .section-title-small {
            font-size: 16px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 20px;
        }

        .metrics-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
        }

        .metric-label-small {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
        }

        .metric-value-small {
            font-size: 15px;
            font-weight: 700;
            color: #171C6B;
        }

        .metric-bar-container {
            flex: 1;
            height: 8px;
            background: rgba(23, 28, 107, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .metric-bar {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            border-radius: 4px;
            transition: width 1s ease;
        }

        /* Visitor Chart */
        .visitor-chart {
            display: flex;
            height: 60px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .visitor-segment {
            display: flex;
            align-items: center;
            justify-content: center;
            transition: width 1s ease;
        }

        .visitor-label {
            color: white;
            font-weight: 600;
            font-size: 14px;
        }

        /* Mobile Responsive */
        @media (max-width: 1200px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }

            .chart-card {
                grid-column: span 1 !important;
            }
        }

        @media (max-width: 768px) {
            .analytics-metrics-grid {
                grid-template-columns: 1fr;
            }

            .analytics-grid {
                grid-template-columns: 1fr;
            }

            .additional-metrics {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 250px;
            }

            .metric-card {
                padding: 20px;
            }

            .metric-icon {
                width: 48px;
                height: 48px;
                font-size: 20px;
            }

            .metric-value {
                font-size: 24px;
            }

            .chart-legend {
                gap: 12px;
            }
        }

        @media (max-width: 480px) {
            .geo-item {
                grid-template-columns: auto 1fr;
                gap: 8px;
            }

            .geo-stats,
            .geo-revenue {
                grid-column: 2;
            }

            .placement-item-stats {
                grid-template-columns: 1fr;
            }
        }

        .btn-primary {
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(23, 28, 107, 0.2);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(23, 28, 107, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: white;
            color: #171C6B;
            padding: 12px 24px;
            border: 2px solid #171C6B;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: #171C6B;
            color: white;
        }

        .payment-fields {
            margin-top: 20px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .website-status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .status-approved {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .status-rejected {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .status-under_review {
            background: rgba(59, 130, 246, 0.1);
            color: #2563eb;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        /* ==========================================================================
   MOBILE RESPONSIVE ENHANCEMENTS
   Add this CSS to both advertiser_admin.html and publisher_admin.html
   ========================================================================== */

        /* Mobile Navigation Toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 24px;
            color: #171C6B;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        /* =============================================================================
   ADD THIS CSS TO YOUR EXISTING <style> SECTION
   ========================================================================== */

        /* Placement Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(4px);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .placement-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: white;
            border-radius: 24px;
            box-shadow: 0 32px 80px rgba(23, 28, 107, 0.3);
            z-index: 2001;
            max-width: 900px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-overlay.active .placement-modal {
            transform: translate(-50%, -50%) scale(1);
        }

        .modal-header {
            padding: 32px 32px 0;
            text-align: center;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: none;
            border: none;
            font-size: 24px;
            color: #64748b;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(23, 28, 107, 0.1);
            color: #171C6B;
        }

        .modal-title {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .modal-subtitle {
            font-size: 16px;
            color: #64748b;
            margin-bottom: 32px;
        }

        .modal-content {
            padding: 0 32px 32px;
        }

        .form-section {
            margin-bottom: 32px;
        }

        .section-title-modal {
            font-size: 18px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid rgba(23, 28, 107, 0.1);
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            color: #1a1a1a;
            background: rgba(248, 250, 255, 0.5);
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #2d4ef5;
            background: white;
            box-shadow: 0 0 0 4px rgba(45, 78, 245, 0.1);
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236B7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
            background-position: right 16px center;
            background-repeat: no-repeat;
            background-size: 20px;
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        /* Ad Type Cards */
        .ad-type-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .ad-type-card {
            padding: 24px 20px;
            border: 2px solid rgba(23, 28, 107, 0.1);
            border-radius: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(248, 250, 255, 0.5);
        }

        .ad-type-card:hover {
            border-color: rgba(45, 78, 245, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.1);
        }

        .ad-type-card.selected {
            border-color: #2d4ef5;
            background: linear-gradient(135deg, rgba(45, 78, 245, 0.1) 0%, rgba(45, 78, 245, 0.05) 100%);
        }

        .ad-type-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .ad-type-name {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .ad-type-desc {
            font-size: 13px;
            color: #64748b;
        }

        .form-actions {
            display: flex;
            gap: 16px;
            justify-content: flex-end;
            margin-top: 32px;
        }

        /* Placement Cards */
        .placements-section {
            margin-top: 48px;
        }

        .placements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 24px;
        }

        .placement-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 28px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
            transition: all 0.3s ease;
        }

        .placement-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(23, 28, 107, 0.12);
        }

        .placement-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 20px;
        }

        .placement-name {
            font-size: 20px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 6px;
        }

        .placement-url {
            font-size: 14px;
            color: #64748b;
            word-break: break-all;
        }

        .placement-type {
            display: inline-block;
            padding: 4px 12px;
            background: rgba(45, 78, 245, 0.1);
            color: #2d4ef5;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            margin-top: 8px;
        }

        .placement-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin: 20px 0;
            padding: 20px;
            background: rgba(248, 250, 255, 0.8);
            border-radius: 12px;
        }

        .stat-box {
            text-align: center;
        }

        .stat-box-value {
            font-size: 18px;
            font-weight: 700;
            color: #059669;
            margin-bottom: 4px;
        }

        .stat-box-label {
            font-size: 12px;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .placement-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 8px 16px;
            border: 1px solid rgba(23, 28, 107, 0.2);
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            color: #171C6B;
        }

        .action-btn:hover {
            background: #171C6B;
            color: white;
        }

        .action-btn.danger {
            border-color: rgba(239, 68, 68, 0.3);
            color: #dc2626;
        }

        .action-btn.danger:hover {
            background: #dc2626;
            color: white;
        }

        .action-btn.success {
            border-color: rgba(16, 185, 129, 0.3);
            color: #059669;
        }

        .action-btn.success:hover {
            background: #059669;
            color: white;
        }

        /* Loading & Empty States */
        .loading-spinner {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(23, 28, 107, 0.1);
            border-radius: 50%;
            border-top-color: #171C6B;
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state-title {
            font-size: 20px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 12px;
        }

        .empty-state-desc {
            font-size: 16px;
            color: #64748b;
            margin-bottom: 24px;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .placement-modal {
                width: 95%;
                max-height: 95vh;
            }

            .modal-header {
                padding: 24px 20px 0;
            }

            .modal-content {
                padding: 0 20px 24px;
            }

            .ad-type-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .form-actions {
                flex-direction: column;
            }

            .form-actions button {
                width: 100%;
            }

            .placements-grid {
                grid-template-columns: 1fr;
            }

            .placement-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                padding: 16px;
            }
        }

        .mobile-menu-toggle:hover {
            background: rgba(23, 28, 107, 0.1);
        }

        .mobile-nav-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .mobile-nav-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .mobile-nav-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 280px;
            height: 100vh;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            z-index: 2001;
            padding: 80px 24px 24px;
            transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
        }

        .mobile-nav-menu.active {
            right: 0;
        }

        .mobile-nav-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            color: #171C6B;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .mobile-nav-close:hover {
            background: rgba(23, 28, 107, 0.1);
        }

        .mobile-nav-item {
            display: block;
            padding: 16px 0;
            font-size: 18px;
            font-weight: 600;
            color: #171C6B;
            text-decoration: none;
            border-bottom: 1px solid rgba(23, 28, 107, 0.1);
            transition: all 0.3s ease;
        }

        .mobile-nav-item:hover {
            color: #2d4ef5;
            padding-left: 8px;
        }

        .mobile-nav-item.active {
            color: #2d4ef5;
            background: linear-gradient(90deg, rgba(45, 78, 245, 0.1) 0%, transparent 100%);
            margin: 0 -24px;
            padding: 16px 32px 16px 24px;
            border-radius: 12px;
        }

        /* Enhanced Mobile Header */
        @media (max-width: 1024px) {
            .nav-tabs {
                display: none;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .header-content {
                padding: 0 20px;
            }

            .user-section {
                gap: 16px;
            }

            .balance,
            .earnings {
                padding: 8px 12px;
                font-size: 13px;
            }

            .user-dropdown {
                padding: 6px 12px;
            }

            .user-name {
                display: none;
            }
        }

        /* Mobile Typography Scaling */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 28px !important;
                line-height: 1.2;
            }

            .section-title {
                font-size: 24px !important;
                margin-bottom: 16px;
            }

            .section-subtitle {
                font-size: 16px !important;
                line-height: 1.5;
            }

            .step-title {
                font-size: 18px !important;
                line-height: 1.3;
            }

            .content-title {
                font-size: 18px !important;
            }

            .welcome-description {
                font-size: 16px !important;
                line-height: 1.5;
            }
        }

        /* Mobile Layout Optimizations */
        @media (max-width: 768px) {
            .main-content {
                padding: 20px 16px !important;
            }

            .hero-section {
                grid-template-columns: 1fr !important;
                gap: 20px !important;
                margin-bottom: 32px !important;
            }

            .welcome-card {
                padding: 32px 24px !important;
                border-radius: 20px !important;
            }

            .stats-panel {
                padding: 24px 20px !important;
                border-radius: 20px !important;
            }

            .section-header {
                margin-bottom: 32px !important;
                padding: 0 8px;
            }

            .steps-grid {
                grid-template-columns: 1fr !important;
                gap: 16px !important;
            }

            .step-card {
                padding: 24px 20px !important;
                border-radius: 20px !important;
            }

            .content-grid {
                grid-template-columns: 1fr !important;
                gap: 20px !important;
            }

            .content-card {
                padding: 24px 20px !important;
                border-radius: 20px !important;
            }
        }

        /* Mobile Interactive Elements */
        @media (max-width: 768px) {
            .primary-btn {
                width: 100%;
                padding: 14px 24px !important;
                font-size: 15px !important;
            }

            .step-btn {
                padding: 12px 20px !important;
                font-size: 14px !important;
            }

            .stat-item {
                padding: 16px 0 !important;
            }

            .stat-value {
                font-size: 18px !important;
            }

            .faq-item,
            .news-item {
                padding: 16px 0 !important;
            }

            .faq-item:hover,
            .stat-item:hover {
                margin: 0 -12px !important;
                padding: 16px 12px !important;
            }
        }

        /* Small Mobile (320px - 480px) */
        @media (max-width: 480px) {
            .header-content {
                padding: 0 16px !important;
                height: 60px !important;
            }

            .logo {
                width: 32px !important;
                height: 32px !important;
                font-size: 16px !important;
            }

            .brand-name {
                font-size: 18px !important;
            }

            .balance,
            .earnings {
                font-size: 12px !important;
                padding: 6px 10px !important;
            }

            .user-avatar {
                width: 32px !important;
                height: 32px !important;
                font-size: 14px !important;
            }

            .main-content {
                padding: 16px 12px !important;
            }

            .welcome-card {
                padding: 24px 16px !important;
            }

            .stats-panel {
                padding: 20px 16px !important;
            }

            .step-card,
            .content-card {
                padding: 20px 16px !important;
            }

            .welcome-title {
                font-size: 24px !important;
            }

            .section-title {
                font-size: 20px !important;
            }

            .step-number {
                width: 28px !important;
                height: 28px !important;
                font-size: 12px !important;
            }
        }

        /* Touch Optimizations */
        @media (hover: none) and (pointer: coarse) {

            .step-card:hover,
            .faq-item:hover,
            .stat-item:hover,
            .news-item:hover {
                transform: none !important;
                background: none !important;
                margin: 0 !important;
                padding: 16px 0 !important;
            }

            .step-card:hover::before {
                opacity: 0 !important;
            }

            .primary-btn:hover,
            .step-btn:hover {
                transform: none !important;
                box-shadow: 0 8px 24px rgba(23, 28, 107, 0.25) !important;
            }
        }

        /* Active/Focus States for Mobile */
        @media (max-width: 768px) {
            .step-card:active {
                transform: scale(0.98);
                transition: transform 0.1s ease;
            }

            .primary-btn:active,
            .step-btn:active {
                transform: scale(0.96);
                transition: transform 0.1s ease;
            }

            .faq-item:active {
                background: rgba(23, 28, 107, 0.05);
                border-radius: 8px;
                margin: 0 -12px;
                padding: 16px 12px;
            }
        }

        /* Mobile Animation Refinements */
        @media (max-width: 768px) {
            .animate-in {
                animation-duration: 0.4s !important;
            }

            .welcome-card::before {
                width: 200px !important;
                height: 200px !important;
                transform: translate(50%, -50%) !important;
            }
        }

        /* Landscape Mobile Optimization */
        @media (max-width: 926px) and (orientation: landscape) {
            .header {
                position: relative !important;
            }

            .main-content {
                padding-top: 16px !important;
            }

            .welcome-card {
                padding: 24px 20px !important;
            }

            .hero-section {
                grid-template-columns: 1.5fr 1fr !important;
            }

            .steps-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
            }
        }

        /* High DPI/Retina Display Optimizations */
        @media (-webkit-min-device-pixel-ratio: 2),
        (min-resolution: 192dpi) {

            .logo,
            .user-avatar,
            .step-number {
                image-rendering: -webkit-optimize-contrast;
                image-rendering: crisp-edges;
            }
        }

        /* Dark Mode Support for Mobile */
        @media (prefers-color-scheme: dark) and (max-width: 768px) {
            .mobile-nav-menu {
                background: rgba(26, 26, 26, 0.98);
                border-left: 1px solid rgba(255, 255, 255, 0.1);
            }

            .mobile-nav-item {
                color: #e2e8f0;
                border-bottom-color: rgba(255, 255, 255, 0.1);
            }

            .mobile-nav-close,
            .mobile-menu-toggle {
                color: #e2e8f0;
            }
        }

        body {
            background: linear-gradient(135deg, #f8faff 0%, #ffffff 100%);
            min-height: 100vh;
            font-weight: 400;
            line-height: 1.6;
            color: #1a1a1a;
        }

        /* Premium Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(23, 28, 107, 0.08);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 32px;
            height: 72px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 18px;
            box-shadow: 0 4px 16px rgba(23, 28, 107, 0.2);
        }

        .brand-name {
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-tabs {
            display: flex;
            gap: 4px;
            background: rgba(23, 28, 107, 0.04);
            padding: 6px;
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .nav-tab {
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            color: #64748b;
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: none;
            background: transparent;
            position: relative;
            overflow: hidden;
        }

        .nav-tab:hover {
            color: #171C6B;
            background: rgba(255, 255, 255, 0.8);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            color: white;
            box-shadow: 0 4px 16px rgba(23, 28, 107, 0.3);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .earnings {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            border-radius: 12px;
            font-weight: 600;
            color: #059669;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .user-dropdown {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            border: 1px solid rgba(23, 28, 107, 0.08);
        }

        .user-dropdown:hover {
            background: #f8faff;
            border-color: rgba(23, 28, 107, 0.15);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
        }

        .user-name {
            font-weight: 600;
            color: #171C6B;
        }

        /* Main Content */
        .main-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 48px 32px;
        }

        /* Hero Section */
        .hero-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 32px;
            margin-bottom: 48px;
        }

        .welcome-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 250, 255, 0.9) 100%);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 48px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 20px 60px rgba(23, 28, 107, 0.08);
        }

        .welcome-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(45, 78, 245, 0.08) 0%, transparent 70%);
            transform: translate(30%, -30%);
            pointer-events: none;
        }

        .welcome-header {
            position: relative;
            z-index: 1;
        }

        .greeting {
            font-size: 16px;
            color: #64748b;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .welcome-title {
            font-size: 42px;
            font-weight: 800;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
            margin-bottom: 16px;
        }

        .user-role {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            color: #059669;
            border: 1px solid rgba(16, 185, 129, 0.2);
            margin-bottom: 24px;
        }

        .welcome-description {
            font-size: 18px;
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 32px;
            max-width: 500px;
        }

        .primary-btn {
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            color: white;
            padding: 16px 32px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 24px rgba(23, 28, 107, 0.25);
            position: relative;
            overflow: hidden;
        }

        .primary-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(23, 28, 107, 0.35);
        }

        .primary-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .primary-btn:hover::before {
            left: 100%;
        }

        /* Stats Panel */
        .stats-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 32px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 20px 60px rgba(23, 28, 107, 0.08);
        }

        .stats-title {
            font-size: 20px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 24px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(23, 28, 107, 0.06);
            transition: all 0.3s ease;
        }

        .stat-item:hover {
            background: linear-gradient(135deg, rgba(23, 28, 107, 0.02) 0%, transparent 100%);
            margin: 0 -16px;
            padding: 20px 16px;
            border-radius: 12px;
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-label {
            font-size: 15px;
            color: #64748b;
            font-weight: 500;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-value.blue {
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Steps Section */
        .steps-section {
            margin-bottom: 48px;
        }

        .section-header {
            text-align: center;
            margin-bottom: 48px;
        }

        .section-title {
            font-size: 36px;
            font-weight: 800;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 12px;
        }

        .section-subtitle {
            font-size: 18px;
            color: #64748b;
            max-width: 600px;
            margin: 0 auto;
        }

        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 24px;
        }

        .step-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px 32px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
        }

        .step-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(23, 28, 107, 0.15);
            border-color: rgba(23, 28, 107, 0.15);
        }

        .step-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .step-card:hover::before {
            opacity: 1;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            color: white;
            border-radius: 50%;
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 24px;
        }

        .step-title {
            font-size: 22px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 12px;
            line-height: 1.3;
        }

        .step-description {
            font-size: 16px;
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 24px;
        }

        .step-btn {
            background: transparent;
            color: #171C6B;
            padding: 12px 24px;
            border: 2px solid #171C6B;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .step-btn:hover {
            background: #171C6B;
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 8px 24px rgba(23, 28, 107, 0.25);
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }

        .content-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 32px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
        }

        .content-title {
            font-size: 22px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 24px;
        }

        .faq-item {
            padding: 20px 0;
            border-bottom: 1px solid rgba(23, 28, 107, 0.06);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .faq-item:hover {
            background: linear-gradient(135deg, rgba(23, 28, 107, 0.02) 0%, transparent 100%);
            margin: 0 -20px;
            padding: 20px;
            border-radius: 12px;
        }

        .faq-item:last-child {
            border-bottom: none;
        }

        .faq-question {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 6px;
        }

        .faq-category {
            font-size: 14px;
            color: #64748b;
        }

        .news-item {
            padding: 24px 0;
            border-bottom: 1px solid rgba(23, 28, 107, 0.06);
        }

        .news-item:last-child {
            border-bottom: none;
        }

        .news-title {
            font-size: 18px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .news-excerpt {
            font-size: 15px;
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .news-meta {
            font-size: 13px;
            color: #94a3b8;
            font-weight: 500;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .hero-section {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .nav-tabs {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 24px 16px;
            }

            .header-content {
                padding: 0 16px;
            }

            .welcome-title {
                font-size: 32px;
            }

            .section-title {
                font-size: 28px;
            }

            .steps-grid {
                grid-template-columns: 1fr;
            }

            .content-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-in {
            animation: fadeInUp 0.6s ease forwards;
        }
    </style>
</head>

<body>
    <!-- Premium Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo">T</div>
                <span class="brand-name">TrafficStars</span>
            </div>

            <nav class="nav-tabs">
                <button class="nav-tab active" onclick="switchSection('dashboard')">Dashboard</button>
                <button class="nav-tab" onclick="openPlacementModal()">Add Placement</button>
                <button class="nav-tab" onclick="switchSection('my-placements')">My Placements</button>
                <button class="nav-tab" onclick="switchSection('my-websites')">My Websites</button>
                <button class="nav-tab" onclick="switchSection('analytics')">Analytics</button>
                <button class="nav-tab" onclick="switchSection('settings')">Settings</button>
            </nav>

            <div class="user-section">
                <div class="earnings">
                    <span>Earnings: $0.00 USD</span>
                </div>
                <div class="user-dropdown" onclick="toggleUserMenu(event)">
    <div class="user-avatar">
        JD
    </div>
    <div class="user-dropdown-menu">
        <a onclick="switchSection('settings')" class="dropdown-item-custom">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <span>Settings</span>
        </a>
        <div class="dropdown-divider-custom"></div>
        <a onclick="logout()" class="dropdown-item-custom">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
            </svg>
            <span>Logout</span>
        </a>
    </div>
</div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section - ALL dashboard content must be inside this -->
        <section id="dashboard-section">
            <!-- Hero Section -->
            <section class="hero-section">
                <div class="welcome-card animate-in">
                    <div class="welcome-header">
                        <div class="greeting">Good evening</div>
                        <h1 class="welcome-title">Welcome back</h1>
                        <div class="user-role">
                            <span></span>
                            <span>Publisher Account</span>
                        </div>
                        <p class="welcome-description">
                            Ready to maximize your revenue? Access premium ad inventory, advanced optimization tools,
                            and detailed analytics to boost your earnings.
                        </p>
                        <button class="primary-btn" onclick="addPlacement()">
                            Add New Placement
                        </button>
                    </div>
                </div>

                <div class="stats-panel animate-in">
                    <h3 class="stats-title">Revenue Overview</h3>
                    <div class="stat-item">
                        <span class="stat-label">Total Revenue</span>
                        <span class="stat-value">$0.00</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Today's Earnings</span>
                        <span class="stat-value">$0.00</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Total Impressions</span>
                        <span class="stat-value blue">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Total Clicks</span>
                        <span class="stat-value blue">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Average RPM</span>
                        <span class="stat-value">$0.00</span>
                    </div>
                </div>
            </section>

            <!-- Steps Section -->
            <section class="steps-section">
                <div class="section-header">
                    <h2 class="section-title">Get Started in 3 Steps</h2>
                    <p class="section-subtitle">
                        Everything you need to start monetizing your traffic with our premium advertising network
                    </p>
                </div>

                <div class="steps-grid">
                    <div class="step-card animate-in">
                        <div class="step-number">1</div>
                        <h3 class="step-title">Complete Publisher Profile</h3>
                        <p class="step-description">
                            Set up your publisher profile with website details, traffic information, and payment
                            preferences
                            for seamless monetization.
                        </p>
                        <button class="step-btn" onclick="setupProfile()">Setup Profile</button>
                    </div>

                    <div class="step-card animate-in">
                        <div class="step-number">2</div>
                        <h3 class="step-title">Add Your Properties</h3>
                        <p class="step-description">
                            Submit your websites, mobile apps, or other digital properties for approval to start
                            displaying
                            premium advertisements.
                        </p>
                        <button class="step-btn" onclick="addWebsite()">Add Website</button>
                    </div>

                    <div class="step-card animate-in">
                        <div class="step-number">3</div>
                        <h3 class="step-title">Create Ad Placements</h3>
                        <p class="step-description">
                            Generate ad codes and place them on your sites to start earning revenue from high-quality
                            advertisers in our network.
                        </p>
                        <button class="step-btn" onclick="addPlacement()">Create Placement</button>
                    </div>
                </div>
            </section>

            <!-- Content Grid -->
            <section class="content-grid">
                <div class="content-card animate-in">
                    <h3 class="content-title">Publisher Resources</h3>

                    <div class="faq-item" onclick="expandHelp(this)">
                        <div class="faq-question">Website Approval Process</div>
                        <div class="faq-category">Getting started guide</div>
                    </div>

                    <div class="faq-item" onclick="expandHelp(this)">
                        <div class="faq-question">Maximize Your RPM & Revenue</div>
                        <div class="faq-category">Optimization strategies</div>
                    </div>

                    <div class="faq-item" onclick="expandHelp(this)">
                        <div class="faq-question">Ad Placement Best Practices</div>
                        <div class="faq-category">Layout and positioning</div>
                    </div>

                    <div class="faq-item" onclick="expandHelp(this)">
                        <div class="faq-question">Payment & Payout Options</div>
                        <div class="faq-category">Financial information</div>
                    </div>
                </div>

                <div class="content-card animate-in">
                    <h3 class="content-title">Platform Updates</h3>

                    <div class="news-item">
                        <div class="news-title">Enhanced Revenue Optimization</div>
                        <p class="news-excerpt">New AI-powered algorithms automatically optimize ad placements to
                            maximize
                            your revenue potential.</p>
                        <div class="news-meta">2 hours ago  Revenue Features</div>
                    </div>

                    <div class="news-item">
                        <div class="news-title">Mobile Ad Format Updates</div>
                        <p class="news-excerpt">Improved mobile ad formats with better user experience and higher
                            engagement
                            rates for publishers.</p>
                        <div class="news-meta">1 day ago  Mobile Optimization</div>
                    </div>

                    <div class="news-item">
                        <div class="news-title">New Analytics Dashboard</div>
                        <p class="news-excerpt">Comprehensive reporting suite with advanced metrics, heatmaps, and
                            performance insights for publishers.</p>
                        <div class="news-meta">3 days ago  Analytics</div>
                    </div>
                </div>
            </section>
            <!-- =============================================================================
     ADD THIS HTML SECTION AFTER YOUR EXISTING CONTENT GRID (before closing </main>)
     ========================================================================== -->
        </section>

        <!-- My Placements Section -->
        <section class="placements-section" id="my-placements-section" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">My Ad Placements</h2>
                <p class="section-subtitle">Manage your ad placements and monitor performance</p>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
                <button class="btn-secondary" onclick="refreshPlacements()">
                     Refresh
                </button>
                <button class="primary-btn" onclick="openPlacementModal()">
                     Add New Placement
                </button>
            </div>

            <div id="placementsContainer">
                <div id="placementsLoading" class="loading-spinner">
                    <div class="spinner"></div>
                    <div>Loading placements...</div>
                </div>
                <div id="noPlacements" class="empty-state" style="display: none;">
                    <div class="empty-state-icon"></div>
                    <h3 class="empty-state-title">No placements yet</h3>
                    <p class="empty-state-desc">Create your first ad placement to start earning revenue.</p>
                    <button class="primary-btn" onclick="openPlacementModal()">
                        Create First Placement
                    </button>
                </div>
                <div id="placementsList" class="placements-grid"></div>
            </div>
        </section>

        <!-- =============================================================================
     ADD THIS MODAL HTML BEFORE CLOSING </body> TAG
     ========================================================================== -->

        <!-- Placement Creation Modal -->
        <div class="modal-overlay" id="placementModal">
            <div class="placement-modal">
                <div class="modal-header">
                    <button class="modal-close" onclick="closePlacementModal()"></button>
                    <h2 class="modal-title">Create New Ad Placement</h2>
                    <p class="modal-subtitle">Configure your ad placement to start monetizing your traffic</p>
                </div>

                <div class="modal-content">
                    <form id="placementForm" onsubmit="handlePlacementSubmit(event)">

                        <!-- Basic Information -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Basic Information
                            </h3>

                            <div class="form-group">
                                <label class="form-label">Placement Name *</label>
                                <input type="text" class="form-input" name="placementName"
                                    placeholder="e.g., Homepage Banner" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Website URL *</label>
                                <input type="url" class="form-input" name="websiteUrl"
                                    placeholder="https://yourwebsite.com" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <textarea class="form-input form-textarea" name="description"
                                    placeholder="Describe the placement location and audience..."></textarea>
                            </div>
                        </div>

                        <!-- Ad Type Selection -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Ad Format
                            </h3>

                            <div class="ad-type-grid">
                                <div class="ad-type-card" data-type="banner" onclick="selectAdType(this)">
                                    <div class="ad-type-icon"></div>
                                    <div class="ad-type-name">Banner</div>
                                    <div class="ad-type-desc">Display ads</div>
                                </div>

                                <div class="ad-type-card" data-type="native" onclick="selectAdType(this)">
                                    <div class="ad-type-icon"></div>
                                    <div class="ad-type-name">Native</div>
                                    <div class="ad-type-desc">Blend with content</div>
                                </div>

                                <div class="ad-type-card" data-type="video" onclick="selectAdType(this)">
                                    <div class="ad-type-icon"></div>
                                    <div class="ad-type-name">Video</div>
                                    <div class="ad-type-desc">Video ads</div>
                                </div>

                                <div class="ad-type-card" data-type="popup" onclick="selectAdType(this)">
                                    <div class="ad-type-icon"></div>
                                    <div class="ad-type-name">Popup</div>
                                    <div class="ad-type-desc">Overlay ads</div>
                                </div>

                                <div class="ad-type-card" data-type="mobile" onclick="selectAdType(this)">
                                    <div class="ad-type-icon"></div>
                                    <div class="ad-type-name">Mobile</div>
                                    <div class="ad-type-desc">Mobile optimized</div>
                                </div>
                            </div>

                            <input type="hidden" name="placementType" id="placementType" required>
                        </div>

                        <!-- Ad Specifications -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Specifications
                            </h3>

                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Ad Size *</label>
                                    <select class="form-input form-select" name="adSize" required>
                                        <option value="">Select size</option>
                                        <option value="728x90">728x90 (Leaderboard)</option>
                                        <option value="300x250">300x250 (Medium Rectangle)</option>
                                        <option value="336x280">336x280 (Large Rectangle)</option>
                                        <option value="160x600">160x600 (Wide Skyscraper)</option>
                                        <option value="320x50">320x50 (Mobile Banner)</option>
                                        <option value="300x600">300x600 (Half Page)</option>
                                        <option value="970x250">970x250 (Billboard)</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Category *</label>
                                    <select class="form-input form-select" name="category" required>
                                        <option value="">Select category</option>
                                        <option value="technology">Technology</option>
                                        <option value="entertainment">Entertainment</option>
                                        <option value="business">Business</option>
                                        <option value="lifestyle">Lifestyle</option>
                                        <option value="health">Health & Fitness</option>
                                        <option value="education">Education</option>
                                        <option value="gaming">Gaming</option>
                                        <option value="news">News</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Pricing Configuration -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Pricing
                            </h3>

                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Pricing Model *</label>
                                    <select class="form-input form-select" name="pricingModel" required>
                                        <option value="cpm">CPM (Cost Per Mille)</option>
                                        <option value="cpc">CPC (Cost Per Click)</option>
                                        <option value="cpa">CPA (Cost Per Action)</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Rate (USD) *</label>
                                    <input type="number" class="form-input" name="rate" placeholder="5.00" step="0.01"
                                        min="0.01" value="5.00" required>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Minimum Bid (USD)</label>
                                    <input type="number" class="form-input" name="minimumBid" placeholder="3.00"
                                        step="0.01" min="0.01" value="3.00">
                                </div>
                            </div>
                        </div>

                        <!-- Target Audience -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Target Audience
                            </h3>

                            <div class="form-group">
                                <label class="form-label">Demographics</label>
                                <input type="text" class="form-input" name="demographics"
                                    placeholder="e.g., 18-35, Male/Female, Urban">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Interests</label>
                                <input type="text" class="form-input" name="interests"
                                    placeholder="e.g., Technology, Gaming, Fashion">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Geographic Targeting</label>
                                <input type="text" class="form-input" name="geoTargeting"
                                    placeholder="e.g., United States, UK, Worldwide" value="Worldwide">
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn-secondary" onclick="closePlacementModal()">
                                Cancel
                            </button>
                            <button type="submit" class="btn-primary" id="submitPlacementBtn">
                                <span id="submitBtnText">Create Placement</span>
                                <span id="submitBtnSpinner" class="spinner"
                                    style="display: none; width: 16px; height: 16px; border-width: 2px;"></span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Toast Container (add if not exists) -->
        <div id="toastContainer" style="position: fixed; top: 20px; right: 20px; z-index: 3000;"></div>


        <div class="modal-overlay" id="profileModal">
            <div class="placement-modal" style="max-width: 800px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="closeProfileModal()"></button>
                    <h2 class="modal-title">Complete Your Publisher Profile</h2>
                    <p class="modal-subtitle">Provide your information for account verification and payments</p>
                </div>

                <div class="modal-content">
                    <form id="profileForm" onsubmit="handleProfileSubmit(event)">

                        <!-- Personal Information -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Personal Information
                            </h3>

                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Full Name *</label>
                                    <input type="text" class="form-input" name="name" placeholder="John Doe" required>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Email Address</label>
                                    <input type="email" class="form-input" name="email" placeholder="john@example.com"
                                        readonly>
                                </div>
                            </div>

                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Company Name</label>
                                    <input type="text" class="form-input" name="company"
                                        placeholder="Your Company Inc.">
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Phone Number</label>
                                    <input type="tel" class="form-input" name="phone" placeholder="+1 (555) 123-4567">
                                </div>
                            </div>
                        </div>

                        <!-- Address Information -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Address Information
                            </h3>

                            <div class="form-group">
                                <label class="form-label">Street Address</label>
                                <input type="text" class="form-input" name="address" placeholder="123 Main Street">
                            </div>

                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">City</label>
                                    <input type="text" class="form-input" name="city" placeholder="New York">
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Zip/Postal Code</label>
                                    <input type="text" class="form-input" name="zipCode" placeholder="10001">
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Country *</label>
                                    <select class="form-input form-select" name="country" required>
                                        <option value="">Select country</option>
                                        <option value="US">United States</option>
                                        <option value="GB">United Kingdom</option>
                                        <option value="CA">Canada</option>
                                        <option value="AU">Australia</option>
                                        <option value="DE">Germany</option>
                                        <option value="FR">France</option>
                                        <option value="ES">Spain</option>
                                        <option value="IT">Italy</option>
                                        <option value="NL">Netherlands</option>
                                        <option value="IN">India</option>
                                        <option value="BR">Brazil</option>
                                        <option value="MX">Mexico</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Tax Information -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Tax Information
                            </h3>

                            <div class="form-group">
                                <label class="form-label">Tax ID / VAT Number</label>
                                <input type="text" class="form-input" name="taxId"
                                    placeholder="Tax identification number">
                                <small style="color: #64748b; font-size: 13px; display: block; margin-top: 6px;">
                                    Required for tax reporting purposes
                                </small>
                            </div>
                        </div>

                        <!-- Payment Method -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Payment Method
                            </h3>

                            <div class="form-group">
                                <label class="form-label">Payment Method *</label>
                                <select class="form-input form-select" name="paymentMethod"
                                    onchange="togglePaymentFields(this.value)" required>
                                    <option value="bank_transfer">Bank Transfer</option>
                                    <option value="paypal">PayPal</option>
                                    <option value="wire">Wire Transfer</option>
                                    <option value="crypto">Cryptocurrency</option>
                                </select>
                            </div>

                            <!-- Bank Transfer Fields -->
                            <div id="bankTransferFields" class="payment-fields">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label class="form-label">Bank Name</label>
                                        <input type="text" class="form-input" name="bankName"
                                            placeholder="Bank of America">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Account Number</label>
                                        <input type="text" class="form-input" name="accountNumber"
                                            placeholder="1234567890">
                                    </div>
                                </div>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label class="form-label">Routing Number</label>
                                        <input type="text" class="form-input" name="routingNumber"
                                            placeholder="123456789">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">SWIFT/BIC Code</label>
                                        <input type="text" class="form-input" name="swiftCode" placeholder="BOFAUS3N">
                                    </div>
                                </div>
                            </div>

                            <!-- PayPal Fields -->
                            <div id="paypalFields" class="payment-fields" style="display: none;">
                                <div class="form-group">
                                    <label class="form-label">PayPal Email</label>
                                    <input type="email" class="form-input" name="paypalEmail"
                                        placeholder="payments@example.com">
                                </div>
                            </div>

                            <!-- Crypto Fields -->
                            <div id="cryptoFields" class="payment-fields" style="display: none;">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label class="form-label">Cryptocurrency</label>
                                        <select class="form-input form-select" name="cryptoType">
                                            <option value="btc">Bitcoin (BTC)</option>
                                            <option value="eth">Ethereum (ETH)</option>
                                            <option value="usdt">Tether (USDT)</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Wallet Address</label>
                                        <input type="text" class="form-input" name="walletAddress" placeholder="0x...">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn-secondary" onclick="closeProfileModal()">
                                Cancel
                            </button>
                            <button type="submit" class="btn-primary" id="submitProfileBtn">
                                <span id="profileBtnText">Save Profile</span>
                                <span id="profileBtnSpinner" class="spinner"
                                    style="display: none; width: 16px; height: 16px; border-width: 2px;"></span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Add Website Modal -->
        <div class="modal-overlay" id="websiteModal">
            <div class="placement-modal" style="max-width: 900px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="closeWebsiteModal()"></button>
                    <h2 class="modal-title">Add Your Website</h2>
                    <p class="modal-subtitle">Submit your website for approval to start monetizing</p>
                </div>

                <div class="modal-content">
                    <form id="websiteForm" onsubmit="handleWebsiteSubmit(event)">

                        <!-- Basic Information -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Website Information
                            </h3>

                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Website Name *</label>
                                    <input type="text" class="form-input" name="websiteName"
                                        placeholder="My Awesome Website" required>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Website URL *</label>
                                    <input type="url" class="form-input" name="websiteUrl"
                                        placeholder="https://yourwebsite.com" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Category *</label>
                                <select class="form-input form-select" name="category" required>
                                    <option value="">Select category</option>
                                    <option value="technology">Technology</option>
                                    <option value="entertainment">Entertainment</option>
                                    <option value="business">Business & Finance</option>
                                    <option value="lifestyle">Lifestyle</option>
                                    <option value="health">Health & Fitness</option>
                                    <option value="education">Education</option>
                                    <option value="gaming">Gaming</option>
                                    <option value="news">News & Media</option>
                                    <option value="travel">Travel</option>
                                    <option value="food">Food & Cooking</option>
                                    <option value="sports">Sports</option>
                                    <option value="fashion">Fashion & Beauty</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Website Description</label>
                                <textarea class="form-input form-textarea" name="description"
                                    placeholder="Describe your website content, audience, and purpose..."></textarea>
                            </div>
                        </div>

                        <!-- Traffic Statistics -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Traffic Statistics
                            </h3>

                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Monthly Visitors</label>
                                    <select class="form-input form-select" name="monthlyVisitors">
                                        <option value="">Select range</option>
                                        <option value="0-1k">Less than 1,000</option>
                                        <option value="1k-10k">1,000 - 10,000</option>
                                        <option value="10k-50k">10,000 - 50,000</option>
                                        <option value="50k-100k">50,000 - 100,000</option>
                                        <option value="100k-500k">100,000 - 500,000</option>
                                        <option value="500k+">500,000+</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Monthly Page Views</label>
                                    <select class="form-input form-select" name="pageViews">
                                        <option value="">Select range</option>
                                        <option value="0-5k">Less than 5,000</option>
                                        <option value="5k-25k">5,000 - 25,000</option>
                                        <option value="25k-100k">25,000 - 100,000</option>
                                        <option value="100k-500k">100,000 - 500,000</option>
                                        <option value="500k-1m">500,000 - 1M</option>
                                        <option value="1m+">1M+</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Avg. Session Duration</label>
                                    <select class="form-input form-select" name="avgSessionDuration">
                                        <option value="">Select range</option>
                                        <option value="0-1min">Less than 1 min</option>
                                        <option value="1-3min">1-3 minutes</option>
                                        <option value="3-5min">3-5 minutes</option>
                                        <option value="5-10min">5-10 minutes</option>
                                        <option value="10min+">10+ minutes</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Audience Information -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Audience Information
                            </h3>

                            <div class="form-group">
                                <label class="form-label">Primary Geographic Region</label>
                                <select class="form-input form-select" name="primaryRegion">
                                    <option value="">Select region</option>
                                    <option value="north-america">North America</option>
                                    <option value="europe">Europe</option>
                                    <option value="asia">Asia</option>
                                    <option value="south-america">South America</option>
                                    <option value="africa">Africa</option>
                                    <option value="oceania">Oceania</option>
                                    <option value="worldwide">Worldwide</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Target Demographics</label>
                                <input type="text" class="form-input" name="demographics"
                                    placeholder="e.g., 18-35, Male/Female, Professionals">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Audience Interests</label>
                                <input type="text" class="form-input" name="interests"
                                    placeholder="e.g., Technology, Business, Innovation">
                            </div>
                        </div>

                        <!-- Monetization -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon"></span>
                                Monetization Status
                            </h3>

                            <div class="form-group">
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" name="currentlyMonetized"
                                        style="width: 20px; height: 20px; cursor: pointer;">
                                    <span class="form-label" style="margin: 0;">
                                        This website is currently monetized
                                    </span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Current Monetization Methods (if any)</label>
                                <input type="text" class="form-input" name="monetizationMethods"
                                    placeholder="e.g., Google AdSense, Affiliate Marketing, Direct Ads">
                            </div>
                        </div>

                        <!-- Important Notice -->
                        <div style="background: rgba(45, 78, 245, 0.1); border-left: 4px solid #2d4ef5; 
                            padding: 16px 20px; border-radius: 12px; margin-bottom: 24px;">
                            <div style="font-weight: 600; color: #171C6B; margin-bottom: 8px;">
                                 Verification Required
                            </div>
                            <div style="font-size: 14px; color: #64748b; line-height: 1.6;">
                                After submission, you'll receive a verification code to add to your website.
                                Your website will be reviewed within 24-48 hours.
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn-secondary" onclick="closeWebsiteModal()">
                                Cancel
                            </button>
                            <button type="submit" class="btn-primary" id="submitWebsiteBtn">
                                <span id="websiteBtnText">Submit Website</span>
                                <span id="websiteBtnSpinner" class="spinner"
                                    style="display: none; width: 16px; height: 16px; border-width: 2px;"></span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- My Websites Section -->
        <section class="placements-section" id="my-websites-section" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">My Websites</h2>
                <p class="section-subtitle">Manage your registered websites and their verification status</p>
            </div>

            <div
                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; flex-wrap: wrap; gap: 16px;">
                <button class="btn-secondary" onclick="refreshWebsites()">
                     Refresh
                </button>
                <button class="primary-btn" onclick="openWebsiteModal()">
                     Add New Website
                </button>
            </div>

            <div id="websitesContainer">
                <div id="websitesLoading" class="loading-spinner">
                    <div class="spinner"></div>
                    <div>Loading websites...</div>
                </div>
                <div id="noWebsites" class="empty-state" style="display: none;">
                    <div class="empty-state-icon"></div>
                    <h3 class="empty-state-title">No websites added yet</h3>
                    <p class="empty-state-desc">Add your first website to start monetizing your traffic.</p>
                    <button class="primary-btn" onclick="openWebsiteModal()">
                        Add First Website
                    </button>
                </div>
                <div id="websitesList" class="placements-grid"></div>
            </div>
        </section>
        <section id="analytics-section" style="display: none;">

            <!-- Analytics Header -->
            <div
                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; flex-wrap: wrap; gap: 16px;">
                <div>
                    <h2 class="section-title" style="margin-bottom: 8px;">Analytics Dashboard</h2>
                    <p class="section-subtitle" style="margin: 0;">Monitor your performance and revenue metrics</p>
                </div>

                <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                    <!-- Time Range Selector -->
                    <select id="analyticsTimeRange" class="form-input form-select"
                        style="width: auto; padding: 12px 16px;" onchange="changeAnalyticsTimeRange(this.value)">
                        <option value="today">Today</option>
                        <option value="week" selected>Last 7 Days</option>
                        <option value="month">Last 30 Days</option>
                        <option value="year">Last Year</option>
                    </select>

                    <button class="btn-secondary" onclick="refreshAnalytics()">
                         Refresh
                    </button>

                    <button class="btn-primary" onclick="exportAnalytics()">
                         Export Report
                    </button>
                </div>
            </div>

            <!-- Loading State -->
            <div id="analyticsLoading" class="loading-spinner">
                <div class="spinner"></div>
                <div>Loading analytics...</div>
            </div>

            <!-- Analytics Content -->
            <div id="analyticsContent" style="display: none;">

                <!-- Key Metrics Cards -->
                <div class="analytics-metrics-grid">
                    <div class="metric-card">
                        <div class="metric-icon" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                            
                        </div>
                        <div class="metric-content">
                            <div class="metric-label">Total Impressions</div>
                            <div class="metric-value" id="metricImpressions">0</div>
                            <div class="metric-change positive">
                                <span></span> <span id="impressionsChange">0%</span> vs last period
                            </div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
                            
                        </div>
                        <div class="metric-content">
                            <div class="metric-label">Total Clicks</div>
                            <div class="metric-value" id="metricClicks">0</div>
                            <div class="metric-change positive">
                                <span></span> <span id="clicksChange">0%</span> vs last period
                            </div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                            
                        </div>
                        <div class="metric-content">
                            <div class="metric-label">Total Revenue</div>
                            <div class="metric-value" id="metricRevenue">$0.00</div>
                            <div class="metric-change positive">
                                <span></span> <span id="revenueChange">0%</span> vs last period
                            </div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                            
                        </div>
                        <div class="metric-content">
                            <div class="metric-label">Average CTR</div>
                            <div class="metric-value" id="metricCTR">0%</div>
                            <div class="metric-change positive">
                                <span></span> <span id="ctrChange">0%</span> vs last period
                            </div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon" style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);">
                            
                        </div>
                        <div class="metric-content">
                            <div class="metric-label">Average RPM</div>
                            <div class="metric-value" id="metricRPM">$0.00</div>
                            <div class="metric-change positive">
                                <span></span> <span id="rpmChange">0%</span> vs last period
                            </div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);">
                            
                        </div>
                        <div class="metric-content">
                            <div class="metric-label">Fill Rate</div>
                            <div class="metric-value" id="metricFillRate">0%</div>
                            <div class="metric-change positive">
                                <span></span> <span id="fillRateChange">0%</span> vs last period
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-grid">
                    <!-- Revenue & Performance Chart -->
                    <div class="chart-card" style="grid-column: span 2;">
                        <div class="chart-header">
                            <div>
                                <h3 class="chart-title">Revenue & Performance Trends</h3>
                                <p class="chart-subtitle">Daily revenue, impressions, and clicks</p>
                            </div>
                            <div class="chart-legend">
                                <span class="legend-item">
                                    <span class="legend-dot" style="background: #10b981;"></span> Revenue
                                </span>
                                <span class="legend-item">
                                    <span class="legend-dot" style="background: #3b82f6;"></span> Impressions
                                </span>
                                <span class="legend-item">
                                    <span class="legend-dot" style="background: #8b5cf6;"></span> Clicks
                                </span>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="revenueChart"></canvas>
                        </div>
                    </div>

                    <!-- Device Breakdown -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <div>
                                <h3 class="chart-title">Device Distribution</h3>
                                <p class="chart-subtitle">Traffic by device type</p>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="deviceChart"></canvas>
                        </div>
                    </div>

                    <!-- Browser Breakdown -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <div>
                                <h3 class="chart-title">Browser Distribution</h3>
                                <p class="chart-subtitle">Traffic by browser</p>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="browserChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Geographic & Performance Section -->
                <div class="analytics-grid">
                    <!-- Geographic Performance -->
                    <div class="analytics-card">
                        <div class="card-header-analytics">
                            <h3 class="content-title">Geographic Performance</h3>
                            <button class="btn-icon" onclick="viewFullGeoReport()"></button>
                        </div>
                        <div class="geo-list" id="geoList">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Top Performing Placements -->
                    <div class="analytics-card">
                        <div class="card-header-analytics">
                            <h3 class="content-title">Top Performing Placements</h3>
                            <button class="btn-icon" onclick="viewAllPlacements()"></button>
                        </div>
                        <div class="placements-list" id="topPlacementsList">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Hour of Day Performance -->
                <div class="chart-card" style="margin-top: 32px;">
                    <div class="chart-header">
                        <div>
                            <h3 class="chart-title">Performance by Hour</h3>
                            <p class="chart-subtitle">Optimize your ad delivery based on peak hours</p>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="hourlyChart"></canvas>
                    </div>
                </div>

                <!-- Additional Metrics -->
                <div class="additional-metrics">
                    <div class="metrics-section">
                        <h3 class="section-title-small">Performance Metrics</h3>
                        <div class="metrics-list">
                            <div class="metric-row">
                                <span class="metric-label-small">Viewability Rate</span>
                                <div class="metric-bar-container">
                                    <div class="metric-bar" style="width: 0%;" id="viewabilityBar"></div>
                                </div>
                                <span class="metric-value-small" id="viewabilityValue">0%</span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label-small">Invalid Traffic</span>
                                <div class="metric-bar-container">
                                    <div class="metric-bar" style="width: 0%; background: #ef4444;" id="invalidBar">
                                    </div>
                                </div>
                                <span class="metric-value-small" id="invalidValue">0%</span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label-small">Ad Block Rate</span>
                                <div class="metric-bar-container">
                                    <div class="metric-bar" style="width: 0%; background: #f59e0b;" id="adBlockBar">
                                    </div>
                                </div>
                                <span class="metric-value-small" id="adBlockValue">0%</span>
                            </div>
                        </div>
                    </div>

                    <div class="metrics-section">
                        <h3 class="section-title-small">Audience Insights</h3>
                        <div class="metrics-list">
                            <div class="metric-row">
                                <span class="metric-label-small">Avg. Session Duration</span>
                                <span class="metric-value-small" id="sessionDuration">0:00</span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label-small">Pages per Session</span>
                                <span class="metric-value-small" id="pagesSession">0</span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label-small">Bounce Rate</span>
                                <span class="metric-value-small" id="bounceRate">0%</span>
                            </div>
                        </div>
                    </div>

                    <div class="metrics-section">
                        <h3 class="section-title-small">Visitor Type</h3>
                        <div class="visitor-chart">
                            <div class="visitor-segment" id="newVisitors" style="width: 0%; background: #3b82f6;">
                                <span class="visitor-label">New</span>
                            </div>
                            <div class="visitor-segment" id="returningVisitors" style="width: 0%; background: #8b5cf6;">
                                <span class="visitor-label">Returning</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 12px;">
                            <span style="font-size: 13px; color: #64748b;">
                                New: <strong id="newPercent">0%</strong>
                            </span>
                            <span style="font-size: 13px; color: #64748b;">
                                Returning: <strong id="returningPercent">0%</strong>
                            </span>
                        </div>
                    </div>
                </div>

            </div>
        </section>
        <!-- =============================================================================
     ADD THIS HTML BEFORE THE CLOSING </main> TAG IN publisher_admin.html
     (After the analytics section)
     ========================================================================== -->

        <!-- Settings Section -->
        <section id="settings-section" style="display: none;">

            <!-- Settings Header -->
            <div style="margin-bottom: 32px;">
                <h2 class="section-title" style="margin-bottom: 8px;">Account Settings</h2>
                <p class="section-subtitle" style="margin: 0;">Manage your account preferences and security</p>
            </div>

            <!-- Loading State -->
            <div id="settingsLoading" class="loading-spinner">
                <div class="spinner"></div>
                <div>Loading settings...</div>
            </div>

            <!-- Settings Content -->
            <div id="settingsContent" style="display: none;">

                <!-- Settings Grid -->
                <div class="settings-grid">

                    <!-- Account Information -->
                    <div class="settings-card">
                        <div class="settings-card-header">
                            <div>
                                <h3 class="settings-card-title">Account Information</h3>
                                <p class="settings-card-subtitle">Update your personal details</p>
                            </div>
                            <div class="settings-icon"></div>
                        </div>

                        <form id="accountInfoForm" onsubmit="updateAccountInfo(event)">
                            <div class="form-group">
                                <label class="form-label">Full Name</label>
                                <input type="text" class="form-input" name="name" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Email Address</label>
                                <input type="email" class="form-input" name="email" readonly
                                    style="background: rgba(0,0,0,0.03); cursor: not-allowed;">
                                <small style="color: #64748b; font-size: 13px; display: block; margin-top: 6px;">
                                    Email cannot be changed for security reasons
                                </small>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Company Name</label>
                                <input type="text" class="form-input" name="company">
                            </div>

                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Phone Number</label>
                                    <input type="tel" class="form-input" name="phone">
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Country</label>
                                    <select class="form-input form-select" name="country">
                                        <option value="">Select country</option>
                                        <option value="US">United States</option>
                                        <option value="GB">United Kingdom</option>
                                        <option value="CA">Canada</option>
                                        <option value="AU">Australia</option>
                                        <option value="DE">Germany</option>
                                        <option value="FR">France</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>

                            <button type="submit" class="btn-primary" style="width: 100%; margin-top: 8px;">
                                Save Changes
                            </button>
                        </form>
                    </div>

                    <!-- Security Settings -->
                    <div class="settings-card">
                        <div class="settings-card-header">
                            <div>
                                <h3 class="settings-card-title">Security</h3>
                                <p class="settings-card-subtitle">Password and authentication</p>
                            </div>
                            <div class="settings-icon"></div>
                        </div>

                        <!-- Change Password -->
                        <form id="passwordForm" onsubmit="changePassword(event)">
                            <div class="form-group">
                                <label class="form-label">Current Password</label>
                                <input type="password" class="form-input" name="currentPassword" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label">New Password</label>
                                <input type="password" class="form-input" name="newPassword" minlength="6" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Confirm New Password</label>
                                <input type="password" class="form-input" name="confirmPassword" minlength="6" required>
                            </div>

                            <button type="submit" class="btn-primary" style="width: 100%; margin-top: 8px;">
                                Change Password
                            </button>
                        </form>

                        <!-- Two-Factor Authentication -->
                        <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid rgba(23, 28, 107, 0.1);">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div>
                                    <div style="font-weight: 600; color: #171C6B; margin-bottom: 4px;">
                                        Two-Factor Authentication
                                    </div>
                                    <div style="font-size: 13px; color: #64748b;">
                                        Add extra security to your account
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="twoFactorToggle" onchange="toggle2FA(this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <!-- Last Password Change -->
                        <div style="margin-top: 16px; font-size: 13px; color: #64748b;">
                            Last password change: <strong id="lastPasswordChange">Never</strong>
                        </div>
                    </div>

                    <!-- Notification Preferences -->
                    <div class="settings-card">
                        <div class="settings-card-header">
                            <div>
                                <h3 class="settings-card-title">Notifications</h3>
                                <p class="settings-card-subtitle">Manage email notifications</p>
                            </div>
                            <div class="settings-icon"></div>
                        </div>

                        <form id="notificationsForm">
                            <div class="notification-item">
                                <div class="notification-info">
                                    <div class="notification-title">Email Notifications</div>
                                    <div class="notification-desc">Receive important account updates via email</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" name="emailNotifications" onchange="updateNotifications()">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="notification-item">
                                <div class="notification-info">
                                    <div class="notification-title">Payment Alerts</div>
                                    <div class="notification-desc">Get notified about payments and payouts</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" name="paymentAlerts" onchange="updateNotifications()">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="notification-item">
                                <div class="notification-info">
                                    <div class="notification-title">Performance Reports</div>
                                    <div class="notification-desc">Daily reports on your ad performance</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" name="performanceReports" onchange="updateNotifications()">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="notification-item">
                                <div class="notification-info">
                                    <div class="notification-title">Weekly Digest</div>
                                    <div class="notification-desc">Summary of your weekly performance</div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" name="weeklyDigest" onchange="updateNotifications()">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </form>
                    </div>

                    <!-- Payment Settings -->
                    <div class="settings-card">
                        <div class="settings-card-header">
                            <div>
                                <h3 class="settings-card-title">Payment Settings</h3>
                                <p class="settings-card-subtitle">Configure payout preferences</p>
                            </div>
                            <div class="settings-icon"></div>
                        </div>

                        <form id="paymentSettingsForm" onsubmit="updatePaymentSettings(event)">
                            <div class="form-group">
                                <label class="form-label">Payment Method</label>
                                <select class="form-input form-select" name="paymentMethod">
                                    <option value="bank_transfer">Bank Transfer</option>
                                    <option value="paypal">PayPal</option>
                                    <option value="wire">Wire Transfer</option>
                                    <option value="crypto">Cryptocurrency</option>
                                </select>
                                <small style="color: #64748b; font-size: 13px; display: block; margin-top: 6px;">
                                    Update payment details in your profile
                                </small>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Minimum Payout Amount</label>
                                <div style="position: relative;">
                                    <span style="position: absolute; left: 16px; top: 50%; transform: translateY(-50%); 
                                         color: #64748b; font-weight: 600;">$</span>
                                    <input type="number" class="form-input" name="minimumPayout" min="50" max="10000"
                                        step="10" style="padding-left: 32px;">
                                </div>
                                <small style="color: #64748b; font-size: 13px; display: block; margin-top: 6px;">
                                    Minimum: $50 | Maximum: $10,000
                                </small>
                            </div>

                            <button type="submit" class="btn-primary" style="width: 100%; margin-top: 8px;">
                                Save Payment Settings
                            </button>
                        </form>

                        <button class="btn-secondary" onclick="setupProfile()" style="width: 100%; margin-top: 12px;">
                            Manage Payment Details
                        </button>
                    </div>

                    <!-- Active Sessions -->
                    <div class="settings-card">
                        <div class="settings-card-header">
                            <div>
                                <h3 class="settings-card-title">Active Sessions</h3>
                                <p class="settings-card-subtitle">Manage your login sessions</p>
                            </div>
                            <div class="settings-icon"></div>
                        </div>

                        <div id="sessionsList">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Danger Zone -->
                    <div class="settings-card danger-zone">
                        <div class="settings-card-header">
                            <div>
                                <h3 class="settings-card-title" style="color: #dc2626;">Danger Zone</h3>
                                <p class="settings-card-subtitle">Irreversible and destructive actions</p>
                            </div>
                            <div class="settings-icon"></div>
                        </div>

                        <div style="background: rgba(239, 68, 68, 0.05); padding: 16px; border-radius: 12px; 
                            border: 1px solid rgba(239, 68, 68, 0.2); margin-bottom: 16px;">
                            <div style="font-weight: 600; color: #dc2626; margin-bottom: 8px;">
                                Delete Account
                            </div>
                            <div style="font-size: 14px; color: #64748b; line-height: 1.6;">
                                Once you delete your account, there is no going back. This will permanently delete
                                your account, all your placements, websites, and analytics data.
                            </div>
                        </div>

                        <button class="btn-danger" onclick="openDeleteAccountModal()" style="width: 100%;">
                            Delete My Account
                        </button>
                    </div>

                </div>
            </div>
        </section>

        <!-- Delete Account Confirmation Modal -->
        <div class="modal-overlay" id="deleteAccountModal">
            <div class="placement-modal" style="max-width: 600px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="closeDeleteAccountModal()"></button>
                    <h2 class="modal-title" style="color: #dc2626;">Delete Account</h2>
                    <p class="modal-subtitle">This action cannot be undone</p>
                </div>

                <div class="modal-content">
                    <div style="background: rgba(239, 68, 68, 0.1); padding: 20px; border-radius: 12px; 
                        border-left: 4px solid #dc2626; margin-bottom: 24px;">
                        <div style="font-weight: 600; color: #dc2626; margin-bottom: 8px; font-size: 16px;">
                             Warning
                        </div>
                        <div style="color: #64748b; line-height: 1.6;">
                            You are about to permanently delete your account. This will:
                        </div>
                        <ul style="margin: 12px 0 0 20px; color: #64748b; line-height: 1.8;">
                            <li>Delete all your placements and ad codes</li>
                            <li>Remove all your websites and data</li>
                            <li>Erase your analytics history</li>
                            <li>Cancel any pending payouts</li>
                            <li>Permanently delete your account</li>
                        </ul>
                    </div>

                    <form id="deleteAccountForm" onsubmit="deleteAccount(event)">
                        <div class="form-group">
                            <label class="form-label">Confirm your password</label>
                            <input type="password" class="form-input" name="password" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Type DELETE to confirm</label>
                            <input type="text" class="form-input" name="confirmation" placeholder="DELETE" required>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn-secondary" onclick="closeDeleteAccountModal()">
                                Cancel
                            </button>
                            <button type="submit" class="btn-danger">
                                Delete Account Permanently
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </main>

    <script>
        function addPlacement() {
            alert(' Create Ad Placement\n\nGenerate ad codes for:\n Display banners\n Native ads\n Video placements\n Mobile formats\n Custom sizes');
        }

        function setupProfile() {
            alert(' Publisher Setup\n\nComplete your profile:\n Website information\n Traffic details\n Payment methods\n Tax information\n Account verification');
        }

        function addWebsite() {
            alert(' Add Website\n\nSubmit your property:\n Website URL\n Traffic statistics\n Content category\n Target audience\n Approval process');
        }

        function expandHelp(element) {
            const question = element.querySelector('.faq-question').textContent;
            alert(` Publisher Resources\n\n"${question}"\n\nThis would open comprehensive guides, tutorials, and best practices for publishers.`);
        }

        // Enhanced Navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', function () {
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Stagger animations
        document.addEventListener('DOMContentLoaded', function () {
            const animateElements = document.querySelectorAll('.animate-in');
            animateElements.forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(30px)';

                setTimeout(() => {
                    el.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, index * 150);
            });
        });
        /* ==========================================================================
   MOBILE JAVASCRIPT FUNCTIONALITY
   Add this JavaScript to both advertiser_admin.html and publisher_admin.html
   ========================================================================== */

        // Mobile Navigation System
        function initMobileNavigation() {
            // Create mobile menu elements
            const header = document.querySelector('.header-content');
            const userSection = document.querySelector('.user-section');

            // Add mobile toggle button
            const mobileToggle = document.createElement('button');
            mobileToggle.className = 'mobile-menu-toggle';
            mobileToggle.innerHTML = '';
            mobileToggle.setAttribute('aria-label', 'Toggle mobile menu');

            // Insert toggle before user section
            userSection.parentNode.insertBefore(mobileToggle, userSection);

            // Create mobile overlay and menu
            const mobileOverlay = document.createElement('div');
            mobileOverlay.className = 'mobile-nav-overlay';

            const mobileMenu = document.createElement('div');
            mobileMenu.className = 'mobile-nav-menu';

            const closeButton = document.createElement('button');
            closeButton.className = 'mobile-nav-close';
            closeButton.innerHTML = '';
            closeButton.setAttribute('aria-label', 'Close mobile menu');

            // Get navigation items (different for advertiser vs publisher)
            const navTabs = document.querySelectorAll('.nav-tab');
            let menuHTML = '';

            // Determine if this is advertiser or publisher based on nav items
            const isPublisher = document.querySelector('.earnings') !== null;

            if (isPublisher) {
                // Publisher navigation
                const publisherNavs = [
                    { text: 'Dashboard', active: true, action: "switchSection('dashboard')" },
                    { text: 'Add Placement', action: "openPlacementModal()" },
                    { text: 'My Placements', action: "switchSection('my-placements')" },
                    { text: 'My Websites', action: "switchSection('my-websites')" },
                    { text: 'Analytics', action: "switchSection('analytics')" },
                    { text: 'Settings', action: "switchSection('settings')" }
                ];

                publisherNavs.forEach(nav => {
                    menuHTML += `<a href="#" class="mobile-nav-item ${nav.active ? 'active' : ''}" 
                    onclick="event.preventDefault(); ${nav.action}; closeMobileMenu();">${nav.text}</a>`;
                });
            } else {
                // Advertiser navigation  
                const advertiserNavs = [
                    { text: 'Dashboard', active: true },
                    { text: 'Create Campaign' },
                    { text: 'My Campaigns' },
                    { text: 'Analytics' },
                    { text: 'Settings' }
                ];

                advertiserNavs.forEach(nav => {
                    menuHTML += `<a href="#" class="mobile-nav-item ${nav.active ? 'active' : ''}">${nav.text}</a>`;
                });
            }

            mobileMenu.innerHTML = menuHTML;
            mobileMenu.insertBefore(closeButton, mobileMenu.firstChild);

            // Add to DOM
            document.body.appendChild(mobileOverlay);
            document.body.appendChild(mobileMenu);

            // Event listeners
            mobileToggle.addEventListener('click', openMobileMenu);
            closeButton.addEventListener('click', closeMobileMenu);
            mobileOverlay.addEventListener('click', closeMobileMenu);

            // Handle mobile nav item clicks
            const mobileNavItems = document.querySelectorAll('.mobile-nav-item');
            mobileNavItems.forEach(item => {
                item.addEventListener('click', handleMobileNavClick);
            });

            function openMobileMenu() {
                mobileOverlay.classList.add('active');
                mobileMenu.classList.add('active');
                document.body.style.overflow = 'hidden';
                mobileToggle.innerHTML = '';
            }

            function closeMobileMenu() {
                mobileOverlay.classList.remove('active');
                mobileMenu.classList.remove('active');
                document.body.style.overflow = '';
                mobileToggle.innerHTML = '';
            }

            function handleMobileNavClick(e) {
                e.preventDefault();

                // Remove active class from all items
                mobileNavItems.forEach(item => item.classList.remove('active'));
                // Add active class to clicked item
                e.target.classList.add('active');

                // Close menu
                closeMobileMenu();

                // Handle navigation logic here
                const navText = e.target.textContent;
                alert(`Navigation to: ${navText}\n\nThis would navigate to the ${navText} page.`);
            }

            // Handle escape key
            document.addEventListener('keydown', function (e) {
                if (e.key === 'Escape') {
                    closeMobileMenu();
                }
            });

            // Handle window resize
            window.addEventListener('resize', function () {
                if (window.innerWidth > 1024) {
                    closeMobileMenu();
                }
            });
        }

        // Enhanced Touch Interactions for Mobile
        function initMobileTouchEnhancements() {
            // Improve button feedback on mobile
            const buttons = document.querySelectorAll('.primary-btn, .step-btn');

            buttons.forEach(button => {
                button.addEventListener('touchstart', function () {
                    this.style.transform = 'scale(0.96)';
                });

                button.addEventListener('touchend', function () {
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });

            // Enhance card interactions for mobile
            const cards = document.querySelectorAll('.step-card, .content-card');

            cards.forEach(card => {
                let touchStartY = 0;

                card.addEventListener('touchstart', function (e) {
                    touchStartY = e.touches[0].clientY;
                });

                card.addEventListener('touchmove', function (e) {
                    const touchY = e.touches[0].clientY;
                    const diff = touchStartY - touchY;

                    // Prevent elastic scroll effect on cards
                    if (Math.abs(diff) > 5) {
                        e.stopPropagation();
                    }
                });
            });
        }

        // Mobile Viewport Height Fix (for iOS Safari)
        function initMobileViewportFix() {
            function setViewportHeight() {
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
            }

            setViewportHeight();
            window.addEventListener('resize', setViewportHeight);
            window.addEventListener('orientationchange', function () {
                setTimeout(setViewportHeight, 500);
            });
        }

        // Mobile Performance Optimizations
        function initMobilePerformanceOptimizations() {
            // Lazy load animations on mobile
            if (window.innerWidth <= 768) {
                const animateElements = document.querySelectorAll('.animate-in');

                const observerOptions = {
                    threshold: 0.1,
                    rootMargin: '50px'
                };

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.style.opacity = '1';
                            entry.target.style.transform = 'translateY(0)';
                            observer.unobserve(entry.target);
                        }
                    });
                }, observerOptions);

                animateElements.forEach(el => {
                    el.style.opacity = '0';
                    el.style.transform = 'translateY(30px)';
                    el.style.transition = 'all 0.6s ease';
                    observer.observe(el);
                });
            }
        }

        // Mobile Accessibility Enhancements
        function initMobileAccessibility() {
            // Improve focus management for mobile screen readers
            const focusableElements = document.querySelectorAll('button, a, input, [tabindex]:not([tabindex="-1"])');

            focusableElements.forEach(element => {
                element.addEventListener('focus', function () {
                    this.scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                });
            });

            // Announce page transitions for screen readers
            const navItems = document.querySelectorAll('.nav-tab, .mobile-nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function () {
                    // Create announcement for screen readers
                    const announcement = document.createElement('div');
                    announcement.setAttribute('aria-live', 'polite');
                    announcement.setAttribute('aria-atomic', 'true');
                    announcement.className = 'sr-only';
                    announcement.textContent = `Navigating to ${this.textContent}`;

                    document.body.appendChild(announcement);

                    setTimeout(() => {
                        document.body.removeChild(announcement);
                    }, 1000);
                });
            });
        }

        // Mobile-specific CSS utility class
        function addMobileCSSUtilities() {
            const style = document.createElement('style');
            style.textContent = `
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .mobile-nav-menu {
            height: 100vh;
            height: calc(var(--vh, 1vh) * 100);
        }
        
        @media (max-width: 768px) {
            .no-scroll {
                overflow: hidden !important;
                position: fixed !important;
                width: 100% !important;
            }
        }
    `;
            document.head.appendChild(style);
        }

        // Initialize all mobile functionality
        function initMobileDashboard() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function () {
                    initMobileNavigation();
                    initMobileTouchEnhancements();
                    initMobileViewportFix();
                    initMobilePerformanceOptimizations();
                    initMobileAccessibility();
                    addMobileCSSUtilities();
                });
            } else {
                initMobileNavigation();
                initMobileTouchEnhancements();
                initMobileViewportFix();
                initMobilePerformanceOptimizations();
                initMobileAccessibility();
                addMobileCSSUtilities();
            }
        }

        // Start mobile initialization
        initMobileDashboard();

        // Export functions for manual initialization if needed
        window.mobileNavigation = {
            init: initMobileNavigation,
            touchEnhancements: initMobileTouchEnhancements,
            viewportFix: initMobileViewportFix,
            performanceOptimizations: initMobilePerformanceOptimizations,
            accessibility: initMobileAccessibility
        };// =============================================================================
        // ADD THIS JAVASCRIPT TO YOUR EXISTING <script> TAG
        // =============================================================================

        // API Configuration (add if not exists)
        const API_BASE = `${window.location.protocol}//${window.location.hostname}:${window.location.port || '5000'}/api`;

        let authToken = null;
        let currentUser = null;
        let placements = [];
        let selectedAdType = null;

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function () {
            initializePublisherDashboard();
        });

        async function initializePublisherDashboard() {
            // Check authentication
            const isAuthenticated = await checkAuthentication();

            if (!isAuthenticated) {
                redirectToLogin();
                return;
            }

            // Load data
            await loadPublisherStats();
            await loadPlacements();
            updateUserInterface();
        }

        // Authentication Functions
        async function checkAuthentication() {
            try {
                authToken = localStorage.getItem('authToken');
                const userData = localStorage.getItem('userData');

                if (!authToken || !userData) {
                    return false;
                }

                currentUser = JSON.parse(userData);

                // Verify user is publisher
                if (currentUser.userType !== 'publisher') {
                    showToast('Access Denied', 'This dashboard is for publishers only', 'error');
                    return false;
                }

                return true;
            } catch (error) {
                console.error('Authentication check failed:', error);
                return false;
            }
        }

        function redirectToLogin() {
            showToast('Authentication Required', 'Please log in to access the dashboard', 'error');
            setTimeout(() => {
                window.location.href = '/';
            }, 2000);
        }

        function updateUserInterface() {
            if (!currentUser) return;

            const userNameElement = document.getElementById('userName');
            const userAvatarElement = document.getElementById('userAvatar');

            if (userNameElement) {
                userNameElement.textContent = currentUser.name;
            }

            if (userAvatarElement) {
                const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
                userAvatarElement.textContent = initials;
            }
        }

        // API Call Helper
        async function apiCall(endpoint, options = {}) {
            try {
                const url = `${API_BASE}${endpoint}`;
                console.log('API Call:', url); // Debug log

                const headers = {
                    'Content-Type': 'application/json',
                    ...options.headers
                };

                if (authToken) {
                    headers['Authorization'] = `Bearer ${authToken}`;
                }

                const response = await fetch(url, {
                    headers,
                    ...options
                });

                if (response.status === 401) {
                    localStorage.removeItem('authToken');
                    localStorage.removeItem('userData');
                    redirectToLogin();
                    throw new Error('Authentication expired');
                }

                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('API Error Response:', errorText);
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                return await response.json();
            } catch (error) {
                console.error('API call failed:', error);
                console.error('Endpoint:', endpoint);
                console.error('Full URL:', `${API_BASE}${endpoint}`);
                if (error.message !== 'Authentication expired') {
                    showToast('API Error', 'Failed to communicate with server. Please check if server is running.', 'error');
                }
                throw error;
            }
        }

        // Load Publisher Stats
        async function loadPublisherStats() {
            try {
                const response = await apiCall('/publisher/stats');
                updateStatsDisplay(response);
            } catch (error) {
                console.error('Failed to load stats:', error);
            }
        }

        function updateStatsDisplay(stats) {
            // Update earnings in header
            document.querySelector('.earnings span').textContent =
                `Earnings: $${stats.totalRevenue || '0.00'} USD`;

            // Update stats panel if it exists
            const statItems = document.querySelectorAll('.stat-item');
            if (statItems.length > 0) {
                statItems[0].querySelector('.stat-value').textContent = `$${stats.totalRevenue || '0.00'}`;
                statItems[1].querySelector('.stat-value').textContent = `$${stats.todayEarnings || '0.00'}`;
                statItems[2].querySelector('.stat-value').textContent = stats.totalImpressions?.toLocaleString() || '0';
                statItems[3].querySelector('.stat-value').textContent = stats.totalClicks?.toLocaleString() || '0';
                statItems[4].querySelector('.stat-value').textContent = stats.avgRPM || '$0.00';
            }
        }

        // Placement Modal Functions
        function openPlacementModal() {
            document.getElementById('placementModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closePlacementModal() {
            document.getElementById('placementModal').classList.remove('active');
            document.body.style.overflow = '';
            resetPlacementForm();
        }

        function resetPlacementForm() {
            document.getElementById('placementForm').reset();
            selectedAdType = null;
            document.querySelectorAll('.ad-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.getElementById('placementType').value = '';
        }

        // Ad Type Selection
        function selectAdType(element) {
            document.querySelectorAll('.ad-type-card').forEach(card => {
                card.classList.remove('selected');
            });

            element.classList.add('selected');
            selectedAdType = element.dataset.type;
            document.getElementById('placementType').value = selectedAdType;
        }

        // Handle Form Submission
        async function handlePlacementSubmit(event) {
            event.preventDefault();

            if (!selectedAdType) {
                showToast('Error', 'Please select an ad format', 'error');
                return;
            }

            const submitBtn = document.getElementById('submitPlacementBtn');
            const btnText = document.getElementById('submitBtnText');
            const btnSpinner = document.getElementById('submitBtnSpinner');

            // Show loading state
            submitBtn.disabled = true;
            btnText.style.display = 'none';
            btnSpinner.style.display = 'inline-block';

            try {
                const formData = new FormData(event.target);
                const placementData = {
                    placementName: formData.get('placementName'),
                    websiteUrl: formData.get('websiteUrl'),
                    placementType: selectedAdType,
                    adSize: formData.get('adSize'),
                    description: formData.get('description'),
                    category: formData.get('category'),
                    pricingModel: formData.get('pricingModel'),
                    rate: formData.get('rate'),
                    minimumBid: formData.get('minimumBid'),
                    demographics: formData.get('demographics'),
                    interests: formData.get('interests'),
                    geoTargeting: formData.get('geoTargeting')
                };

                const response = await apiCall('/placements', {
                    method: 'POST',
                    body: JSON.stringify(placementData)
                });

                if (response.success) {
                    showToast('Success!', 'Placement created successfully', 'success');
                    closePlacementModal();
                    await loadPlacements();
                    await loadPublisherStats();
                }
            } catch (error) {
                console.error('Placement creation failed:', error);
                showToast('Error', 'Failed to create placement', 'error');
            } finally {
                submitBtn.disabled = false;
                btnText.style.display = 'inline';
                btnSpinner.style.display = 'none';
            }
        }

        // Load Placements
        async function loadPlacements() {
            const loading = document.getElementById('placementsLoading');
            const noPlacementsDiv = document.getElementById('noPlacements');
            const placementsList = document.getElementById('placementsList');

            loading.style.display = 'block';
            noPlacementsDiv.style.display = 'none';
            placementsList.innerHTML = '';

            try {
                const response = await apiCall('/placements');
                placements = response.placements || [];

                loading.style.display = 'none';

                if (placements.length === 0) {
                    noPlacementsDiv.style.display = 'block';
                } else {
                    displayPlacements(placements);
                }
            } catch (error) {
                loading.style.display = 'none';
                console.error('Failed to load placements:', error);
            }
        }

        // Display Placements
        function displayPlacements(placementList) {
            const placementsList = document.getElementById('placementsList');
            placementsList.innerHTML = '';

            placementList.forEach(placement => {
                const card = createPlacementCard(placement);
                placementsList.appendChild(card);
            });
        }

        // Create Placement Card
        function createPlacementCard(placement) {
            const card = document.createElement('div');
            card.className = 'placement-card';

            const statusClass = `status-${placement.status}`;
            const statusText = placement.status.charAt(0).toUpperCase() + placement.status.slice(1);

            card.innerHTML = `
        <div class="placement-header">
            <div>
                <div class="placement-name">${placement.placementName}</div>
                <div class="placement-url">${placement.websiteUrl}</div>
                <div class="placement-type">${placement.placementType}</div>
            </div>
            <div class="status-badge ${statusClass}">${statusText}</div>
        </div>
        
        <div class="placement-stats">
            <div class="stat-box">
                <div class="stat-box-value">${placement.stats.impressions.toLocaleString()}</div>
                <div class="stat-box-label">Impressions</div>
            </div>
            <div class="stat-box">
                <div class="stat-box-value">${placement.stats.clicks.toLocaleString()}</div>
                <div class="stat-box-label">Clicks</div>
            </div>
            <div class="stat-box">
                <div class="stat-box-value">$${placement.stats.revenue.toFixed(2)}</div>
                <div class="stat-box-label">Revenue</div>
            </div>
            <div class="stat-box">
                <div class="stat-box-value">$${placement.stats.rpm}</div>
                <div class="stat-box-label">RPM</div>
            </div>
        </div>
        
        <div class="placement-actions">
            <button class="action-btn" onclick="viewPlacementCode('${placement._id}')">Get Code</button>
            ${placement.status === 'active' ?
                    `<button class="action-btn" onclick="pausePlacement('${placement._id}')">Pause</button>` :
                    placement.status === 'paused' ?
                        `<button class="action-btn success" onclick="resumePlacement('${placement._id}')">Resume</button>` : ''
                }
            <button class="action-btn danger" onclick="deletePlacement('${placement._id}')">Delete</button>
        </div>
    `;

            return card;
        }

        // Placement Actions
        async function viewPlacementCode(placementId) {
            const placement = placements.find(p => p._id === placementId);
            if (placement) {
                const modal = document.createElement('div');
                modal.className = 'modal-overlay active';
                modal.innerHTML = `
            <div class="placement-modal" style="transform: translate(-50%, -50%) scale(1); max-width: 700px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal-overlay').remove()"></button>
                    <h2 class="modal-title">Ad Code</h2>
                    <p class="modal-subtitle">${placement.placementName}</p>
                </div>
                <div class="modal-content">
                    <div class="form-group">
                        <label class="form-label">Copy this code to your website:</label>
                        <textarea class="form-input form-textarea" readonly style="min-height: 200px; font-family: monospace; font-size: 13px;">${placement.adCode}</textarea>
                    </div>
                    <div class="form-actions">
                        <button class="btn-secondary" onclick="this.closest('.modal-overlay').remove()">Close</button>
                        <button class="btn-primary" onclick="copyAdCode('${placement._id}')">
                             Copy Code
                        </button>
                    </div>
                </div>
            </div>
        `;
                document.body.appendChild(modal);
                document.body.style.overflow = 'hidden';
            }
        }

        function copyAdCode(placementId) {
            const placement = placements.find(p => p._id === placementId);
            if (placement) {
                navigator.clipboard.writeText(placement.adCode).then(() => {
                    showToast('Copied!', 'Ad code copied to clipboard', 'success');
                }).catch(() => {
                    showToast('Error', 'Failed to copy code', 'error');
                });
            }
        }

        async function pausePlacement(placementId) {
            await updatePlacementStatus(placementId, 'paused');
        }

        async function resumePlacement(placementId) {
            await updatePlacementStatus(placementId, 'active');
        }

        async function updatePlacementStatus(placementId, status) {
            try {
                const response = await apiCall(`/placements/${placementId}/status`, {
                    method: 'PATCH',
                    body: JSON.stringify({ status })
                });

                if (response.success) {
                    showToast('Success!', `Placement ${status}`, 'success');
                    await loadPlacements();
                    await loadPublisherStats();
                }
            } catch (error) {
                showToast('Error', `Failed to ${status} placement`, 'error');
            }
        }

        async function deletePlacement(placementId) {
            if (!confirm('Are you sure you want to delete this placement? This action cannot be undone.')) {
                return;
            }

            try {
                const response = await apiCall(`/placements/${placementId}`, {
                    method: 'DELETE'
                });

                if (response.success) {
                    showToast('Deleted!', 'Placement deleted successfully', 'success');
                    await loadPlacements();
                    await loadPublisherStats();
                }
            } catch (error) {
                showToast('Error', 'Failed to delete placement', 'error');
            }
        }

        async function refreshPlacements() {
            await loadPlacements();
            showToast('Refreshed!', 'Placements data updated', 'success');
        }

        // Navigation
        function switchSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('[id$="-section"]').forEach(section => {
                section.style.display = 'none';
            });

            // Show selected section
            const targetSection = document.getElementById(`${sectionName}-section`);
            if (targetSection) {
                targetSection.style.display = 'block';
            }

            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
        }

        // Update your existing addPlacement function
        function addPlacement() {
            openPlacementModal();
        }

        // Toast Notification
        function showToast(title, message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.style.cssText = `
        background: white;
        border-radius: 12px;
        box-shadow: 0 8px 32px rgba(23, 28, 107, 0.2);
        padding: 16px 20px;
        margin-bottom: 12px;
        opacity: 0;
        transform: translateX(100%);
        transition: all 0.3s ease;
        border-left: 4px solid ${type === 'success' ? '#10b981' : '#dc2626'};
        max-width: 400px;
    `;

            toast.innerHTML = `
        <div style="font-weight: 600; color: #171C6B; margin-bottom: 4px;">${title}</div>
        <div style="font-size: 14px; color: #64748b;">${message}</div>
    `;

            const container = document.getElementById('toastContainer') || createToastContainer();
            container.appendChild(toast);

            setTimeout(() => {
                toast.style.opacity = '1';
                toast.style.transform = 'translateX(0)';
            }, 100);

            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }

        function createToastContainer() {
            const container = document.createElement('div');
            container.id = 'toastContainer';
            container.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 3000;';
            document.body.appendChild(container);
            return container;
        }

        // User Dropdown
        function toggleUserMenu() {
            const menu = document.querySelector('.user-dropdown-menu');
            menu.classList.toggle('active');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function (e) {
            const dropdown = document.querySelector('.user-dropdown');
            const menu = document.querySelector('.user-dropdown-menu');
            if (dropdown && menu && !dropdown.contains(e.target)) {
                menu.classList.remove('active');
            }
        });

        // Logout
        async function logout() {
            try {
                await apiCall('/auth/logout', { method: 'POST' });
            } catch (error) {
                console.error('Logout failed:', error);
            }

            localStorage.removeItem('authToken');
            localStorage.removeItem('userData');
            showToast('Logged Out', 'You have been successfully logged out', 'success');

            setTimeout(() => {
                window.location.href = '/';
            }, 1500);
        }

        // Close modals on escape key
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                closePlacementModal();
                // Close any other open modals
                document.querySelectorAll('.modal-overlay.active').forEach(modal => {
                    modal.remove();
                    document.body.style.overflow = '';
                });
            }
        });

        // Close modal on overlay click
        document.addEventListener('click', function (e) {
            if (e.target.classList.contains('modal-overlay')) {
                closePlacementModal();
            }
        });
        // =============================================================================
        // ADD THIS JAVASCRIPT TO YOUR EXISTING <script> TAG IN publisher_admin.html
        // Replace the existing setupProfile() and addWebsite() functions
        // =============================================================================

        let websites = [];
        let currentProfile = null;

        // =============================================================================
        // PROFILE MANAGEMENT FUNCTIONS
        // =============================================================================

        async function setupProfile() {
            await loadProfile();
            openProfileModal();
        }

        function openProfileModal() {
            document.getElementById('profileModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeProfileModal() {
            document.getElementById('profileModal').classList.remove('active');
            document.body.style.overflow = '';
        }

        async function loadProfile() {
            try {
                const response = await apiCall('/publisher/profile');
                if (response.success) {
                    currentProfile = response.profile;
                    populateProfileForm(response.profile);
                }
            } catch (error) {
                console.error('Failed to load profile:', error);
            }
        }

        function populateProfileForm(profile) {
            const form = document.getElementById('profileForm');
            if (!form) return;

            form.elements.name.value = profile.name || '';
            form.elements.email.value = currentUser?.email || '';
            form.elements.company.value = profile.company || '';
            form.elements.phone.value = profile.phone || '';
            form.elements.country.value = profile.country || '';
            form.elements.address.value = profile.address || '';
            form.elements.city.value = profile.city || '';
            form.elements.zipCode.value = profile.zipCode || '';
            form.elements.taxId.value = profile.taxId || '';
            form.elements.paymentMethod.value = profile.paymentMethod || 'bank_transfer';

            // Populate payment details based on method
            if (profile.paymentDetails) {
                const method = profile.paymentMethod;
                if (method === 'bank_transfer') {
                    form.elements.bankName.value = profile.paymentDetails.bankName || '';
                    form.elements.accountNumber.value = profile.paymentDetails.accountNumber || '';
                    form.elements.routingNumber.value = profile.paymentDetails.routingNumber || '';
                    form.elements.swiftCode.value = profile.paymentDetails.swiftCode || '';
                } else if (method === 'paypal') {
                    form.elements.paypalEmail.value = profile.paymentDetails.paypalEmail || '';
                } else if (method === 'crypto') {
                    form.elements.cryptoType.value = profile.paymentDetails.cryptoType || 'btc';
                    form.elements.walletAddress.value = profile.paymentDetails.walletAddress || '';
                }
            }

            togglePaymentFields(profile.paymentMethod || 'bank_transfer');
        }

        function togglePaymentFields(method) {
            const bankFields = document.getElementById('bankTransferFields');
            const paypalFields = document.getElementById('paypalFields');
            const cryptoFields = document.getElementById('cryptoFields');

            bankFields.style.display = 'none';
            paypalFields.style.display = 'none';
            cryptoFields.style.display = 'none';

            if (method === 'bank_transfer' || method === 'wire') {
                bankFields.style.display = 'block';
            } else if (method === 'paypal') {
                paypalFields.style.display = 'block';
            } else if (method === 'crypto') {
                cryptoFields.style.display = 'block';
            }
        }

        async function handleProfileSubmit(event) {
            event.preventDefault();

            const submitBtn = document.getElementById('submitProfileBtn');
            const btnText = document.getElementById('profileBtnText');
            const btnSpinner = document.getElementById('profileBtnSpinner');

            submitBtn.disabled = true;
            btnText.style.display = 'none';
            btnSpinner.style.display = 'inline-block';

            try {
                const formData = new FormData(event.target);
                const paymentMethod = formData.get('paymentMethod');

                let paymentDetails = {};
                if (paymentMethod === 'bank_transfer' || paymentMethod === 'wire') {
                    paymentDetails = {
                        bankName: formData.get('bankName'),
                        accountNumber: formData.get('accountNumber'),
                        routingNumber: formData.get('routingNumber'),
                        swiftCode: formData.get('swiftCode')
                    };
                } else if (paymentMethod === 'paypal') {
                    paymentDetails = {
                        paypalEmail: formData.get('paypalEmail')
                    };
                } else if (paymentMethod === 'crypto') {
                    paymentDetails = {
                        cryptoType: formData.get('cryptoType'),
                        walletAddress: formData.get('walletAddress')
                    };
                }

                const profileData = {
                    name: formData.get('name'),
                    company: formData.get('company'),
                    phone: formData.get('phone'),
                    country: formData.get('country'),
                    address: formData.get('address'),
                    city: formData.get('city'),
                    zipCode: formData.get('zipCode'),
                    taxId: formData.get('taxId'),
                    paymentMethod: paymentMethod,
                    paymentDetails: paymentDetails
                };

                const response = await apiCall('/publisher/profile', {
                    method: 'PUT',
                    body: JSON.stringify(profileData)
                });

                if (response.success) {
                    showToast('Success!', 'Profile updated successfully', 'success');
                    closeProfileModal();

                    // Update user name in header
                    if (currentUser) {
                        currentUser.name = profileData.name;
                        document.querySelector('.user-name').textContent = profileData.name;
                        document.querySelector('.welcome-title').textContent =
                            `Welcome back, ${profileData.name.split(' ')[0]}`;
                    }
                }
            } catch (error) {
                console.error('Profile update failed:', error);
                showToast('Error', 'Failed to update profile', 'error');
            } finally {
                submitBtn.disabled = false;
                btnText.style.display = 'inline';
                btnSpinner.style.display = 'none';
            }
        }

        // =============================================================================
        // WEBSITE MANAGEMENT FUNCTIONS
        // =============================================================================

        async function addWebsite() {
            openWebsiteModal();
        }

        function openWebsiteModal() {
            document.getElementById('websiteModal').classList.add('active');
            document.getElementById('websiteForm').reset();
            document.body.style.overflow = 'hidden';
        }

        function closeWebsiteModal() {
            document.getElementById('websiteModal').classList.remove('active');
            document.body.style.overflow = '';
        }

        async function handleWebsiteSubmit(event) {
            event.preventDefault();

            const submitBtn = document.getElementById('submitWebsiteBtn');
            const btnText = document.getElementById('websiteBtnText');
            const btnSpinner = document.getElementById('websiteBtnSpinner');

            submitBtn.disabled = true;
            btnText.style.display = 'none';
            btnSpinner.style.display = 'inline-block';

            try {
                const formData = new FormData(event.target);

                const websiteData = {
                    websiteName: formData.get('websiteName'),
                    websiteUrl: formData.get('websiteUrl'),
                    category: formData.get('category'),
                    description: formData.get('description'),
                    monthlyVisitors: formData.get('monthlyVisitors'),
                    pageViews: formData.get('pageViews'),
                    avgSessionDuration: formData.get('avgSessionDuration'),
                    primaryRegion: formData.get('primaryRegion'),
                    demographics: formData.get('demographics'),
                    interests: formData.get('interests'),
                    currentlyMonetized: formData.get('currentlyMonetized') === 'on',
                    monetizationMethods: formData.get('monetizationMethods')
                };

                const response = await apiCall('/websites', {
                    method: 'POST',
                    body: JSON.stringify(websiteData)
                });

                if (response.success) {
                    showToast('Success!', 'Website submitted for review', 'success');
                    closeWebsiteModal();
                    await loadWebsites();

                    // Show verification instructions
                    setTimeout(() => {
                        showVerificationInstructions(response.website);
                    }, 1000);
                }
            } catch (error) {
                console.error('Website submission failed:', error);
                const errorMsg = error.message || 'Failed to submit website';
                showToast('Error', errorMsg, 'error');
            } finally {
                submitBtn.disabled = false;
                btnText.style.display = 'inline';
                btnSpinner.style.display = 'none';
            }
        }

        function showVerificationInstructions(website) {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay active';
            modal.innerHTML = `
        <div class="placement-modal" style="transform: translate(-50%, -50%) scale(1); max-width: 700px;">
            <div class="modal-header">
                <button class="modal-close" onclick="this.closest('.modal-overlay').remove(); document.body.style.overflow='';"></button>
                <h2 class="modal-title">Website Verification</h2>
                <p class="modal-subtitle">${website.websiteName}</p>
            </div>
            <div class="modal-content">
                <div style="background: rgba(45, 78, 245, 0.1); border-left: 4px solid #2d4ef5; 
                            padding: 20px; border-radius: 12px; margin-bottom: 24px;">
                    <div style="font-weight: 600; color: #171C6B; margin-bottom: 12px; font-size: 16px;">
                         Next Steps
                    </div>
                    <ol style="color: #64748b; line-height: 1.8; padding-left: 20px; margin: 0;">
                        <li>Add the verification code to your website's HTML</li>
                        <li>Place it in the &lt;head&gt; section of your homepage</li>
                        <li>Click "Verify Website" once the code is added</li>
                    </ol>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Verification Code</label>
                    <textarea class="form-input form-textarea" readonly style="min-height: 120px; font-family: monospace; font-size: 13px;">${website.verificationCode ? `<meta name="trafficstars-verification" content="${website.verificationCode}">` : 'Verification code will be generated shortly...'}</textarea>
                </div>
                
                <div style="background: rgba(16, 185, 129, 0.1); padding: 16px; border-radius: 12px; margin-top: 20px;">
                    <div style="font-weight: 600; color: #059669; margin-bottom: 6px; font-size: 14px;">
                         Automatic Approval
                    </div>
                    <div style="font-size: 13px; color: #64748b;">
                        Your website will be automatically verified and approved within 24-48 hours. 
                        You'll receive an email notification once approved.
                    </div>
                </div>
                
                <div class="form-actions" style="margin-top: 24px;">
                    <button class="btn-secondary" onclick="this.closest('.modal-overlay').remove(); document.body.style.overflow='';">
                        Close
                    </button>
                    <button class="btn-primary" onclick="copyVerificationCode('${website.verificationCode}')">
                         Copy Code
                    </button>
                </div>
            </div>
        </div>
    `;
            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
        }

        function copyVerificationCode(code) {
            const fullCode = `<meta name="trafficstars-verification" content="${code}">`;
            navigator.clipboard.writeText(fullCode).then(() => {
                showToast('Copied!', 'Verification code copied to clipboard', 'success');
            }).catch(() => {
                showToast('Error', 'Failed to copy code', 'error');
            });
        }

        async function loadWebsites() {
            const loading = document.getElementById('websitesLoading');
            const noWebsitesDiv = document.getElementById('noWebsites');
            const websitesList = document.getElementById('websitesList');

            if (loading) loading.style.display = 'block';
            if (noWebsitesDiv) noWebsitesDiv.style.display = 'none';
            if (websitesList) websitesList.innerHTML = '';

            try {
                const response = await apiCall('/websites');
                websites = response.websites || [];

                if (loading) loading.style.display = 'none';

                if (websites.length === 0) {
                    if (noWebsitesDiv) noWebsitesDiv.style.display = 'block';
                } else {
                    displayWebsites(websites);
                }
            } catch (error) {
                if (loading) loading.style.display = 'none';
                console.error('Failed to load websites:', error);
            }
        }

        function displayWebsites(websiteList) {
            const websitesList = document.getElementById('websitesList');
            if (!websitesList) return;

            websitesList.innerHTML = '';

            websiteList.forEach(website => {
                const card = createWebsiteCard(website);
                websitesList.appendChild(card);
            });
        }

        function createWebsiteCard(website) {
            const card = document.createElement('div');
            card.className = 'placement-card';

            const statusClass = `status-${website.status}`;
            const statusText = website.status.replace('_', ' ').charAt(0).toUpperCase() +
                website.status.replace('_', ' ').slice(1);
            const verifiedBadge = website.isVerified ?
                '<span style="color: #059669; font-size: 18px; margin-left: 8px;" title="Verified"></span>' : '';

            card.innerHTML = `
        <div class="placement-header">
            <div>
                <div class="placement-name">
                    ${website.websiteName}
                    ${verifiedBadge}
                </div>
                <div class="placement-url">${website.websiteUrl}</div>
                <div class="placement-type">${website.category}</div>
            </div>
            <div class="website-status-badge ${statusClass}">${statusText}</div>
        </div>
        
        <div style="margin: 20px 0; padding: 16px; background: rgba(248, 250, 255, 0.8); border-radius: 12px;">
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                <div>
                    <div style="font-size: 12px; color: #64748b; margin-bottom: 4px;">Monthly Visitors</div>
                    <div style="font-weight: 600; color: #171C6B;">${website.trafficStats?.monthlyVisitors || 'N/A'}</div>
                </div>
                <div>
                    <div style="font-size: 12px; color: #64748b; margin-bottom: 4px;">Page Views</div>
                    <div style="font-weight: 600; color: #171C6B;">${website.trafficStats?.pageViews || 'N/A'}</div>
                </div>
                <div>
                    <div style="font-size: 12px; color: #64748b; margin-bottom: 4px;">Region</div>
                    <div style="font-weight: 600; color: #171C6B;">${website.audience?.primaryRegion || 'Worldwide'}</div>
                </div>
                <div>
                    <div style="font-size: 12px; color: #64748b; margin-bottom: 4px;">Added</div>
                    <div style="font-weight: 600; color: #171C6B;">${new Date(website.createdAt).toLocaleDateString()}</div>
                </div>
            </div>
        </div>
        
        <div class="placement-actions">
            ${!website.isVerified ?
                    `<button class="action-btn success" onclick="verifyWebsite('${website._id}')">Verify</button>` : ''}
            ${website.status === 'approved' ?
                    `<button class="action-btn" onclick="addPlacement()">Create Placement</button>` : ''}
            <button class="action-btn" onclick="viewWebsiteDetails('${website._id}')">Details</button>
            <button class="action-btn danger" onclick="deleteWebsite('${website._id}')">Delete</button>
        </div>
    `;

            return card;
        }

        async function verifyWebsite(websiteId) {
            try {
                const response = await apiCall(`/websites/${websiteId}/verify`, {
                    method: 'POST'
                });

                if (response.success) {
                    showToast('Verified!', 'Website verified successfully', 'success');
                    await loadWebsites();
                }
            } catch (error) {
                showToast('Error', 'Failed to verify website', 'error');
            }
        }

        function viewWebsiteDetails(websiteId) {
            const website = websites.find(w => w._id === websiteId);
            if (!website) return;

            const modal = document.createElement('div');
            modal.className = 'modal-overlay active';
            modal.innerHTML = `
        <div class="placement-modal" style="transform: translate(-50%, -50%) scale(1); max-width: 700px;">
            <div class="modal-header">
                <button class="modal-close" onclick="this.closest('.modal-overlay').remove(); document.body.style.overflow='';"></button>
                <h2 class="modal-title">${website.websiteName}</h2>
                <p class="modal-subtitle">${website.websiteUrl}</p>
            </div>
            <div class="modal-content">
                <div style="display: grid; gap: 20px;">
                    <div>
                        <div style="font-weight: 600; color: #171C6B; margin-bottom: 8px;">Status</div>
                        <div class="website-status-badge ${`status-${website.status}`}">
                            ${website.status.replace('_', ' ').toUpperCase()}
                        </div>
                    </div>
                    
                    <div>
                        <div style="font-weight: 600; color: #171C6B; margin-bottom: 8px;">Category</div>
                        <div style="color: #64748b;">${website.category}</div>
                    </div>
                    
                    ${website.description ? `
                    <div>
                        <div style="font-weight: 600; color: #171C6B; margin-bottom: 8px;">Description</div>
                        <div style="color: #64748b; line-height: 1.6;">${website.description}</div>
                    </div>
                    ` : ''}
                    
                    <div>
                        <div style="font-weight: 600; color: #171C6B; margin-bottom: 12px;">Traffic Statistics</div>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                            <div style="padding: 12px; background: rgba(248, 250, 255, 0.8); border-radius: 8px;">
                                <div style="font-size: 12px; color: #64748b; margin-bottom: 4px;">Monthly Visitors</div>
                                <div style="font-weight: 600; color: #171C6B;">${website.trafficStats?.monthlyVisitors || 'N/A'}</div>
                            </div>
                            <div style="padding: 12px; background: rgba(248, 250, 255, 0.8); border-radius: 8px;">
                                <div style="font-size: 12px; color: #64748b; margin-bottom: 4px;">Page Views</div>
                                <div style="font-weight: 600; color: #171C6B;">${website.trafficStats?.pageViews || 'N/A'}</div>
                            </div>
                        </div>
                    </div>
                    
                    ${!website.isVerified && website.verificationCode ? `
                    <div style="background: rgba(245, 158, 11, 0.1); padding: 16px; border-radius: 12px;">
                        <div style="font-weight: 600; color: #d97706; margin-bottom: 12px;"> Verification Required</div>
                        <div style="font-size: 14px; color: #64748b; margin-bottom: 12px;">
                            Add this code to your website's &lt;head&gt; section:
                        </div>
                        <textarea readonly style="width: 100%; padding: 12px; border: 1px solid rgba(0,0,0,0.1); 
                                  border-radius: 8px; font-family: monospace; font-size: 12px; resize: none;"
                                  rows="2">${`<meta name="trafficstars-verification" content="${website.verificationCode}">`}</textarea>
                    </div>
                    ` : ''}
                </div>
                
                <div class="form-actions" style="margin-top: 24px;">
                    <button class="btn-secondary" onclick="this.closest('.modal-overlay').remove(); document.body.style.overflow='';">
                        Close
                    </button>
                </div>
            </div>
        </div>
    `;
            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
        }

        async function deleteWebsite(websiteId) {
            if (!confirm('Are you sure you want to delete this website? This action cannot be undone.')) {
                return;
            }

            try {
                const response = await apiCall(`/websites/${websiteId}`, {
                    method: 'DELETE'
                });

                if (response.success) {
                    showToast('Deleted!', 'Website deleted successfully', 'success');
                    await loadWebsites();
                }
            } catch (error) {
                showToast('Error', 'Failed to delete website', 'error');
            }
        }

        async function refreshWebsites() {
            await loadWebsites();
            showToast('Refreshed!', 'Websites data updated', 'success');
        }

        // Update the switchSection function to handle websites section
        function switchSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('[id$="-section"]').forEach(section => {
                section.style.display = 'none';
            });

            // Show selected section
            const targetSection = document.getElementById(`${sectionName}-section`);
            if (targetSection) {
                targetSection.style.display = 'block';

                // Load data based on section
                if (sectionName === 'my-websites') {
                    loadWebsites();
                } else if (sectionName === 'my-placements') {
                    loadPlacements();
                }
            }

            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
        }

        // Initialize on page load - update the existing initializePublisherDashboard function
        async function initializePublisherDashboard() {
            const isAuthenticated = await checkAuthentication();

            if (!isAuthenticated) {
                redirectToLogin();
                return;
            }

            await loadPublisherStats();
            await loadPlacements();
            await loadWebsites(); // Add this line
            updateUserInterface();
        }
        // =============================================================================
        // ADD THIS JAVASCRIPT TO YOUR EXISTING <script> TAG IN publisher_admin.html
        // =============================================================================

        let analyticsData = null;
        let charts = {
            revenue: null,
            device: null,
            browser: null,
            hourly: null
        };
        let currentTimeRange = 'week';

        // =============================================================================
        // ANALYTICS LOADING FUNCTIONS
        // =============================================================================

        async function loadAnalytics(timeRange = 'week') {
            const loading = document.getElementById('analyticsLoading');
            const content = document.getElementById('analyticsContent');

            if (loading) loading.style.display = 'block';
            if (content) content.style.display = 'none';

            try {
                currentTimeRange = timeRange;

                // Load analytics overview
                const response = await apiCall(`/analytics/overview?range=${timeRange}`);
                analyticsData = response.analytics;

                // Load performance metrics
                const perfResponse = await apiCall('/analytics/performance');
                const performanceMetrics = perfResponse.metrics;

                if (loading) loading.style.display = 'none';
                if (content) content.style.display = 'block';

                // Update all components
                updateMetricCards(analyticsData.overview);
                renderRevenueChart(analyticsData.dailyData);
                renderDeviceChart(analyticsData.deviceData);
                renderBrowserChart(analyticsData.browserData);
                renderHourlyChart(analyticsData.hourlyData);
                renderGeoList(analyticsData.geoData);
                renderTopPlacements(analyticsData.topPlacements);
                updatePerformanceMetrics(performanceMetrics);

                console.log(' Analytics loaded successfully');
            } catch (error) {
                if (loading) loading.style.display = 'none';
                console.error('Failed to load analytics:', error);
                showToast('Error', 'Failed to load analytics data', 'error');
            }
        }

        // =============================================================================
        // METRIC CARDS
        // =============================================================================

        function updateMetricCards(overview) {
            // Update main metrics
            const impressions = overview.impressions || 0;
            const clicks = overview.clicks || 0;
            const revenue = overview.revenue || 0;
            const ctr = overview.ctr || 0;
            const rpm = overview.rpm || 0;

            animateValue('metricImpressions', 0, impressions, 1000, true);
            animateValue('metricClicks', 0, clicks, 1000, true);
            animateValue('metricRevenue', 0, revenue, 1000, false, '$');

            document.getElementById('metricCTR').textContent = `${ctr}%`;
            document.getElementById('metricRPM').textContent = `$${rpm}`;
            document.getElementById('metricFillRate').textContent = '94.5%';

            // Generate random changes for demo
            const changes = {
                impressions: (Math.random() * 20 + 5).toFixed(1),
                clicks: (Math.random() * 25 + 8).toFixed(1),
                revenue: (Math.random() * 30 + 10).toFixed(1),
                ctr: (Math.random() * 15 + 3).toFixed(1),
                rpm: (Math.random() * 18 + 5).toFixed(1),
                fillRate: (Math.random() * 5 + 1).toFixed(1)
            };

            document.getElementById('impressionsChange').textContent = `${changes.impressions}%`;
            document.getElementById('clicksChange').textContent = `${changes.clicks}%`;
            document.getElementById('revenueChange').textContent = `${changes.revenue}%`;
            document.getElementById('ctrChange').textContent = `${changes.ctr}%`;
            document.getElementById('rpmChange').textContent = `${changes.rpm}%`;
            document.getElementById('fillRateChange').textContent = `${changes.fillRate}%`;
        }

        function animateValue(elementId, start, end, duration, addCommas = false, prefix = '') {
            const element = document.getElementById(elementId);
            if (!element) return;

            const range = end - start;
            const increment = range / (duration / 16);
            let current = start;

            const timer = setInterval(() => {
                current += increment;
                if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                    current = end;
                    clearInterval(timer);
                }

                let displayValue = Math.round(current);
                if (addCommas) {
                    displayValue = displayValue.toLocaleString();
                } else if (prefix === '$') {
                    displayValue = displayValue.toFixed(2);
                }

                element.textContent = prefix + displayValue;
            }, 16);
        }

        // =============================================================================
        // CHARTS RENDERING
        // =============================================================================

        function renderRevenueChart(dailyData) {
            const ctx = document.getElementById('revenueChart');
            if (!ctx) return;

            // Destroy existing chart
            if (charts.revenue) {
                charts.revenue.destroy();
            }

            const labels = dailyData.map(d => {
                const date = new Date(d.date);
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            });

            charts.revenue = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Revenue',
                            data: dailyData.map(d => d.revenue),
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            yAxisID: 'y-revenue'
                        },
                        {
                            label: 'Impressions',
                            data: dailyData.map(d => d.impressions),
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            yAxisID: 'y-impressions'
                        },
                        {
                            label: 'Clicks',
                            data: dailyData.map(d => d.clicks),
                            borderColor: '#8b5cf6',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            yAxisID: 'y-clicks'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.98)',
                            titleColor: '#171C6B',
                            bodyColor: '#64748b',
                            borderColor: 'rgba(23, 28, 107, 0.1)',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true,
                            callbacks: {
                                label: function (context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.dataset.yAxisID === 'y-revenue') {
                                        label += '$' + context.parsed.y.toFixed(2);
                                    } else {
                                        label += context.parsed.y.toLocaleString();
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#64748b',
                                font: {
                                    size: 11
                                }
                            }
                        },
                        'y-revenue': {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            grid: {
                                color: 'rgba(23, 28, 107, 0.05)'
                            },
                            ticks: {
                                color: '#10b981',
                                callback: function (value) {
                                    return '$' + value.toFixed(0);
                                }
                            }
                        },
                        'y-impressions': {
                            type: 'linear',
                            display: false,
                            position: 'right',
                            grid: {
                                drawOnChartArea: false
                            }
                        },
                        'y-clicks': {
                            type: 'linear',
                            display: false,
                            position: 'right',
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    }
                }
            });
        }

        function renderDeviceChart(deviceData) {
            const ctx = document.getElementById('deviceChart');
            if (!ctx) return;

            if (charts.device) {
                charts.device.destroy();
            }

            charts.device = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: deviceData.map(d => d.device),
                    datasets: [{
                        data: deviceData.map(d => d.impressions),
                        backgroundColor: [
                            '#3b82f6',
                            '#10b981',
                            '#f59e0b'
                        ],
                        borderWidth: 0,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    size: 12,
                                    weight: '600'
                                },
                                color: '#64748b'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.98)',
                            titleColor: '#171C6B',
                            bodyColor: '#64748b',
                            borderColor: 'rgba(23, 28, 107, 0.1)',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function (context) {
                                    const device = deviceData[context.dataIndex];
                                    return [
                                        `Impressions: ${device.impressions.toLocaleString()}`,
                                        `Clicks: ${device.clicks.toLocaleString()}`,
                                        `Revenue: $${device.revenue.toFixed(2)}`,
                                        `Share: ${device.percentage}%`
                                    ];
                                }
                            }
                        }
                    },
                    cutout: '65%'
                }
            });
        }

        function renderBrowserChart(browserData) {
            const ctx = document.getElementById('browserChart');
            if (!ctx) return;

            if (charts.browser) {
                charts.browser.destroy();
            }

            charts.browser = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: browserData.map(b => b.browser),
                    datasets: [{
                        data: browserData.map(b => b.percentage),
                        backgroundColor: browserData.map(b => b.color),
                        borderWidth: 0,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    size: 12,
                                    weight: '600'
                                },
                                color: '#64748b'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.98)',
                            titleColor: '#171C6B',
                            bodyColor: '#64748b',
                            borderColor: 'rgba(23, 28, 107, 0.1)',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function (context) {
                                    return `${context.label}: ${context.parsed}%`;
                                }
                            }
                        }
                    },
                    cutout: '65%'
                }
            });
        }

        function renderHourlyChart(hourlyData) {
            const ctx = document.getElementById('hourlyChart');
            if (!ctx) return;

            if (charts.hourly) {
                charts.hourly.destroy();
            }

            charts.hourly = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: hourlyData.map(h => h.hour),
                    datasets: [{
                        label: 'Revenue',
                        data: hourlyData.map(h => h.revenue),
                        backgroundColor: 'rgba(16, 185, 129, 0.8)',
                        borderRadius: 8,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.98)',
                            titleColor: '#171C6B',
                            bodyColor: '#64748b',
                            borderColor: 'rgba(23, 28, 107, 0.1)',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function (context) {
                                    const data = hourlyData[context.dataIndex];
                                    return [
                                        `Revenue: $${data.revenue.toFixed(2)}`,
                                        `Impressions: ${data.impressions.toLocaleString()}`,
                                        `Clicks: ${data.clicks.toLocaleString()}`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#64748b',
                                font: {
                                    size: 10
                                }
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(23, 28, 107, 0.05)'
                            },
                            ticks: {
                                color: '#64748b',
                                callback: function (value) {
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });
        }

        // =============================================================================
        // LISTS RENDERING
        // =============================================================================

        function renderGeoList(geoData) {
            const geoList = document.getElementById('geoList');
            if (!geoList) return;

            geoList.innerHTML = '';

            geoData.slice(0, 6).forEach(geo => {
                const item = document.createElement('div');
                item.className = 'geo-item';
                item.innerHTML = `
            <div class="geo-flag">${geo.flag}</div>
            <div class="geo-country">${geo.country}</div>
            <div class="geo-stats">
                ${geo.impressions.toLocaleString()} imp  ${geo.clicks.toLocaleString()} clicks
            </div>
            <div class="geo-revenue">$${geo.revenue.toFixed(2)}</div>
        `;
                geoList.appendChild(item);
            });
        }

        function renderTopPlacements(placements) {
            const list = document.getElementById('topPlacementsList');
            if (!list) return;

            list.innerHTML = '';

            if (placements.length === 0) {
                list.innerHTML = `
            <div style="text-align: center; padding: 40px 20px; color: #64748b;">
                <div style="font-size: 48px; margin-bottom: 12px;"></div>
                <div>No placement data available yet</div>
            </div>
        `;
                return;
            }

            placements.slice(0, 5).forEach((placement, index) => {
                const item = document.createElement('div');
                item.className = 'placement-item';
                item.innerHTML = `
            <div class="placement-item-header">
                <div class="placement-item-name">${placement.name}</div>
                <div class="placement-item-revenue">$${placement.revenue.toFixed(2)}</div>
            </div>
            <div class="placement-item-stats">
                <div class="placement-stat">
                    <div class="placement-stat-value">${placement.impressions.toLocaleString()}</div>
                    <div class="placement-stat-label">Impressions</div>
                </div>
                <div class="placement-stat">
                    <div class="placement-stat-value">${placement.clicks.toLocaleString()}</div>
                    <div class="placement-stat-label">Clicks</div>
                </div>
                <div class="placement-stat">
                    <div class="placement-stat-value">${placement.ctr}%</div>
                    <div class="placement-stat-label">CTR</div>
                </div>
            </div>
        `;
                list.appendChild(item);
            });
        }

        function updatePerformanceMetrics(metrics) {
            // Update bars
            setTimeout(() => {
                document.getElementById('viewabilityBar').style.width = `${metrics.viewability}%`;
                document.getElementById('invalidBar').style.width = `${metrics.invalidTraffic}%`;
                document.getElementById('adBlockBar').style.width = `${metrics.adBlockRate}%`;
            }, 100);

            document.getElementById('viewabilityValue').textContent = `${metrics.viewability}%`;
            document.getElementById('invalidValue').textContent = `${metrics.invalidTraffic}%`;
            document.getElementById('adBlockValue').textContent = `${metrics.adBlockRate}%`;

            // Update audience insights
            document.getElementById('sessionDuration').textContent = metrics.avgSessionDuration;
            document.getElementById('pagesSession').textContent = metrics.pagesPerSession.toFixed(1);
            document.getElementById('bounceRate').textContent = `${metrics.bounceRate}%`;

            // Update visitor chart
            setTimeout(() => {
                document.getElementById('newVisitors').style.width = `${metrics.newVsReturning.new}%`;
                document.getElementById('returningVisitors').style.width = `${metrics.newVsReturning.returning}%`;
            }, 100);

            document.getElementById('newPercent').textContent = `${metrics.newVsReturning.new}%`;
            document.getElementById('returningPercent').textContent = `${metrics.newVsReturning.returning}%`;
        }

        // =============================================================================
        // USER ACTIONS
        // =============================================================================

        function changeAnalyticsTimeRange(range) {
            loadAnalytics(range);
        }

        async function refreshAnalytics() {
            await loadAnalytics(currentTimeRange);
            showToast('Refreshed!', 'Analytics data updated', 'success');
        }

        async function exportAnalytics() {
            try {
                const response = await apiCall('/analytics/export', {
                    method: 'POST',
                    body: JSON.stringify({
                        format: 'csv',
                        timeRange: currentTimeRange
                    })
                });

                if (response.success) {
                    showToast('Success!', 'Report is being generated. Download will start shortly.', 'success');
                }
            } catch (error) {
                showToast('Error', 'Failed to export analytics', 'error');
            }
        }

        function viewFullGeoReport() {
            if (!analyticsData || !analyticsData.geoData) return;

            const modal = document.createElement('div');
            modal.className = 'modal-overlay active';

            let geoHTML = '';
            analyticsData.geoData.forEach(geo => {
                geoHTML += `
            <div class="geo-item">
                <div class="geo-flag">${geo.flag}</div>
                <div class="geo-country">${geo.country}</div>
                <div class="geo-stats">
                    ${geo.impressions.toLocaleString()} impressions<br>
                    ${geo.clicks.toLocaleString()} clicks
                </div>
                <div class="geo-revenue">$${geo.revenue.toFixed(2)}</div>
            </div>
        `;
            });

            modal.innerHTML = `
        <div class="placement-modal" style="transform: translate(-50%, -50%) scale(1); max-width: 800px;">
            <div class="modal-header">
                <button class="modal-close" onclick="this.closest('.modal-overlay').remove(); document.body.style.overflow='';"></button>
                <h2 class="modal-title">Geographic Performance Report</h2>
                <p class="modal-subtitle">Detailed breakdown by country</p>
            </div>
            <div class="modal-content">
                <div class="geo-list">${geoHTML}</div>
                <div class="form-actions" style="margin-top: 24px;">
                    <button class="btn-secondary" onclick="this.closest('.modal-overlay').remove(); document.body.style.overflow='';">
                        Close
                    </button>
                    <button class="btn-primary" onclick="exportGeoReport()">
                         Export CSV
                    </button>
                </div>
            </div>
        </div>
    `;

            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
        }

        function exportGeoReport() {
            showToast('Success!', 'Geographic report is being generated', 'success');
        }

        function viewAllPlacements() {
            switchSection('my-placements');
        }

        // Update the switchSection function to load analytics when switching
        const originalSwitchSection = switchSection;
        switchSection = function (sectionName) {
            originalSwitchSection(sectionName);

            if (sectionName === 'analytics') {
                loadAnalytics(currentTimeRange);
            }
        };

        // Update initializePublisherDashboard to prepare analytics
        const originalInitialize = initializePublisherDashboard;
        initializePublisherDashboard = async function () {
            await originalInitialize();
            // Analytics will be loaded when user switches to analytics section
        };
        // =============================================================================
        // ADD THIS JAVASCRIPT TO YOUR EXISTING <script> TAG IN publisher_admin.html
        // =============================================================================

        let currentSettings = null;

        // =============================================================================
        // SETTINGS LOADING
        // =============================================================================

        async function loadSettings() {
            const loading = document.getElementById('settingsLoading');
            const content = document.getElementById('settingsContent');

            if (loading) loading.style.display = 'block';
            if (content) content.style.display = 'none';

            try {
                const response = await apiCall('/settings');
                currentSettings = response.settings;

                if (loading) loading.style.display = 'none';
                if (content) content.style.display = 'block';

                populateSettingsForms(currentSettings);
                await loadSessions();

                console.log(' Settings loaded successfully');
            } catch (error) {
                if (loading) loading.style.display = 'none';
                console.error('Failed to load settings:', error);
                showToast('Error', 'Failed to load settings', 'error');
            }
        }

        function populateSettingsForms(settings) {
            // Account Info
            const accountForm = document.getElementById('accountInfoForm');
            if (accountForm) {
                accountForm.elements.name.value = settings.account.name || '';
                accountForm.elements.email.value = settings.account.email || '';
                accountForm.elements.company.value = settings.account.company || '';
                accountForm.elements.phone.value = settings.account.phone || '';
                accountForm.elements.country.value = settings.account.country || '';
            }

            // Security
            const twoFactorToggle = document.getElementById('twoFactorToggle');
            if (twoFactorToggle) {
                twoFactorToggle.checked = settings.security.twoFactorEnabled || false;
            }

            const lastPasswordChange = document.getElementById('lastPasswordChange');
            if (lastPasswordChange && settings.security.lastPasswordChange) {
                const date = new Date(settings.security.lastPasswordChange);
                lastPasswordChange.textContent = date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            }

            // Notifications
            const notifForm = document.getElementById('notificationsForm');
            if (notifForm) {
                notifForm.elements.emailNotifications.checked = settings.notifications.emailNotifications;
                notifForm.elements.paymentAlerts.checked = settings.notifications.paymentAlerts;
                notifForm.elements.performanceReports.checked = settings.notifications.performanceReports;
                notifForm.elements.weeklyDigest.checked = settings.notifications.weeklyDigest;
            }

            // Payment Settings
            const paymentForm = document.getElementById('paymentSettingsForm');
            if (paymentForm) {
                paymentForm.elements.paymentMethod.value = settings.payment.paymentMethod || 'bank_transfer';
                paymentForm.elements.minimumPayout.value = settings.payment.minimumPayout || 100;
            }
        }

        // =============================================================================
        // ACCOUNT INFORMATION
        // =============================================================================

        async function updateAccountInfo(event) {
            event.preventDefault();

            const form = event.target;
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;

            submitBtn.disabled = true;
            submitBtn.textContent = 'Saving...';

            try {
                const formData = new FormData(form);
                const accountData = {
                    name: formData.get('name'),
                    company: formData.get('company'),
                    phone: formData.get('phone'),
                    country: formData.get('country')
                };

                const response = await apiCall('/settings/account', {
                    method: 'PUT',
                    body: JSON.stringify(accountData)
                });

                if (response.success) {
                    showToast('Success!', 'Account information updated', 'success');

                    // Update user name in header
                    if (currentUser) {
                        currentUser.name = accountData.name;
                        document.querySelector('.user-name').textContent = accountData.name;
                        document.querySelector('.welcome-title').textContent =
                            `Welcome back, ${accountData.name.split(' ')[0]}`;
                    }
                }
            } catch (error) {
                console.error('Account update failed:', error);
                showToast('Error', error.message || 'Failed to update account information', 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }

        // =============================================================================
        // PASSWORD CHANGE
        // =============================================================================

        async function changePassword(event) {
            event.preventDefault();

            const form = event.target;
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;

            const formData = new FormData(form);
            const currentPassword = formData.get('currentPassword');
            const newPassword = formData.get('newPassword');
            const confirmPassword = formData.get('confirmPassword');

            // Client-side validation
            if (newPassword !== confirmPassword) {
                showToast('Error', 'New passwords do not match', 'error');
                return;
            }

            if (newPassword.length < 6) {
                showToast('Error', 'Password must be at least 6 characters', 'error');
                return;
            }

            submitBtn.disabled = true;
            submitBtn.textContent = 'Changing Password...';

            try {
                const response = await apiCall('/settings/password', {
                    method: 'PUT',
                    body: JSON.stringify({
                        currentPassword,
                        newPassword,
                        confirmPassword
                    })
                });

                if (response.success) {
                    showToast('Success!', 'Password changed successfully', 'success');
                    form.reset();

                    // Update last password change date
                    const lastPasswordChange = document.getElementById('lastPasswordChange');
                    if (lastPasswordChange) {
                        lastPasswordChange.textContent = new Date().toLocaleDateString('en-US', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                        });
                    }
                }
            } catch (error) {
                console.error('Password change failed:', error);
                showToast('Error', error.message || 'Failed to change password', 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }

        // =============================================================================
        // TWO-FACTOR AUTHENTICATION
        // =============================================================================

        async function toggle2FA(enabled) {
            try {
                const response = await apiCall('/settings/2fa', {
                    method: 'PUT',
                    body: JSON.stringify({ enabled })
                });

                if (response.success) {
                    showToast(
                        enabled ? 'Enabled!' : 'Disabled!',
                        `Two-factor authentication ${enabled ? 'enabled' : 'disabled'}`,
                        'success'
                    );
                }
            } catch (error) {
                console.error('2FA toggle failed:', error);
                showToast('Error', 'Failed to update two-factor authentication', 'error');

                // Revert toggle on error
                const toggle = document.getElementById('twoFactorToggle');
                if (toggle) toggle.checked = !enabled;
            }
        }

        // =============================================================================
        // NOTIFICATIONS
        // =============================================================================

        let notificationUpdateTimeout;

        async function updateNotifications() {
            // Debounce updates
            clearTimeout(notificationUpdateTimeout);

            notificationUpdateTimeout = setTimeout(async () => {
                try {
                    const form = document.getElementById('notificationsForm');
                    const formData = new FormData(form);

                    const notifications = {
                        emailNotifications: formData.get('emailNotifications') === 'on',
                        paymentAlerts: formData.get('paymentAlerts') === 'on',
                        performanceReports: formData.get('performanceReports') === 'on',
                        weeklyDigest: formData.get('weeklyDigest') === 'on'
                    };

                    const response = await apiCall('/settings/notifications', {
                        method: 'PUT',
                        body: JSON.stringify(notifications)
                    });

                    if (response.success) {
                        showToast('Saved!', 'Notification preferences updated', 'success');
                    }
                } catch (error) {
                    console.error('Notifications update failed:', error);
                    showToast('Error', 'Failed to update notifications', 'error');
                }
            }, 500);
        }

        // =============================================================================
        // PAYMENT SETTINGS
        // =============================================================================

        async function updatePaymentSettings(event) {
            event.preventDefault();

            const form = event.target;
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;

            submitBtn.disabled = true;
            submitBtn.textContent = 'Saving...';

            try {
                const formData = new FormData(form);
                const paymentData = {
                    paymentMethod: formData.get('paymentMethod'),
                    minimumPayout: parseInt(formData.get('minimumPayout'))
                };

                if (paymentData.minimumPayout < 50 || paymentData.minimumPayout > 10000) {
                    showToast('Error', 'Minimum payout must be between $50 and $10,000', 'error');
                    return;
                }

                const response = await apiCall('/settings/payment', {
                    method: 'PUT',
                    body: JSON.stringify(paymentData)
                });

                if (response.success) {
                    showToast('Success!', 'Payment settings updated', 'success');
                }
            } catch (error) {
                console.error('Payment settings update failed:', error);
                showToast('Error', 'Failed to update payment settings', 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }

        // =============================================================================
        // SESSIONS MANAGEMENT
        // =============================================================================

        async function loadSessions() {
            try {
                const response = await apiCall('/settings/sessions');
                const sessions = response.sessions || [];

                renderSessions(sessions);
            } catch (error) {
                console.error('Failed to load sessions:', error);
            }
        }

        function renderSessions(sessions) {
            const sessionsList = document.getElementById('sessionsList');
            if (!sessionsList) return;

            if (sessions.length === 0) {
                sessionsList.innerHTML = `
            <div style="text-align: center; padding: 40px 20px; color: #64748b;">
                No active sessions
            </div>
        `;
                return;
            }

            sessionsList.innerHTML = '';

            sessions.forEach(session => {
                const item = document.createElement('div');
                item.className = 'session-item';

                const lastActive = new Date(session.lastActive);
                const timeAgo = getTimeAgo(lastActive);

                item.innerHTML = `
            <div class="session-info">
                <div class="session-device">${session.device}</div>
                <div class="session-details">
                    ${session.location}  ${session.ip}<br>
                    Last active: ${timeAgo}
                </div>
                ${session.current ? '<div class="session-current">Current Session</div>' : ''}
            </div>
            ${!session.current ? `
                <button class="action-btn danger" onclick="logoutSession('${session.id}')">
                    Logout
                </button>
            ` : ''}
        `;

                sessionsList.appendChild(item);
            });
        }

        function getTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);

            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return `${Math.floor(seconds / 60)} minutes ago`;
            if (seconds < 86400) return `${Math.floor(seconds / 3600)} hours ago`;
            return `${Math.floor(seconds / 86400)} days ago`;
        }

        async function logoutSession(sessionId) {
            if (!confirm('Are you sure you want to logout this session?')) {
                return;
            }

            try {
                const response = await apiCall(`/settings/sessions/${sessionId}`, {
                    method: 'DELETE'
                });

                if (response.success) {
                    showToast('Success!', 'Session logged out', 'success');
                    await loadSessions();
                }
            } catch (error) {
                console.error('Session logout failed:', error);
                showToast('Error', 'Failed to logout session', 'error');
            }
        }

        // =============================================================================
        // DELETE ACCOUNT
        // =============================================================================

        function openDeleteAccountModal() {
            document.getElementById('deleteAccountModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeDeleteAccountModal() {
            document.getElementById('deleteAccountModal').classList.remove('active');
            document.getElementById('deleteAccountForm').reset();
            document.body.style.overflow = '';
        }

        async function deleteAccount(event) {
            event.preventDefault();

            const form = event.target;
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;

            const formData = new FormData(form);
            const password = formData.get('password');
            const confirmation = formData.get('confirmation');

            if (confirmation !== 'DELETE') {
                showToast('Error', 'Please type DELETE to confirm', 'error');
                return;
            }

            // Final confirmation
            if (!confirm('This is your LAST CHANCE. Are you absolutely sure you want to delete your account? This cannot be undone!')) {
                return;
            }

            submitBtn.disabled = true;
            submitBtn.textContent = 'Deleting Account...';

            try {
                const response = await apiCall('/settings/account', {
                    method: 'DELETE',
                    body: JSON.stringify({ password, confirmation })
                });

                if (response.success) {
                    showToast('Account Deleted', 'Your account has been permanently deleted', 'success');

                    // Clear local storage
                    localStorage.removeItem('authToken');
                    localStorage.removeItem('userData');

                    // Redirect to home page after 2 seconds
                    setTimeout(() => {
                        window.location.href = '/';
                    }, 2000);
                }
            } catch (error) {
                console.error('Account deletion failed:', error);
                showToast('Error', error.message || 'Failed to delete account', 'error');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }
        const originalSwitchSectionForSettings = switchSection;
        switchSection = function (sectionName) {
            originalSwitchSectionForSettings(sectionName);

            if (sectionName === 'settings') {
                loadSettings();
            }
        };

        // Close modals with escape key
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                closeDeleteAccountModal();
            }
        });
        function toggleUserMenu(event) {
        event.stopPropagation();
        const menu = document.querySelector('.user-dropdown-menu');
        menu.classList.toggle('active');
    }

    // Close dropdown when clicking outside
    document.addEventListener('click', function(e) {
        const dropdown = document.querySelector('.user-dropdown');
        const menu = document.querySelector('.user-dropdown-menu');
        if (dropdown && menu && !dropdown.contains(e.target)) {
            menu.classList.remove('active');
        }
    });

    // Logout function (you already have this, but here's the reference)
    async function logout() {
        try {
            await apiCall('/auth/logout', { method: 'POST' });
        } catch (error) {
            console.error('Logout failed:', error);
        }
        
        localStorage.removeItem('authToken');
        localStorage.removeItem('userData');
        showToast('Logged Out', 'You have been successfully logged out', 'success');
        
        setTimeout(() => {
            window.location.href = './authenticate.html';
        }, 1000);
    }
    </script>
</body>

</html>