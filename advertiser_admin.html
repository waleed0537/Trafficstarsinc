<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Advertiser Dashboard - TrafficStars</title>

    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=USD"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        /* ==========================================================================
           MOBILE RESPONSIVE ENHANCEMENTS
           ========================================================================== */

        /* Mobile Navigation Toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 24px;
            color: #171C6B;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        /* ==========================================================================
   ADD FUNDS MODAL STYLES
   ========================================================================== */

        .add-funds-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: white;
            border-radius: 24px;
            box-shadow: 0 32px 80px rgba(23, 28, 107, 0.3);
            z-index: 2001;
            max-width: 700px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-overlay.active .add-funds-modal {
            transform: translate(-50%, -50%) scale(1);
        }

        /* =============================================================================
   ADDITIONAL CSS FOR MULTIPLE URLS DISPLAY - Add to advertiser_admin.html
   ============================================================================= */

        /* Campaign URLs Tooltip */
        .campaign-urls {
            position: relative;
            display: inline-block;
        }

        .campaign-urls .campaign-url {
            cursor: help;
            color: #2d4ef5;
            text-decoration: underline;
            text-decoration-style: dotted;
        }

        .campaign-urls-tooltip {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 0;
            background: white;
            border: 1px solid rgba(23, 28, 107, 0.1);
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.15);
            z-index: 1000;
            min-width: 300px;
            margin-bottom: 8px;
        }

        .campaign-urls-tooltip a {
            display: block;
            color: #2d4ef5;
            text-decoration: none;
            padding: 8px 0;
            font-size: 14px;
            border-bottom: 1px solid rgba(23, 28, 107, 0.05);
            transition: all 0.2s ease;
        }

        .campaign-urls-tooltip a:last-child {
            border-bottom: none;
        }

        .campaign-urls-tooltip a:hover {
            color: #171C6B;
            padding-left: 8px;
        }

        .campaign-urls:hover .campaign-urls-tooltip {
            display: block;
        }

        /* View Campaign Details - Updated to show multiple URLs */
        .campaign-details-modal {
            max-height: 80vh;
            overflow-y: auto;
        }

        .campaign-urls-list {
            list-style: none;
            padding: 0;
            margin: 12px 0;
        }

        .campaign-urls-list li {
            padding: 8px 12px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .campaign-urls-list li::before {
            content: "🔗";
            font-size: 16px;
        }

        .campaign-urls-list a {
            color: #2d4ef5;
            text-decoration: none;
            flex: 1;
            word-break: break-all;
        }

        .campaign-urls-list a:hover {
            text-decoration: underline;
        }

        /* Mobile responsive for URLs */
        @media (max-width: 768px) {
            .campaign-urls-tooltip {
                left: auto;
                right: 0;
                min-width: 250px;
            }

            .campaign-urls-list li {
                font-size: 13px;
            }
        }

        /* Funds Section */
        .funds-section {
            margin-bottom: 32px;
        }

        .funds-section-title {
            font-size: 18px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Amount Selection */
        .amount-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        /* Additional styles for URL inputs */
        .url-input-group {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
            align-items: center;
        }

        .url-input-group .url-input {
            flex: 1;
        }

        .url-input-group .btn-icon {
            padding: 12px 16px;
            background: rgba(220, 38, 38, 0.1);
            border: 1px solid rgba(220, 38, 38, 0.2);
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .url-input-group .btn-icon:hover {
            background: rgba(220, 38, 38, 0.2);
            transform: scale(1.05);
        }

        .url-input.valid {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.05);
        }

        .url-input.invalid {
            border-color: #dc2626;
            background: rgba(220, 38, 38, 0.05);
        }

        .amount-card {
            padding: 24px 16px;
            border: 2px solid rgba(23, 28, 107, 0.1);
            border-radius: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(248, 250, 255, 0.5);
            position: relative;
            overflow: hidden;
        }

        .amount-card:hover {
            border-color: rgba(45, 78, 245, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.1);
        }

        .amount-card.selected {
            border-color: #2d4ef5;
            background: linear-gradient(135deg, rgba(45, 78, 245, 0.1) 0%, rgba(45, 78, 245, 0.05) 100%);
        }

        .amount-card.popular {
            border-color: #2d4ef5;
        }

        .amount-popular-badge {
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            background: linear-gradient(135deg, #2d4ef5 0%, #171C6B 100%);
            color: white;
            font-size: 11px;
            font-weight: 600;
            padding: 4px;
            text-align: center;
            border-radius: 14px 14px 0 0;
        }

        .amount-card.popular {
            padding-top: 32px;
        }

        .amount-value {
            font-size: 28px;
            font-weight: 800;
            color: #171C6B;
            margin-bottom: 6px;
        }

        .amount-label {
            font-size: 13px;
            color: #64748b;
            font-weight: 500;
        }

        /* Custom Amount Input */
        .custom-amount-input {
            margin-top: 20px;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .amount-input-wrapper {
            position: relative;
        }

        .amount-currency {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            font-weight: 700;
            color: #171C6B;
        }

        .amount-input {
            padding-left: 45px;
            font-size: 18px;
            font-weight: 600;
        }

        /* Payment Methods Grid */
        .payment-methods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .payment-method-card {
            padding: 24px 20px;
            border: 2px solid rgba(23, 28, 107, 0.1);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(248, 250, 255, 0.5);
            text-align: center;
        }

        .payment-method-card:hover {
            border-color: rgba(45, 78, 245, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.1);
        }

        .payment-method-card.active {
            border-color: #2d4ef5;
            background: linear-gradient(135deg, rgba(45, 78, 245, 0.1) 0%, rgba(45, 78, 245, 0.05) 100%);
        }

        .payment-method-logo {
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
        }

        .payment-method-name {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .payment-method-desc {
            font-size: 13px;
            color: #64748b;
        }

        /* Stripe Card Element */
        .stripe-card-element {
            padding: 16px 20px;
            border: 2px solid rgba(23, 28, 107, 0.1);
            border-radius: 12px;
            background: rgba(248, 250, 255, 0.5);
            transition: all 0.3s ease;
        }

        .stripe-card-element.StripeElement--focus {
            border-color: #2d4ef5;
            background: white;
            box-shadow: 0 0 0 4px rgba(45, 78, 245, 0.1);
        }

        .stripe-card-element.StripeElement--invalid {
            border-color: #dc2626;
        }

        .card-errors {
            color: #dc2626;
            font-size: 14px;
            margin-top: 8px;
            font-weight: 500;
        }

        /* Security Badges */
        .security-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-top: 20px;
            padding: 16px;
            background: rgba(16, 185, 129, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(16, 185, 129, 0.1);
        }

        .security-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            color: #059669;
            font-weight: 600;
        }

        .security-badge span:first-child {
            font-size: 16px;
        }

        /* Payment Summary */
        .payment-summary {
            background: linear-gradient(135deg, rgba(23, 28, 107, 0.05) 0%, rgba(45, 78, 245, 0.03) 100%);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 24px;
            border: 1px solid rgba(23, 28, 107, 0.1);
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }

        .summary-row.total {
            border-top: 2px solid rgba(23, 28, 107, 0.1);
            margin-top: 8px;
            padding-top: 16px;
            font-size: 18px;
            font-weight: 700;
        }

        .summary-label {
            color: #64748b;
            font-weight: 500;
        }

        .summary-value {
            color: #171C6B;
            font-weight: 700;
        }

        .summary-row.total .summary-value {
            font-size: 24px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* PayPal Button Container */
        #paypal-button-container {
            margin: 20px 0;
        }

        /* Mobile Responsive - Add Funds */
        @media (max-width: 768px) {
            .add-funds-modal {
                width: 95%;
                max-height: 95vh;
            }

            .amount-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }

            .amount-card {
                padding: 20px 12px;
            }

            .amount-value {
                font-size: 24px;
            }

            .payment-methods-grid {
                grid-template-columns: 1fr;
            }

            .security-badges {
                flex-direction: column;
                gap: 12px;
            }
        }

        @media (max-width: 480px) {
            .amount-grid {
                grid-template-columns: 1fr;
            }

            .amount-value {
                font-size: 28px;
            }

            .summary-row.total .summary-value {
                font-size: 20px;
            }
        }

        /* ==========================================================================
   SETTINGS SECTION STYLES
   ========================================================================== */

        /* Settings Navigation */
        .settings-nav {
            display: flex;
            gap: 12px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            padding: 12px;
            border-radius: 16px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            margin-bottom: 32px;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .settings-nav::-webkit-scrollbar {
            display: none;
        }

        .settings-nav-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            color: #64748b;
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .settings-nav-item:hover {
            background: rgba(248, 250, 255, 0.8);
            color: #171C6B;
        }

        .settings-nav-item.active {
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            color: white;
            box-shadow: 0 4px 16px rgba(23, 28, 107, 0.3);
        }

        .settings-nav-icon {
            font-size: 18px;
        }

        /* Settings Content */
        .settings-content {
            position: relative;
        }

        .settings-panel {
            display: none;
        }

        .settings-panel.active {
            display: block;
        }

        .settings-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
            margin-bottom: 24px;
            overflow: hidden;
        }

        .settings-card-header {
            padding: 28px 32px;
            border-bottom: 1px solid rgba(23, 28, 107, 0.08);
        }

        .settings-card-title {
            font-size: 20px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 6px;
        }

        .settings-card-subtitle {
            font-size: 15px;
            color: #64748b;
        }

        .settings-card-body {
            padding: 32px;
        }

        /* Profile Photo Section */
        .profile-photo-section {
            display: flex;
            align-items: center;
            gap: 24px;
            padding: 24px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 16px;
            margin-bottom: 32px;
        }

        .profile-photo-wrapper {
            position: relative;
        }

        .profile-photo {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 36px;
            font-weight: 700;
            box-shadow: 0 8px 24px rgba(23, 28, 107, 0.2);
        }

        .profile-photo-edit {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 36px;
            height: 36px;
            background: white;
            border: 3px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(23, 28, 107, 0.15);
            transition: all 0.3s ease;
        }

        .profile-photo-edit:hover {
            transform: scale(1.1);
        }

        .profile-photo-info h4 {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        /* Settings Form */
        .settings-form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .form-hint {
            display: block;
            font-size: 13px;
            color: #64748b;
            margin-top: 6px;
        }

        .settings-form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            padding-top: 24px;
            border-top: 1px solid rgba(23, 28, 107, 0.08);
        }

        .btn-secondary-small {
            padding: 8px 16px;
            background: transparent;
            color: #171C6B;
            border: 2px solid rgba(23, 28, 107, 0.2);
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary-small:hover {
            background: rgba(23, 28, 107, 0.05);
        }

        /* Info Grid */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .info-label {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
        }

        .info-value {
            font-size: 16px;
            color: #171C6B;
            font-weight: 600;
        }

        /* Password Strength */
        .password-strength {
            margin-top: 24px;
            padding: 20px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 12px;
        }

        .password-strength-label {
            font-size: 14px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 8px;
        }

        .password-strength-bar {
            height: 8px;
            background: rgba(23, 28, 107, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .password-strength-fill {
            height: 100%;
            width: 0%;
            background: #dc2626;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .password-strength-text {
            font-size: 13px;
            color: #64748b;
            font-weight: 500;
        }

        /* Feature Box */
        .feature-box {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 24px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 16px;
        }

        .feature-icon {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 8px 24px rgba(23, 28, 107, 0.15);
        }

        .feature-content {
            flex: 1;
        }

        .feature-title {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .feature-description {
            font-size: 14px;
            color: #64748b;
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 52px;
            height: 28px;
            flex-shrink: 0;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #cbd5e1;
            transition: 0.3s;
            border-radius: 28px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        input:checked+.toggle-slider {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        input:checked+.toggle-slider:before {
            transform: translateX(24px);
        }

        /* Sessions List */
        .sessions-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .session-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .session-item:hover {
            background: rgba(248, 250, 255, 0.9);
        }

        .session-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .session-device {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .session-details h4 {
            font-size: 15px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .session-details p {
            font-size: 13px;
            color: #64748b;
        }

        .session-current {
            padding: 4px 12px;
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 8px;
        }

        .btn-text {
            background: none;
            border: none;
            color: #171C6B;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .btn-text:hover {
            background: rgba(23, 28, 107, 0.05);
        }

        .btn-text.danger {
            color: #dc2626;
        }

        .btn-text.danger:hover {
            background: rgba(220, 38, 38, 0.05);
        }

        /* Notification Items */
        .notification-items {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .notification-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 0;
            border-bottom: 1px solid rgba(23, 28, 107, 0.06);
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-info {
            flex: 1;
        }

        .notification-title {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .notification-description {
            font-size: 14px;
            color: #64748b;
        }

        /* Balance Display */
        .balance-display {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 32px;
            background: linear-gradient(135deg, rgba(23, 28, 107, 0.05) 0%, rgba(45, 78, 245, 0.03) 100%);
            border-radius: 16px;
            margin-bottom: 24px;
        }

        .balance-amount {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .balance-label {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
        }

        .balance-value {
            font-size: 42px;
            font-weight: 800;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .balance-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .balance-info-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 12px;
        }

        .balance-info-icon {
            font-size: 32px;
        }

        .balance-info-label {
            font-size: 13px;
            color: #64748b;
            margin-bottom: 4px;
        }

        .balance-info-value {
            font-size: 20px;
            font-weight: 700;
            color: #171C6B;
        }

        /* Payment Methods */
        .payment-methods {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .payment-method-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 20px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 12px;
        }

        .payment-method-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .payment-method-info {
            flex: 1;
        }

        .payment-method-name {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .payment-method-details {
            font-size: 14px;
            color: #64748b;
        }

        /* Transactions List */
        .transactions-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .transaction-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .transaction-item:hover {
            background: rgba(248, 250, 255, 0.9);
        }

        .transaction-icon {
            width: 40px;
            height: 40px;
            background: rgba(220, 38, 38, 0.1);
            color: #dc2626;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 700;
        }

        .transaction-icon.success {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
        }

        .transaction-info {
            flex: 1;
        }

        .transaction-title {
            font-size: 15px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .transaction-date {
            font-size: 13px;
            color: #64748b;
        }

        .transaction-amount {
            font-size: 18px;
            font-weight: 700;
            color: #dc2626;
        }

        .transaction-amount.success {
            color: #059669;
        }

        /* API Keys */
        .api-keys-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .api-key-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 24px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 12px;
        }

        .api-key-info {
            flex: 1;
        }

        .api-key-name {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 12px;
        }

        .api-key-value {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .api-key-value code {
            background: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #171C6B;
            border: 1px solid rgba(23, 28, 107, 0.1);
        }

        .btn-icon {
            background: white;
            border: 1px solid rgba(23, 28, 107, 0.1);
            border-radius: 8px;
            padding: 6px 10px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-icon:hover {
            background: rgba(23, 28, 107, 0.05);
        }

        .api-key-date {
            font-size: 13px;
            color: #64748b;
        }

        /* API Docs Grid */
        .api-docs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
        }

        .api-doc-card {
            padding: 24px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 12px;
            text-decoration: none;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .api-doc-card:hover {
            background: rgba(248, 250, 255, 0.9);
            border-color: rgba(23, 28, 107, 0.1);
            transform: translateY(-2px);
        }

        .api-doc-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .api-doc-title {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 6px;
        }

        .api-doc-description {
            font-size: 14px;
            color: #64748b;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        .empty-state-title {
            font-size: 18px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 8px;
        }

        .empty-state-description {
            font-size: 14px;
            color: #64748b;
        }

        /* Mobile Responsive Settings */
        @media (max-width: 768px) {
            .settings-nav {
                padding: 8px;
                gap: 8px;
            }

            .settings-nav-item {
                padding: 10px 16px;
                font-size: 14px;
            }

            .settings-card {
                margin: 0 -16px 24px;
                border-radius: 0;
            }

            .settings-card-header {
                padding: 20px;
            }

            .settings-card-body {
                padding: 20px;
            }

            .profile-photo-section {
                flex-direction: column;
                text-align: center;
            }

            .settings-form-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .settings-form-actions {
                flex-direction: column;
            }

            .settings-form-actions button {
                width: 100%;
            }

            .balance-display {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }

            .balance-display .btn-primary {
                width: 100%;
            }

            .balance-info {
                grid-template-columns: 1fr;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .feature-box {
                flex-direction: column;
                text-align: center;
            }

            .notification-item,
            .session-item,
            .payment-method-item,
            .api-key-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .api-docs-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .settings-card-title {
                font-size: 18px;
            }

            .balance-value {
                font-size: 32px;
            }

            .profile-photo {
                width: 80px;
                height: 80px;
                font-size: 28px;
            }
        }

        /* ==========================================================================
   ANALYTICS SECTION STYLES
   ========================================================================== */

        .analytics-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .analytics-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 28px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
            display: flex;
            gap: 20px;
            align-items: center;
            transition: all 0.3s ease;
        }

        .analytics-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(23, 28, 107, 0.12);
        }

        .analytics-card-icon {
            width: 64px;
            height: 64px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 24px rgba(23, 28, 107, 0.15);
        }

        .analytics-card-content {
            flex: 1;
        }

        .analytics-card-label {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .analytics-card-value {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
            margin-bottom: 4px;
        }

        .analytics-card-change {
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .analytics-card-change.positive {
            color: #059669;
        }

        .analytics-card-change.positive::before {
            content: '↗';
            font-size: 16px;
        }

        .analytics-card-change.negative {
            color: #dc2626;
        }

        .analytics-card-change.negative::before {
            content: '↘';
            font-size: 16px;
        }

        /* Charts Grid */
        .analytics-charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .analytics-chart-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 28px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .chart-title {
            font-size: 20px;
            font-weight: 700;
            color: #171C6B;
        }

        .chart-controls {
            display: flex;
            gap: 12px;
        }

        .chart-select {
            padding: 8px 16px;
            border: 2px solid rgba(23, 28, 107, 0.1);
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
            color: #171C6B;
            background: rgba(248, 250, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chart-select:focus {
            outline: none;
            border-color: #2d4ef5;
            background: white;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        /* Analytics Table */
        .analytics-table-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 28px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
            margin-bottom: 32px;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .analytics-table-container {
            overflow-x: auto;
        }

        .analytics-table {
            width: 100%;
            border-collapse: collapse;
        }

        .analytics-table thead th {
            text-align: left;
            padding: 16px;
            font-size: 14px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid rgba(23, 28, 107, 0.1);
            background: rgba(248, 250, 255, 0.5);
        }

        .analytics-table tbody tr {
            transition: all 0.3s ease;
        }

        .analytics-table tbody tr:hover {
            background: rgba(248, 250, 255, 0.8);
        }

        .analytics-table tbody td {
            padding: 16px;
            font-size: 15px;
            color: #1a1a1a;
            border-bottom: 1px solid rgba(23, 28, 107, 0.06);
        }

        .analytics-table tbody tr:last-child td {
            border-bottom: none;
        }

        .table-campaign-name {
            font-weight: 600;
            color: #171C6B;
        }

        .table-metric {
            font-weight: 600;
            color: #171C6B;
        }

        .table-metric-secondary {
            font-size: 13px;
            color: #64748b;
        }

        /* Geographic List */
        .geo-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .geo-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: rgba(248, 250, 255, 0.5);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .geo-item:hover {
            background: rgba(248, 250, 255, 0.9);
            transform: translateX(4px);
        }

        .geo-flag {
            font-size: 32px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(23, 28, 107, 0.08);
        }

        .geo-details {
            flex: 1;
        }

        .geo-country {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .geo-stats {
            font-size: 14px;
            color: #64748b;
        }

        .geo-bar {
            width: 100px;
            height: 8px;
            background: rgba(23, 28, 107, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .geo-bar-fill {
            height: 100%;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Mobile Responsive Analytics */
        @media (max-width: 768px) {
            .analytics-overview {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .analytics-card {
                padding: 20px;
            }

            .analytics-card-icon {
                width: 56px;
                height: 56px;
            }

            .analytics-card-value {
                font-size: 28px;
            }

            .analytics-charts-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .analytics-chart-card {
                padding: 20px;
            }

            .chart-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .chart-container {
                height: 250px;
            }

            .analytics-table-card {
                padding: 20px;
                margin: 0 -16px;
                border-radius: 0;
            }

            .analytics-table {
                font-size: 13px;
            }

            .analytics-table thead th,
            .analytics-table tbody td {
                padding: 12px 8px;
            }

            .geo-item {
                padding: 12px;
            }

            .geo-flag {
                font-size: 24px;
                width: 40px;
                height: 40px;
            }

            .table-header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }

            .table-header .btn-secondary {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .analytics-card-value {
                font-size: 24px;
            }

            .chart-container {
                height: 200px;
            }
        }

        .mobile-menu-toggle:hover {
            background: rgba(23, 28, 107, 0.1);
        }

        .mobile-nav-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .mobile-nav-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .mobile-nav-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 280px;
            height: 100vh;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            z-index: 2001;
            padding: 80px 24px 24px;
            transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
        }

        .mobile-nav-menu.active {
            right: 0;
        }

        .mobile-nav-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            color: #171C6B;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .mobile-nav-close:hover {
            background: rgba(23, 28, 107, 0.1);
        }

        .mobile-nav-item {
            display: block;
            padding: 16px 0;
            font-size: 18px;
            font-weight: 600;
            color: #171C6B;
            text-decoration: none;
            border-bottom: 1px solid rgba(23, 28, 107, 0.1);
            transition: all 0.3s ease;
        }

        .mobile-nav-item:hover {
            color: #2d4ef5;
            padding-left: 8px;
        }

        .mobile-nav-item.active {
            color: #2d4ef5;
            background: linear-gradient(90deg, rgba(45, 78, 245, 0.1) 0%, transparent 100%);
            margin: 0 -24px;
            padding: 16px 32px 16px 24px;
            border-radius: 12px;
        }

        /* Enhanced Mobile Header */
        @media (max-width: 1024px) {
            .nav-tabs {
                display: none;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .header-content {
                padding: 0 20px;
            }

            .user-section {
                gap: 16px;
            }

            .balance,
            .earnings {
                padding: 8px 12px;
                font-size: 13px;
            }

            .user-dropdown {
                padding: 6px 12px;
            }

            .user-name {
                display: none;
            }
        }

        /* Mobile Typography Scaling */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 28px !important;
                line-height: 1.2;
            }

            .section-title {
                font-size: 24px !important;
                margin-bottom: 16px;
            }

            .section-subtitle {
                font-size: 16px !important;
                line-height: 1.5;
            }

            .step-title {
                font-size: 18px !important;
                line-height: 1.3;
            }

            .content-title {
                font-size: 18px !important;
            }

            .welcome-description {
                font-size: 16px !important;
                line-height: 1.5;
            }
        }

        /* Mobile Layout Optimizations */
        @media (max-width: 768px) {
            .main-content {
                padding: 20px 16px !important;
            }

            .hero-section {
                grid-template-columns: 1fr !important;
                gap: 20px !important;
                margin-bottom: 32px !important;
            }

            .welcome-card {
                padding: 32px 24px !important;
                border-radius: 20px !important;
            }

            .stats-panel {
                padding: 24px 20px !important;
                border-radius: 20px !important;
            }

            .section-header {
                margin-bottom: 32px !important;
                padding: 0 8px;
            }

            .steps-grid {
                grid-template-columns: 1fr !important;
                gap: 16px !important;
            }

            .step-card {
                padding: 24px 20px !important;
                border-radius: 20px !important;
            }

            .content-grid {
                grid-template-columns: 1fr !important;
                gap: 20px !important;
            }

            .content-card {
                padding: 24px 20px !important;
                border-radius: 20px !important;
            }
        }

        /* Mobile Interactive Elements */
        @media (max-width: 768px) {
            .primary-btn {
                width: 100%;
                padding: 14px 24px !important;
                font-size: 15px !important;
            }

            .step-btn {
                padding: 12px 20px !important;
                font-size: 14px !important;
            }

            .stat-item {
                padding: 16px 0 !important;
            }

            .stat-value {
                font-size: 18px !important;
            }

            .faq-item,
            .news-item {
                padding: 16px 0 !important;
            }

            .faq-item:hover,
            .stat-item:hover {
                margin: 0 -12px !important;
                padding: 16px 12px !important;
            }
        }

        /* Small Mobile (320px - 480px) */
        @media (max-width: 480px) {
            .header-content {
                padding: 0 16px !important;
                height: 60px !important;
            }

            .logo {
                width: 32px !important;
                height: 32px !important;
                font-size: 16px !important;
            }

            .brand-name {
                font-size: 18px !important;
            }

            .balance,
            .earnings {
                font-size: 12px !important;
                padding: 6px 10px !important;
            }

            .user-avatar {
                width: 32px !important;
                height: 32px !important;
                font-size: 14px !important;
            }

            .main-content {
                padding: 16px 12px !important;
            }

            .welcome-card {
                padding: 24px 16px !important;
            }

            .stats-panel {
                padding: 20px 16px !important;
            }

            .step-card,
            .content-card {
                padding: 20px 16px !important;
            }

            .welcome-title {
                font-size: 24px !important;
            }

            .section-title {
                font-size: 20px !important;
            }

            .step-number {
                width: 28px !important;
                height: 28px !important;
                font-size: 12px !important;
            }
        }

        /* Touch Optimizations */
        @media (hover: none) and (pointer: coarse) {

            .step-card:hover,
            .faq-item:hover,
            .stat-item:hover,
            .news-item:hover {
                transform: none !important;
                background: none !important;
                margin: 0 !important;
                padding: 16px 0 !important;
            }

            .step-card:hover::before {
                opacity: 0 !important;
            }

            .primary-btn:hover,
            .step-btn:hover {
                transform: none !important;
                box-shadow: 0 8px 24px rgba(23, 28, 107, 0.25) !important;
            }
        }

        /* Active/Focus States for Mobile */
        @media (max-width: 768px) {
            .step-card:active {
                transform: scale(0.98);
                transition: transform 0.1s ease;
            }

            .primary-btn:active,
            .step-btn:active {
                transform: scale(0.96);
                transition: transform 0.1s ease;
            }

            .faq-item:active {
                background: rgba(23, 28, 107, 0.05);
                border-radius: 8px;
                margin: 0 -12px;
                padding: 16px 12px;
            }
        }

        /* Mobile Animation Refinements */
        @media (max-width: 768px) {
            .animate-in {
                animation-duration: 0.4s !important;
            }

            .welcome-card::before {
                width: 200px !important;
                height: 200px !important;
                transform: translate(50%, -50%) !important;
            }
        }

        /* Landscape Mobile Optimization */
        @media (max-width: 926px) and (orientation: landscape) {
            .header {
                position: relative !important;
            }

            .main-content {
                padding-top: 16px !important;
            }

            .welcome-card {
                padding: 24px 20px !important;
            }

            .hero-section {
                grid-template-columns: 1.5fr 1fr !important;
            }

            .steps-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
            }
        }

        /* High DPI/Retina Display Optimizations */
        @media (-webkit-min-device-pixel-ratio: 2),
        (min-resolution: 192dpi) {

            .logo,
            .user-avatar,
            .step-number {
                image-rendering: -webkit-optimize-contrast;
                image-rendering: crisp-edges;
            }
        }

        /* Dark Mode Support for Mobile */
        @media (prefers-color-scheme: dark) and (max-width: 768px) {
            .mobile-nav-menu {
                background: rgba(26, 26, 26, 0.98);
                border-left: 1px solid rgba(255, 255, 255, 0.1);
            }

            .mobile-nav-item {
                color: #e2e8f0;
                border-bottom-color: rgba(255, 255, 255, 0.1);
            }

            .mobile-nav-close,
            .mobile-menu-toggle {
                color: #e2e8f0;
            }
        }

        body {
            background: linear-gradient(135deg, #f8faff 0%, #ffffff 100%);
            min-height: 100vh;
            font-weight: 400;
            line-height: 1.6;
            color: #1a1a1a;
        }

        /* Premium Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(23, 28, 107, 0.08);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 32px;
            height: 72px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 18px;
            box-shadow: 0 4px 16px rgba(23, 28, 107, 0.2);
        }

        .brand-name {
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-tabs {
            display: flex;
            gap: 4px;
            background: rgba(23, 28, 107, 0.04);
            padding: 6px;
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .nav-tab {
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            color: #64748b;
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: none;
            background: transparent;
            position: relative;
            overflow: hidden;
        }

        .nav-tab:hover {
            color: #171C6B;
            background: rgba(255, 255, 255, 0.8);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            color: white;
            box-shadow: 0 4px 16px rgba(23, 28, 107, 0.3);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .balance {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            border-radius: 12px;
            font-weight: 600;
            color: #059669;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .user-dropdown {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            border: 1px solid rgba(23, 28, 107, 0.08);
            position: relative;
        }

        .user-dropdown:hover {
            background: #f8faff;
            border-color: rgba(23, 28, 107, 0.15);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
        }

        .user-name {
            font-weight: 600;
            color: #171C6B;
        }

        .user-dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 1px solid rgba(23, 28, 107, 0.1);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.1);
            padding: 8px 0;
            min-width: 200px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }

        .user-dropdown-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            color: #64748b;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 14px;
        }

        .dropdown-item:hover {
            background: #f8faff;
            color: #171C6B;
        }

        .dropdown-item.logout {
            border-top: 1px solid rgba(23, 28, 107, 0.1);
            color: #dc2626;
        }

        .dropdown-item.logout:hover {
            background: #fef2f2;
        }

        /* Main Content */
        .main-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 48px 32px;
        }

        /* Hero Section */
        .hero-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 32px;
            margin-bottom: 48px;
        }

        .welcome-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 250, 255, 0.9) 100%);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 48px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 20px 60px rgba(23, 28, 107, 0.08);
        }

        .welcome-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(45, 78, 245, 0.08) 0%, transparent 70%);
            transform: translate(30%, -30%);
            pointer-events: none;
        }

        .welcome-header {
            position: relative;
            z-index: 1;
        }

        .greeting {
            font-size: 16px;
            color: #64748b;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .welcome-title {
            font-size: 42px;
            font-weight: 800;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
            margin-bottom: 16px;
        }

        .user-role {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, rgba(23, 28, 107, 0.1) 0%, rgba(45, 78, 245, 0.05) 100%);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            color: #171C6B;
            border: 1px solid rgba(23, 28, 107, 0.1);
            margin-bottom: 24px;
        }

        .welcome-description {
            font-size: 18px;
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 32px;
            max-width: 500px;
        }

        .primary-btn {
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            color: white;
            padding: 16px 32px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 24px rgba(23, 28, 107, 0.25);
            position: relative;
            overflow: hidden;
        }

        .primary-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(23, 28, 107, 0.35);
        }

        .primary-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .primary-btn:hover::before {
            left: 100%;
        }

        /* Stats Panel */
        .stats-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 32px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 20px 60px rgba(23, 28, 107, 0.08);
        }

        .stats-title {
            font-size: 20px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 24px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(23, 28, 107, 0.06);
            transition: all 0.3s ease;
        }

        .stat-item:hover {
            background: linear-gradient(135deg, rgba(23, 28, 107, 0.02) 0%, transparent 100%);
            margin: 0 -16px;
            padding: 20px 16px;
            border-radius: 12px;
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-label {
            font-size: 15px;
            color: #64748b;
            font-weight: 500;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Steps Section */
        .steps-section {
            margin-bottom: 48px;
        }

        .section-header {
            text-align: center;
            margin-bottom: 48px;
        }

        .section-title {
            font-size: 36px;
            font-weight: 800;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 12px;
        }

        .section-subtitle {
            font-size: 18px;
            color: #64748b;
            max-width: 600px;
            margin: 0 auto;
        }

        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 24px;
        }

        .step-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px 32px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
        }

        .step-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(23, 28, 107, 0.15);
            border-color: rgba(23, 28, 107, 0.15);
        }

        .step-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .step-card:hover::before {
            opacity: 1;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            color: white;
            border-radius: 50%;
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 24px;
        }

        .step-title {
            font-size: 22px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 12px;
            line-height: 1.3;
        }

        .step-description {
            font-size: 16px;
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 24px;
        }

        .step-btn {
            background: transparent;
            color: #171C6B;
            padding: 12px 24px;
            border: 2px solid #171C6B;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .step-btn:hover {
            background: #171C6B;
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 8px 24px rgba(23, 28, 107, 0.25);
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }

        .content-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 32px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.06);
        }

        .content-title {
            font-size: 22px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 24px;
        }

        .faq-item {
            padding: 20px 0;
            border-bottom: 1px solid rgba(23, 28, 107, 0.06);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .faq-item:hover {
            background: linear-gradient(135deg, rgba(23, 28, 107, 0.02) 0%, transparent 100%);
            margin: 0 -20px;
            padding: 20px;
            border-radius: 12px;
        }

        .faq-item:last-child {
            border-bottom: none;
        }

        .faq-question {
            font-size: 16px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 6px;
        }

        .faq-category {
            font-size: 14px;
            color: #64748b;
        }

        .news-item {
            padding: 24px 0;
            border-bottom: 1px solid rgba(23, 28, 107, 0.06);
        }

        .news-item:last-child {
            border-bottom: none;
        }

        .news-title {
            font-size: 18px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .news-excerpt {
            font-size: 15px;
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .news-meta {
            font-size: 13px;
            color: #94a3b8;
            font-weight: 500;
        }

        /* Campaign Creation Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(4px);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .campaign-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: white;
            border-radius: 24px;
            box-shadow: 0 32px 80px rgba(23, 28, 107, 0.3);
            z-index: 2001;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-overlay.active .campaign-modal {
            transform: translate(-50%, -50%) scale(1);
        }

        .modal-header {
            padding: 32px 32px 0;
            text-align: center;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: none;
            border: none;
            font-size: 24px;
            color: #64748b;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(23, 28, 107, 0.1);
            color: #171C6B;
        }

        .modal-title {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .modal-subtitle {
            font-size: 16px;
            color: #64748b;
            margin-bottom: 32px;
        }

        .modal-content {
            padding: 0 32px 32px;
        }

        .form-section {
            margin-bottom: 32px;
        }

        .section-title-modal {
            font-size: 18px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid rgba(23, 28, 107, 0.1);
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            color: #1a1a1a;
            background: rgba(248, 250, 255, 0.5);
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #2d4ef5;
            background: white;
            box-shadow: 0 0 0 4px rgba(45, 78, 245, 0.1);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236B7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
            background-position: right 16px center;
            background-repeat: no-repeat;
            background-size: 20px;
        }

        /* Traffic Selector */
        .traffic-packages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .traffic-package {
            padding: 24px 20px;
            border: 2px solid rgba(23, 28, 107, 0.1);
            border-radius: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(248, 250, 255, 0.5);
            position: relative;
            overflow: hidden;
        }

        .traffic-package:hover {
            border-color: rgba(45, 78, 245, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.1);
        }

        .traffic-package.selected {
            border-color: #2d4ef5;
            background: linear-gradient(135deg, rgba(45, 78, 245, 0.1) 0%, rgba(45, 78, 245, 0.05) 100%);
        }

        .traffic-package.popular::before {
            content: 'Most Popular';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            background: linear-gradient(135deg, #2d4ef5 0%, #171C6B 100%);
            color: white;
            font-size: 12px;
            font-weight: 600;
            padding: 6px;
            text-align: center;
            border-radius: 14px 14px 0 0;
        }

        .traffic-package.popular {
            border-color: #2d4ef5;
            margin-top: 20px;
        }

        .package-amount {
            font-size: 24px;
            font-weight: 800;
            color: #171C6B;
            margin-bottom: 8px;
        }

        .package-price {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .package-cpm {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 16px;
        }

        .package-features {
            text-align: left;
            font-size: 14px;
            color: #64748b;
        }

        .package-feature {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }

        .feature-check {
            color: #059669;
            font-weight: bold;
        }

        /* Custom Traffic Input */
        .custom-traffic {
            display: none;
            margin-top: 24px;
            padding: 24px;
            border: 2px dashed rgba(23, 28, 107, 0.2);
            border-radius: 16px;
            background: rgba(248, 250, 255, 0.3);
        }

        .custom-traffic.active {
            display: block;
        }

        .traffic-calculator {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 16px;
            align-items: end;
            margin-bottom: 16px;
        }

        .calc-result {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            padding: 16px 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .calc-label {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 4px;
        }

        .calc-value {
            font-size: 24px;
            font-weight: 800;
            color: #059669;
        }

        /* Campaign Summary */
        .campaign-summary {
            background: linear-gradient(135deg, rgba(23, 28, 107, 0.05) 0%, rgba(45, 78, 245, 0.03) 100%);
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 32px;
            border: 1px solid rgba(23, 28, 107, 0.1);
        }

        .summary-title {
            font-size: 18px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 16px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(23, 28, 107, 0.06);
        }

        .summary-row:last-child {
            border-bottom: none;
            font-weight: 700;
            font-size: 18px;
            color: #171C6B;
            margin-top: 8px;
        }

        .summary-label {
            color: #64748b;
            font-weight: 500;
        }

        .summary-value {
            color: #171C6B;
            font-weight: 600;
        }

        /* Form Actions */
        .form-actions {
            display: flex;
            gap: 16px;
            justify-content: flex-end;
            margin-top: 32px;
        }

        .btn-secondary {
            background: transparent;
            color: #64748b;
            padding: 16px 24px;
            border: 2px solid rgba(23, 28, 107, 0.1);
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(23, 28, 107, 0.05);
            color: #171C6B;
        }

        .btn-primary {
            background: linear-gradient(135deg, #171C6B 0%, #2d4ef5 100%);
            color: white;
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 24px rgba(23, 28, 107, 0.25);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(23, 28, 107, 0.35);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Loading states */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Campaign Status Badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .status-active {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .status-paused {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .status-completed {
            background: rgba(99, 102, 241, 0.1);
            color: #6366f1;
            border: 1px solid rgba(99, 102, 241, 0.3);
        }

        /* Campaign Cards in My Campaigns */
        .campaign-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid rgba(23, 28, 107, 0.08);
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }

        .campaign-card:hover {
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.1);
            transform: translateY(-2px);
        }

        .campaign-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 16px;
        }

        .campaign-name {
            font-size: 18px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .campaign-url {
            font-size: 14px;
            color: #64748b;
            text-decoration: none;
        }

        .campaign-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }

        .stat-box {
            text-align: center;
            padding: 12px;
            background: rgba(248, 250, 255, 0.8);
            border-radius: 8px;
        }

        .stat-box-value {
            font-size: 18px;
            font-weight: 700;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .stat-box-label {
            font-size: 12px;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .campaign-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        .action-btn {
            padding: 8px 16px;
            border: 1px solid rgba(23, 28, 107, 0.2);
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            color: #171C6B;
        }

        .action-btn:hover {
            background: #171C6B;
            color: white;
        }

        .action-btn.danger {
            border-color: rgba(239, 68, 68, 0.3);
            color: #dc2626;
        }

        .action-btn.danger:hover {
            background: #dc2626;
            color: white;
        }

        /* Auth check message */
        .auth-check {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 70vh;
            flex-direction: column;
            gap: 24px;
        }

        .auth-check-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(23, 28, 107, 0.1);
            border-radius: 50%;
            border-top-color: #171C6B;
            animation: spin 1s ease-in-out infinite;
        }

        .auth-check-message {
            font-size: 18px;
            color: #64748b;
            text-align: center;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .hero-section {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .nav-tabs {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 24px 16px;
            }

            .header-content {
                padding: 0 16px;
            }

            .welcome-title {
                font-size: 32px;
            }

            .section-title {
                font-size: 28px;
            }

            .steps-grid {
                grid-template-columns: 1fr;
            }

            .content-grid {
                grid-template-columns: 1fr;
            }

            .campaign-modal {
                width: 95%;
                max-height: 95vh;
            }

            .modal-header {
                padding: 24px 20px 0;
            }

            .modal-content {
                padding: 0 20px 24px;
            }

            .traffic-packages {
                grid-template-columns: 1fr;
            }

            .traffic-calculator {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .form-actions {
                flex-direction: column;
            }

            .campaign-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .campaign-actions {
                flex-wrap: wrap;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-in {
            animation: fadeInUp 0.6s ease forwards;
        }

        /* Toast notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(23, 28, 107, 0.2);
            padding: 16px 20px;
            z-index: 3000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
            border-left: 4px solid #10b981;
            max-width: 400px;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        .toast.error {
            border-left-color: #dc2626;
        }

        .toast-title {
            font-weight: 600;
            color: #171C6B;
            margin-bottom: 4px;
        }

        .toast-message {
            font-size: 14px;
            color: #64748b;
        }
    </style>
</head>

<body>
    <!-- Auth Check Screen -->
    <div id="authCheck" class="auth-check">
        <div class="auth-check-spinner"></div>
        <div class="auth-check-message">
            <div>Verifying authentication...</div>
        </div>
    </div>

    <!-- Main Dashboard (Hidden initially) -->
    <div id="mainDashboard" style="display: none;">
        <!-- Premium Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo">T</div>
                    <span class="brand-name">TrafficStars</span>
                </div>

                <nav class="nav-tabs">
                    <button class="nav-tab active" data-tab="dashboard">Dashboard</button>
                    <button class="nav-tab" data-tab="my-campaigns">My Campaigns</button>
                    <button class="nav-tab" data-tab="analytics">Analytics</button>
                    <button class="nav-tab" data-tab="settings">Settings</button>
                </nav>

                <div class="user-section">
                    <div class="balance">
                        <span id="userBalance">Balance: $0.00 USD</span>
                    </div>
                    <div class="user-dropdown" onclick="toggleUserMenu()">
                        <div class="user-avatar" id="userAvatar">U</div>
                        <span class="user-name" id="userName">Loading...</span>
                        <span style="color: #64748b;">▼</span>

                        <div class="user-dropdown-menu" id="userDropdownMenu">
                            <a href="#" class="dropdown-item" onclick="goToProfileSettings(); return false;">
                                <span>👤</span>
                                <span>Profile Settings</span>
                            </a>

                            <button class="dropdown-item logout" onclick="logout()">
                                <span>🚪</span>
                                <span>Logout</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <div id="dashboard-section">
                <!-- Hero Section -->
                <section class="hero-section">
                    <div class="welcome-card animate-in">
                        <div class="welcome-header">
                            <div class="greeting" id="greeting">Good evening</div>
                            <h1 class="welcome-title">Welcome back, <span id="welcomeUserName">Advertiser</span></h1>
                            <div class="user-role">
                                <span>🎯</span>
                                <span>Advertiser Account</span>
                            </div>
                            <p class="welcome-description">
                                Ready to scale your advertising campaigns? Access powerful tools, detailed analytics,
                                and premium inventory to maximize your ROI.
                            </p>
                            <button class="primary-btn" onclick="openCampaignModal()">
                                Launch New Campaign
                            </button>
                        </div>
                    </div>

                    <div class="stats-panel animate-in">
                        <h3 class="stats-title">Performance Overview</h3>
                        <div class="stat-item">
                            <span class="stat-label">Active Campaigns</span>
                            <span class="stat-value" id="activeCampaigns">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Total Impressions</span>
                            <span class="stat-value" id="totalImpressions">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Total Clicks</span>
                            <span class="stat-value" id="totalClicks">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Total Investment</span>
                            <span class="stat-value" id="totalInvestment">$0.00</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Average CTR</span>
                            <span class="stat-value" id="avgCTR">0.00%</span>
                        </div>
                    </div>
                </section>

                <!-- Steps Section -->
                <section class="steps-section">
                    <div class="section-header">
                        <h2 class="section-title">Get Started in 3 Steps</h2>
                        <p class="section-subtitle">
                            Everything you need to launch successful advertising campaigns on our premium network
                        </p>
                    </div>

                    <div class="steps-grid">
                        <div class="step-card animate-in">
                            <div class="step-number">1</div>
                            <h3 class="step-title">Complete Your Profile</h3>
                            <p class="step-description">
                                Set up your advertiser profile with business details, payment methods, and campaign
                                preferences for seamless operations.
                            </p>
                            <button class="step-btn" onclick="fillProfile()">Complete Profile</button>
                        </div>

                        <div class="step-card animate-in">
                            <div class="step-number">2</div>
                            <h3 class="step-title">Fund Your Account</h3>
                            <p class="step-description">
                                Add funds to your advertising account using secure payment methods. Minimum deposit $100
                                to get started with campaigns.
                            </p>
                            <button class="step-btn" onclick="showAddFundsModal()">Add Funds</button>
                        </div>

                        <div class="step-card animate-in">
                            <div class="step-number">3</div>
                            <h3 class="step-title">Launch Campaign</h3>
                            <p class="step-description">
                                Create your first advertising campaign with our advanced targeting options and premium
                                inventory across multiple formats.
                            </p>
      
                            <button class="step-btn" onclick="openCampaignModal()">Create Campaign</button>
                        </div>
                    </div>
                </section>

                <!-- Content Grid -->
                <section class="content-grid">
                    <div class="content-card animate-in">
                        <h3 class="content-title">Knowledge Base</h3>

                        <div class="faq-item" onclick="expandHelp(this)">
                            <div class="faq-question">Campaign Setup & Optimization</div>
                            <div class="faq-category">Best practices and strategies</div>
                        </div>

                        <div class="faq-item" onclick="expandHelp(this)">
                            <div class="faq-question">Advanced Tracking & Analytics</div>
                            <div class="faq-category">Postback integration guides</div>
                        </div>

                        <div class="faq-item" onclick="expandHelp(this)">
                            <div class="faq-question">Targeting & Audience Insights</div>
                            <div class="faq-category">Maximize your reach</div>
                        </div>

                        <div class="faq-item" onclick="expandHelp(this)">
                            <div class="faq-question">Performance Optimization</div>
                            <div class="faq-category">Scale successful campaigns</div>
                        </div>
                    </div>

                    <div class="content-card animate-in">
                        <h3 class="content-title">Platform Updates</h3>

                        <div class="news-item">
                            <div class="news-title">Advanced AI Optimization Engine</div>
                            <p class="news-excerpt">New machine learning algorithms automatically optimize your
                                campaigns for better performance and ROI.</p>
                            <div class="news-meta">2 hours ago • Platform Features</div>
                        </div>

                        <div class="news-item">
                            <div class="news-title">Enhanced Audience Targeting</div>
                            <p class="news-excerpt">Improved demographic and behavioral targeting options with real-time
                                audience insights.</p>
                            <div class="news-meta">1 day ago • Targeting Updates</div>
                        </div>

                        <div class="news-item">
                            <div class="news-title">New Analytics Dashboard</div>
                            <p class="news-excerpt">Comprehensive reporting suite with advanced metrics and customizable
                                dashboard views.</p>
                            <div class="news-meta">3 days ago • Dashboard</div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- My Campaigns Section -->
            <div id="my-campaigns-section" style="display: none;">
                <div class="section-header">
                    <h2 class="section-title">My Campaigns</h2>
                    <p class="section-subtitle">Manage and monitor all your advertising campaigns</p>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
                    <div>
                        <button class="btn-secondary" onclick="refreshCampaigns()">
                            🔄 Refresh
                        </button>
                    </div>
                    <button class="primary-btn" onclick="openCampaignModal()">
                        ➕ Create New Campaign
                    </button>
                </div>

                <div id="campaignsContainer">
                    <div id="campaignsLoading" style="text-align: center; padding: 40px; color: #64748b;">
                        <div class="spinner" style="margin: 0 auto 16px;"></div>
                        Loading campaigns...
                    </div>
                    <div id="noCampaigns" style="display: none; text-align: center; padding: 40px; color: #64748b;">
                        <h3 style="margin-bottom: 16px;">No campaigns yet</h3>
                        <p>Create your first campaign to get started with advertising.</p>
                        <button class="primary-btn" onclick="openCampaignModal()" style="margin-top: 24px;">
                            Create First Campaign
                        </button>
                    </div>
                    <div id="campaignsList"></div>
                </div>
            </div>
            <!-- Analytics Section -->
            <div id="analytics-section" style="display: none;">
                <div class="section-header">
                    <h2 class="section-title">Campaign Analytics</h2>
                    <p class="section-subtitle">Comprehensive performance insights and metrics for your campaigns</p>
                </div>

                <!-- Analytics Overview Cards -->
                <div class="analytics-overview">
                    <div class="analytics-card animate-in">
                        <div class="analytics-card-icon"
                            style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                            <span style="font-size: 24px;">💰</span>
                        </div>
                        <div class="analytics-card-content">
                            <div class="analytics-card-label">Total Revenue</div>
                            <div class="analytics-card-value" id="analyticsRevenue">$0.00</div>
                            <div class="analytics-card-change positive" id="revenueChange">+0%</div>
                        </div>
                    </div>

                    <div class="analytics-card animate-in">
                        <div class="analytics-card-icon"
                            style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);">
                            <span style="font-size: 24px;">👁️</span>
                        </div>
                        <div class="analytics-card-content">
                            <div class="analytics-card-label">Total Impressions</div>
                            <div class="analytics-card-value" id="analyticsImpressions">0</div>
                            <div class="analytics-card-change positive" id="impressionsChange">+0%</div>
                        </div>
                    </div>

                    <div class="analytics-card animate-in">
                        <div class="analytics-card-icon"
                            style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                            <span style="font-size: 24px;">🖱️</span>
                        </div>
                        <div class="analytics-card-content">
                            <div class="analytics-card-label">Total Clicks</div>
                            <div class="analytics-card-value" id="analyticsClicks">0</div>
                            <div class="analytics-card-change positive" id="clicksChange">+0%</div>
                        </div>
                    </div>

                    <div class="analytics-card animate-in">
                        <div class="analytics-card-icon"
                            style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);">
                            <span style="font-size: 24px;">📊</span>
                        </div>
                        <div class="analytics-card-content">
                            <div class="analytics-card-label">Average CTR</div>
                            <div class="analytics-card-value" id="analyticsAvgCTR">0.00%</div>
                            <div class="analytics-card-change positive" id="ctrChange">+0%</div>
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="analytics-charts-grid">
                    <!-- Performance Trend -->
                    <div class="analytics-chart-card animate-in">
                        <div class="chart-header">
                            <h3 class="chart-title">Performance Trend</h3>
                            <div class="chart-controls">
                                <select class="chart-select" id="performancePeriod" onchange="updatePerformanceChart()">
                                    <option value="7">Last 7 Days</option>
                                    <option value="14">Last 14 Days</option>
                                    <option value="30" selected>Last 30 Days</option>
                                </select>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>

                    <!-- Device Distribution -->
                    <div class="analytics-chart-card animate-in">
                        <div class="chart-header">
                            <h3 class="chart-title">Traffic by Device</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="deviceChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Campaign Performance Table -->
                <div class="analytics-table-card animate-in">
                    <div class="table-header">
                        <h3 class="chart-title">Campaign Performance Comparison</h3>
                        <button class="btn-secondary" onclick="exportAnalytics()">
                            📥 Export Data
                        </button>
                    </div>
                    <div class="analytics-table-container">
                        <table class="analytics-table" id="campaignAnalyticsTable">
                            <thead>
                                <tr>
                                    <th>Campaign</th>
                                    <th>Status</th>
                                    <th>Impressions</th>
                                    <th>Clicks</th>
                                    <th>CTR</th>
                                    <th>Spent</th>
                                    <th>CPM</th>
                                    <th>CPC</th>
                                </tr>
                            </thead>
                            <tbody id="analyticsTableBody">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Geographic & Time Analytics -->
                <div class="analytics-charts-grid">
                    <!-- Geographic Distribution -->
                    <div class="analytics-chart-card animate-in">
                        <div class="chart-header">
                            <h3 class="chart-title">Top Performing Countries</h3>
                        </div>
                        <div class="geo-list" id="geoList">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Time Distribution -->
                    <div class="analytics-chart-card animate-in">
                        <div class="chart-header">
                            <h3 class="chart-title">Traffic by Hour</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="timeChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Settings Section -->
            <div id="settings-section" style="display: none;">
                <div class="section-header">
                    <h2 class="section-title">Account Settings</h2>
                    <p class="section-subtitle">Manage your account preferences and configuration</p>
                </div>

                <!-- Settings Navigation Tabs -->
                <div class="settings-nav">
                    <button class="settings-nav-item active" data-settings-tab="profile"
                        onclick="switchSettingsTab('profile')">
                        <span class="settings-nav-icon">👤</span>
                        <span>Profile</span>
                    </button>
                    <button class="settings-nav-item" data-settings-tab="security"
                        onclick="switchSettingsTab('security')">
                        <span class="settings-nav-icon">🔒</span>
                        <span>Security</span>
                    </button>
                    <button class="settings-nav-item" data-settings-tab="notifications"
                        onclick="switchSettingsTab('notifications')">
                        <span class="settings-nav-icon">🔔</span>
                        <span>Notifications</span>
                    </button>
                    <button class="settings-nav-item" data-settings-tab="billing"
                        onclick="switchSettingsTab('billing')">
                        <span class="settings-nav-icon">💳</span>
                        <span>Billing</span>
                    </button>
                    <button class="settings-nav-item" data-settings-tab="api" onclick="switchSettingsTab('api')">
                        <span class="settings-nav-icon">🔌</span>
                        <span>API</span>
                    </button>
                </div>

                <!-- Settings Content Container -->
                <div class="settings-content">

                    <!-- Profile Settings -->
                    <div id="profile-settings" class="settings-panel active">
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Personal Information</h3>
                                <p class="settings-card-subtitle">Update your personal details and profile information
                                </p>
                            </div>
                            <div class="settings-card-body">
                                <form id="profileForm" onsubmit="updateProfile(event)">
                                    <!-- Profile Photo -->
                                    <div class="profile-photo-section">
                                        <div class="profile-photo-wrapper">
                                            <div class="profile-photo" id="profilePhoto">
                                                <span id="profilePhotoText">U</span>
                                            </div>
                                            <button type="button" class="profile-photo-edit"
                                                onclick="changeProfilePhoto()">
                                                📷
                                            </button>
                                        </div>
                                        <div class="profile-photo-info">
                                            <h4
                                                style="font-size: 16px; font-weight: 600; color: #171C6B; margin-bottom: 4px;">
                                                Profile Picture</h4>
                                            <p style="font-size: 14px; color: #64748b; margin-bottom: 12px;">PNG, JPG up
                                                to 5MB</p>
                                            <button type="button" class="btn-secondary-small"
                                                onclick="changeProfilePhoto()">
                                                Change Photo
                                            </button>
                                        </div>
                                    </div>

                                    <div class="settings-form-grid">
                                        <div class="form-group">
                                            <label class="form-label">Full Name *</label>
                                            <input type="text" class="form-input" id="profileName"
                                                placeholder="John Doe" required>
                                        </div>

                                        <div class="form-group">
                                            <label class="form-label">Email Address *</label>
                                            <input type="email" class="form-input" id="profileEmail"
                                                placeholder="john@example.com" disabled>
                                            <span class="form-hint">Email cannot be changed</span>
                                        </div>

                                        <div class="form-group">
                                            <label class="form-label">Company Name</label>
                                            <input type="text" class="form-input" id="profileCompany"
                                                placeholder="Your Company">
                                        </div>

                                        <div class="form-group">
                                            <label class="form-label">Phone Number</label>
                                            <input type="tel" class="form-input" id="profilePhone"
                                                placeholder="+1 (555) 123-4567">
                                        </div>

                                        <div class="form-group">
                                            <label class="form-label">Country</label>
                                            <select class="form-input form-select" id="profileCountry">
                                                <option value="">Select Country</option>
                                                <option value="US">United States</option>
                                                <option value="UK">United Kingdom</option>
                                                <option value="CA">Canada</option>
                                                <option value="AU">Australia</option>
                                                <option value="DE">Germany</option>
                                                <option value="FR">France</option>
                                                <option value="IN">India</option>
                                                <option value="PK">Pakistan</option>
                                            </select>
                                        </div>

                                        <div class="form-group">
                                            <label class="form-label">Time Zone</label>
                                            <select class="form-input form-select" id="profileTimezone">
                                                <option value="UTC">UTC (GMT+0:00)</option>
                                                <option value="EST">EST (GMT-5:00)</option>
                                                <option value="PST">PST (GMT-8:00)</option>
                                                <option value="GMT">GMT (GMT+0:00)</option>
                                                <option value="CET">CET (GMT+1:00)</option>
                                                <option value="IST">IST (GMT+5:30)</option>
                                                <option value="PKT">PKT (GMT+5:00)</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="settings-form-actions">
                                        <button type="button" class="btn-secondary"
                                            onclick="resetProfileForm()">Cancel</button>
                                        <button type="submit" class="btn-primary">
                                            <span id="profileSaveText">Save Changes</span>
                                            <span id="profileSaveSpinner" class="spinner" style="display: none;"></span>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- Account Information -->
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Account Information</h3>
                                <p class="settings-card-subtitle">Your account details and membership status</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="info-grid">
                                    <div class="info-item">
                                        <span class="info-label">Account Type</span>
                                        <span class="info-value" id="accountType">Advertiser</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Member Since</span>
                                        <span class="info-value" id="memberSince">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Account Status</span>
                                        <span class="info-value"><span
                                                class="status-badge status-active">Active</span></span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Last Login</span>
                                        <span class="info-value" id="lastLogin">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Security Settings -->
                    <div id="security-settings" class="settings-panel">
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Change Password</h3>
                                <p class="settings-card-subtitle">Update your password to keep your account secure</p>
                            </div>
                            <div class="settings-card-body">
                                <form id="passwordForm" onsubmit="changePassword(event)">
                                    <div class="form-group">
                                        <label class="form-label">Current Password *</label>
                                        <input type="password" class="form-input" id="currentPassword"
                                            placeholder="Enter current password" required>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">New Password *</label>
                                        <input type="password" class="form-input" id="newPassword"
                                            placeholder="Enter new password" required minlength="6">
                                        <span class="form-hint">Minimum 6 characters</span>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Confirm New Password *</label>
                                        <input type="password" class="form-input" id="confirmPassword"
                                            placeholder="Confirm new password" required>
                                    </div>

                                    <div class="password-strength">
                                        <div class="password-strength-label">Password Strength:</div>
                                        <div class="password-strength-bar">
                                            <div class="password-strength-fill" id="passwordStrengthFill"></div>
                                        </div>
                                        <div class="password-strength-text" id="passwordStrengthText">Enter a password
                                        </div>
                                    </div>

                                    <div class="settings-form-actions">
                                        <button type="button" class="btn-secondary"
                                            onclick="resetPasswordForm()">Cancel</button>
                                        <button type="submit" class="btn-primary">
                                            <span id="passwordSaveText">Update Password</span>
                                            <span id="passwordSaveSpinner" class="spinner"
                                                style="display: none;"></span>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- Two-Factor Authentication -->
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Two-Factor Authentication</h3>
                                <p class="settings-card-subtitle">Add an extra layer of security to your account</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="feature-box">
                                    <div class="feature-icon">🔐</div>
                                    <div class="feature-content">
                                        <h4 class="feature-title">Enable 2FA</h4>
                                        <p class="feature-description">Protect your account with two-factor
                                            authentication using an authenticator app</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="toggle2FA" onchange="toggle2FA(this)">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Active Sessions -->
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Active Sessions</h3>
                                <p class="settings-card-subtitle">Manage your active sessions and devices</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="sessions-list" id="sessionsList">
                                    <!-- Populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notification Settings -->
                    <div id="notifications-settings" class="settings-panel">
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Email Notifications</h3>
                                <p class="settings-card-subtitle">Choose what updates you want to receive via email</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="notification-items">
                                    <div class="notification-item">
                                        <div class="notification-info">
                                            <h4 class="notification-title">Campaign Updates</h4>
                                            <p class="notification-description">Get notified when your campaigns start,
                                                pause, or complete</p>
                                        </div>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="notifCampaigns" checked
                                                onchange="saveNotificationSettings()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>

                                    <div class="notification-item">
                                        <div class="notification-info">
                                            <h4 class="notification-title">Performance Alerts</h4>
                                            <p class="notification-description">Receive alerts about significant changes
                                                in campaign performance</p>
                                        </div>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="notifPerformance" checked
                                                onchange="saveNotificationSettings()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>

                                    <div class="notification-item">
                                        <div class="notification-info">
                                            <h4 class="notification-title">Budget Alerts</h4>
                                            <p class="notification-description">Get notified when your campaign budget
                                                reaches certain thresholds</p>
                                        </div>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="notifBudget" checked
                                                onchange="saveNotificationSettings()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>

                                    <div class="notification-item">
                                        <div class="notification-info">
                                            <h4 class="notification-title">Weekly Reports</h4>
                                            <p class="notification-description">Receive weekly summary reports of all
                                                your campaigns</p>
                                        </div>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="notifWeekly"
                                                onchange="saveNotificationSettings()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>

                                    <div class="notification-item">
                                        <div class="notification-info">
                                            <h4 class="notification-title">Marketing & Updates</h4>
                                            <p class="notification-description">Receive news about new features, tips,
                                                and platform updates</p>
                                        </div>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="notifMarketing"
                                                onchange="saveNotificationSettings()">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Push Notifications -->
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Push Notifications</h3>
                                <p class="settings-card-subtitle">Manage browser push notifications</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="feature-box">
                                    <div class="feature-icon">🔔</div>
                                    <div class="feature-content">
                                        <h4 class="feature-title">Browser Notifications</h4>
                                        <p class="feature-description">Get instant notifications in your browser for
                                            important updates</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="togglePush" onchange="togglePushNotifications(this)">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Billing Settings -->
                    <div id="billing-settings" class="settings-panel">
                        <!-- Balance Card -->
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Account Balance</h3>
                                <p class="settings-card-subtitle">Current balance and transaction history</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="balance-display">
                                    <div class="balance-amount">
                                        <span class="balance-label">Available Balance</span>
                                        <span class="balance-value" id="settingsBalance">$0.00</span>
                                    </div>
                                    <button class="btn-primary" onclick="showAddFundsModal()">
                                        💰 Add Funds
                                    </button>
                                </div>

                                <div class="balance-info">
                                    <div class="balance-info-item">
                                        <span class="balance-info-icon">📊</span>
                                        <div>
                                            <div class="balance-info-label">Total Spent</div>
                                            <div class="balance-info-value" id="totalSpentBilling">$0.00</div>
                                        </div>
                                    </div>
                                    <div class="balance-info-item">
                                        <span class="balance-info-icon">🎯</span>
                                        <div>
                                            <div class="balance-info-label">Active Campaigns</div>
                                            <div class="balance-info-value" id="activeCampaignsBilling">0</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Methods -->
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Payment Methods</h3>
                                <p class="settings-card-subtitle">Manage your payment methods for deposits</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="payment-methods" id="paymentMethodsList">
                                    <div class="payment-method-item">
                                        <div class="payment-method-icon">💳</div>
                                        <div class="payment-method-info">
                                            <div class="payment-method-name">Visa ending in 4242</div>
                                            <div class="payment-method-details">Expires 12/2025 • Primary</div>
                                        </div>
                                        <button class="btn-text danger"
                                            onclick="removePaymentMethod('1')">Remove</button>
                                    </div>
                                </div>
                                <button class="btn-secondary" onclick="addPaymentMethod()" style="margin-top: 16px;">
                                    ➕ Add Payment Method
                                </button>
                            </div>
                        </div>

                        <!-- Transaction History -->
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Transaction History</h3>
                                <p class="settings-card-subtitle">View your recent transactions and invoices</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="transactions-list" id="transactionsList">
                                    <div class="transaction-item">
                                        <div class="transaction-icon success">+</div>
                                        <div class="transaction-info">
                                            <div class="transaction-title">Account Deposit</div>
                                            <div class="transaction-date">Dec 28, 2024 • 3:45 PM</div>
                                        </div>
                                        <div class="transaction-amount success">+$500.00</div>
                                    </div>
                                    <div class="transaction-item">
                                        <div class="transaction-icon">-</div>
                                        <div class="transaction-info">
                                            <div class="transaction-title">Campaign: Holiday Sale 2024</div>
                                            <div class="transaction-date">Dec 27, 2024 • 11:20 AM</div>
                                        </div>
                                        <div class="transaction-amount">-$150.00</div>
                                    </div>
                                    <div class="transaction-item">
                                        <div class="transaction-icon success">+</div>
                                        <div class="transaction-info">
                                            <div class="transaction-title">Account Deposit</div>
                                            <div class="transaction-date">Dec 25, 2024 • 9:15 AM</div>
                                        </div>
                                        <div class="transaction-amount success">+$1,000.00</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- API Settings -->
                    <div id="api-settings" class="settings-panel">
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">API Keys</h3>
                                <p class="settings-card-subtitle">Manage your API keys for programmatic access</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="api-keys-list" id="apiKeysList">
                                    <div class="api-key-item">
                                        <div class="api-key-info">
                                            <div class="api-key-name">Production Key</div>
                                            <div class="api-key-value">
                                                <code id="apiKey1">••••••••••••••••••••••••••••</code>
                                                <button class="btn-icon"
                                                    onclick="toggleAPIKey('apiKey1', 'pk_live_51234567890abcdefghijklmnopqrstuvwxyz')"
                                                    title="Show/Hide">
                                                    👁️
                                                </button>
                                                <button class="btn-icon"
                                                    onclick="copyToClipboard('pk_live_51234567890abcdefghijklmnopqrstuvwxyz')"
                                                    title="Copy">
                                                    📋
                                                </button>
                                            </div>
                                            <div class="api-key-date">Created on Dec 15, 2024 • Last used 2 hours ago
                                            </div>
                                        </div>
                                        <button class="btn-text danger" onclick="revokeAPIKey('1')">Revoke</button>
                                    </div>
                                </div>
                                <button class="btn-secondary" onclick="generateNewAPIKey()" style="margin-top: 16px;">
                                    🔑 Generate New API Key
                                </button>
                            </div>
                        </div>

                        <!-- API Documentation -->
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">API Documentation</h3>
                                <p class="settings-card-subtitle">Resources to integrate with our API</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="api-docs-grid">
                                    <a href="#" class="api-doc-card" onclick="openAPIDoc('quickstart'); return false;">
                                        <div class="api-doc-icon">🚀</div>
                                        <div class="api-doc-title">Quick Start Guide</div>
                                        <div class="api-doc-description">Get started with the API in minutes</div>
                                    </a>
                                    <a href="#" class="api-doc-card" onclick="openAPIDoc('reference'); return false;">
                                        <div class="api-doc-icon">📖</div>
                                        <div class="api-doc-title">API Reference</div>
                                        <div class="api-doc-description">Complete API endpoint documentation</div>
                                    </a>
                                    <a href="#" class="api-doc-card" onclick="openAPIDoc('examples'); return false;">
                                        <div class="api-doc-icon">💡</div>
                                        <div class="api-doc-title">Code Examples</div>
                                        <div class="api-doc-description">Sample code in multiple languages</div>
                                    </a>
                                    <a href="#" class="api-doc-card" onclick="openAPIDoc('webhooks'); return false;">
                                        <div class="api-doc-icon">🔗</div>
                                        <div class="api-doc-title">Webhooks</div>
                                        <div class="api-doc-description">Real-time event notifications</div>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Webhook Configuration -->
                        <div class="settings-card animate-in">
                            <div class="settings-card-header">
                                <h3 class="settings-card-title">Webhooks</h3>
                                <p class="settings-card-subtitle">Configure webhook endpoints for real-time updates</p>
                            </div>
                            <div class="settings-card-body">
                                <div class="webhooks-list" id="webhooksList">
                                    <div class="empty-state">
                                        <div class="empty-state-icon">🔗</div>
                                        <div class="empty-state-title">No webhooks configured</div>
                                        <div class="empty-state-description">Add a webhook endpoint to receive real-time
                                            notifications</div>
                                    </div>
                                </div>
                                <button class="btn-secondary" onclick="addWebhook()" style="margin-top: 16px;">
                                    ➕ Add Webhook
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <!-- Add Funds Modal -->
            <div class="modal-overlay" id="addFundsModal">
                <div class="add-funds-modal">
                    <div class="modal-header">
                        <button class="modal-close" onclick="closeAddFundsModal()">×</button>
                        <h2 class="modal-title">Add Funds to Account</h2>
                        <p class="modal-subtitle">Choose your payment method and add funds securely</p>
                    </div>

                    <div class="modal-content">
                        <!-- Amount Selection -->
                        <div class="funds-section">
                            <h3 class="funds-section-title">
                                <span class="section-icon">💰</span>
                                Select Amount
                            </h3>

                            <div class="amount-grid">
                                <button class="amount-card" data-amount="100" onclick="selectAmount(this)">
                                    <div class="amount-value">$100</div>
                                    <div class="amount-label">Starter</div>
                                </button>
                                <button class="amount-card popular" data-amount="500" onclick="selectAmount(this)">
                                    <div class="amount-popular-badge">Most Popular</div>
                                    <div class="amount-value">$500</div>
                                    <div class="amount-label">Professional</div>
                                </button>
                                <button class="amount-card" data-amount="1000" onclick="selectAmount(this)">
                                    <div class="amount-value">$1,000</div>
                                    <div class="amount-label">Business</div>
                                </button>
                                <button class="amount-card" data-amount="custom" onclick="selectAmount(this)">
                                    <div class="amount-value">Custom</div>
                                    <div class="amount-label">Enter amount</div>
                                </button>
                            </div>

                            <!-- Custom Amount Input -->
                            <div class="custom-amount-input" id="customAmountInput" style="display: none;">
                                <label class="form-label">Enter Custom Amount (Min: $100)</label>
                                <div class="amount-input-wrapper">
                                    <span class="amount-currency">$</span>
                                    <input type="number" class="form-input amount-input" id="customAmountValue"
                                        placeholder="Enter amount" min="100" step="1" oninput="validateCustomAmount()">
                                </div>
                                <span class="form-hint" id="customAmountError"></span>
                            </div>
                        </div>

                        <!-- Payment Method Selection -->
                        <div class="funds-section">
                            <h3 class="funds-section-title">
                                <span class="section-icon">💳</span>
                                Payment Method
                            </h3>

                            <div class="payment-methods-grid">
                                <button class="payment-method-card active" data-method="stripe"
                                    onclick="selectPaymentMethod(this)">
                                    <div class="payment-method-logo">
                                        <svg viewBox="0 0 60 25" xmlns="http://www.w3.org/2000/svg" width="60"
                                            height="25">
                                            <path fill="#635bff"
                                                d="M59.64 14.28h-8.06c.19 1.93 1.6 2.55 3.2 2.55 1.64 0 2.96-.37 4.05-.95v3.32a8.33 8.33 0 0 1-4.56 1.1c-4.01 0-6.83-2.5-6.83-7.48 0-4.19 2.39-7.52 6.3-7.52 3.92 0 5.96 3.28 5.96 7.5 0 .4-.04 1.26-.06 1.48zm-5.92-5.62c-1.03 0-2.17.73-2.17 2.58h4.25c0-1.85-1.07-2.58-2.08-2.58zM40.95 20.3c-1.44 0-2.32-.6-2.9-1.04l-.02 4.63-4.12.87V5.57h3.76l.08 1.02a4.7 4.7 0 0 1 3.23-1.29c2.9 0 5.62 2.6 5.62 7.4 0 5.23-2.7 7.6-5.65 7.6zM40 8.95c-.95 0-1.54.34-1.97.81l.02 6.12c.4.44.98.78 1.95.78 1.52 0 2.54-1.65 2.54-3.87 0-2.15-1.04-3.84-2.54-3.84zM28.24 5.57h4.13v14.44h-4.13V5.57zm0-4.7L32.37 0v3.36l-4.13.88V.88zm-4.32 9.35v9.79H19.8V5.57h3.7l.12 1.22c1-1.77 3.07-1.41 3.62-1.22v3.79c-.52-.17-2.29-.43-3.32.86zm-8.55 4.72c0 2.43 2.6 1.68 3.12 1.46v3.36c-.55.3-1.54.54-2.89.54a4.15 4.15 0 0 1-4.27-4.24l.01-13.17 4.02-.86v3.54h3.14V9.1h-3.13v5.85zm-4.91.7c0 2.97-2.31 4.66-5.73 4.66a11.2 11.2 0 0 1-4.46-.93v-3.93c1.38.75 3.1 1.31 4.46 1.31.92 0 1.53-.24 1.53-1C6.26 13.77 0 14.51 0 9.95 0 7.04 2.28 5.3 5.62 5.3c1.36 0 2.72.2 4.09.75v3.88a9.23 9.23 0 0 0-4.1-1.06c-.86 0-1.44.25-1.44.93 0 1.85 6.29.97 6.29 5.88z" />
                                        </svg>
                                    </div>
                                    <div class="payment-method-name">Credit/Debit Card</div>
                                    <div class="payment-method-desc">Visa, Mastercard, Amex</div>
                                </button>

                                <button class="payment-method-card" data-method="paypal"
                                    onclick="selectPaymentMethod(this)">
                                    <div class="payment-method-logo">
                                        <svg viewBox="0 0 124 33" xmlns="http://www.w3.org/2000/svg" width="80"
                                            height="21">
                                            <path fill="#253B80"
                                                d="M46.211 6.749h-6.839a.95.95 0 0 0-.939.802l-2.766 17.537a.57.57 0 0 0 .564.658h3.265a.95.95 0 0 0 .939-.803l.746-4.73a.95.95 0 0 1 .938-.803h2.165c4.505 0 7.105-2.18 7.784-6.5.306-1.89.013-3.375-.872-4.415-.972-1.142-2.696-1.746-4.985-1.746zM47 13.154c-.374 2.454-2.249 2.454-4.062 2.454h-1.032l.724-4.583a.57.57 0 0 1 .563-.481h.473c1.235 0 2.4 0 3.002.704.359.42.469 1.044.332 1.906zM66.654 13.075h-3.275a.57.57 0 0 0-.563.481l-.145.916-.229-.332c-.709-1.029-2.29-1.373-3.868-1.373-3.619 0-6.71 2.741-7.312 6.586-.313 1.918.132 3.752 1.22 5.03.998 1.176 2.426 1.666 4.125 1.666 2.916 0 4.533-1.875 4.533-1.875l-.146.91a.57.57 0 0 0 .562.66h2.95a.95.95 0 0 0 .939-.803l1.77-11.209a.568.568 0 0 0-.561-.657zm-4.565 6.374c-.316 1.871-1.801 3.127-3.695 3.127-.951 0-1.711-.305-2.199-.883-.484-.574-.668-1.391-.514-2.301.295-1.855 1.805-3.152 3.67-3.152.93 0 1.686.309 2.184.892.499.589.697 1.411.554 2.317zM84.096 13.075h-3.291a.954.954 0 0 0-.787.417l-4.539 6.686-1.924-6.425a.953.953 0 0 0-.912-.678h-3.234a.57.57 0 0 0-.541.754l3.625 10.638-3.408 4.811a.57.57 0 0 0 .465.9h3.287a.949.949 0 0 0 .781-.408l10.946-15.8a.57.57 0 0 0-.468-.895z" />
                                            <path fill="#179BD7"
                                                d="M94.992 6.749h-6.84a.95.95 0 0 0-.938.802l-2.766 17.537a.569.569 0 0 0 .562.658h3.51a.665.665 0 0 0 .656-.562l.785-4.971a.95.95 0 0 1 .938-.803h2.164c4.506 0 7.105-2.18 7.785-6.5.307-1.89.012-3.375-.873-4.415-.971-1.142-2.694-1.746-4.983-1.746zm.789 6.405c-.373 2.454-2.248 2.454-4.062 2.454h-1.031l.725-4.583a.568.568 0 0 1 .562-.481h.473c1.234 0 2.4 0 3.002.704.359.42.468 1.044.331 1.906zM115.434 13.075h-3.273a.567.567 0 0 0-.562.481l-.145.916-.23-.332c-.709-1.029-2.289-1.373-3.867-1.373-3.619 0-6.709 2.741-7.311 6.586-.312 1.918.131 3.752 1.219 5.03 1 1.176 2.426 1.666 4.125 1.666 2.916 0 4.533-1.875 4.533-1.875l-.146.91a.57.57 0 0 0 .564.66h2.949a.95.95 0 0 0 .938-.803l1.771-11.209a.571.571 0 0 0-.565-.657zm-4.565 6.374c-.314 1.871-1.801 3.127-3.695 3.127-.949 0-1.711-.305-2.199-.883-.484-.574-.666-1.391-.514-2.301.297-1.855 1.805-3.152 3.67-3.152.93 0 1.686.309 2.184.892.501.589.699 1.411.554 2.317zM119.295 7.23l-2.807 17.858a.569.569 0 0 0 .562.658h2.822c.469 0 .867-.34.939-.803l2.768-17.536a.57.57 0 0 0-.562-.659h-3.16a.571.571 0 0 0-.562.482z" />
                                            <path fill="#253B80"
                                                d="M7.266 29.154l.523-3.322-1.165-.027H1.061L4.927 1.292a.316.316 0 0 1 .314-.268h9.38c3.114 0 5.263.648 6.385 1.927.526.6.861 1.227 1.023 1.917.17.724.173 1.589.007 2.644l-.012.077v.676l.526.298a3.69 3.69 0 0 1 1.065.812c.45.513.741 1.165.864 1.938.127.795.085 1.741-.123 2.812-.24 1.232-.628 2.305-1.152 3.183a6.547 6.547 0 0 1-1.825 2c-.696.494-1.523.869-2.458 1.109-.906.236-1.939.355-3.072.355h-.73c-.522 0-1.029.188-1.427.525a2.21 2.21 0 0 0-.744 1.328l-.055.299-.924 5.855-.042.215c-.011.068-.03.102-.058.125a.155.155 0 0 1-.096.035H7.266z" />
                                            <path fill="#179BD7"
                                                d="M23.048 7.667c-.028.179-.06.362-.096.55-1.237 6.351-5.469 8.545-10.874 8.545H9.326c-.661 0-1.218.48-1.321 1.132L6.596 26.83l-.399 2.533a.704.704 0 0 0 .695.814h4.881c.578 0 1.069-.42 1.16-.99l.048-.248.919-5.832.059-.32c.09-.572.582-.992 1.16-.992h.73c4.729 0 8.431-1.92 9.513-7.476.452-2.321.218-4.259-.978-5.622a4.667 4.667 0 0 0-1.336-1.03z" />
                                            <path fill="#222D65"
                                                d="M21.754 7.151a9.757 9.757 0 0 0-1.203-.267 15.284 15.284 0 0 0-2.426-.177h-7.352a1.172 1.172 0 0 0-1.159.992L8.05 17.605l-.045.289a1.336 1.336 0 0 1 1.321-1.132h2.752c5.405 0 9.637-2.195 10.874-8.545.037-.188.068-.371.096-.55a6.594 6.594 0 0 0-1.017-.429 9.045 9.045 0 0 0-.277-.087z" />
                                            <path fill="#253B80"
                                                d="M9.614 7.699a1.169 1.169 0 0 1 1.159-.991h7.352c.871 0 1.684.057 2.426.177a9.757 9.757 0 0 1 1.481.353c.365.121.704.264 1.017.429.368-2.347-.003-3.945-1.272-5.392C20.378.682 17.853 0 14.622 0h-9.38c-.66 0-1.223.48-1.325 1.133L.01 25.898a.806.806 0 0 0 .795.932h5.791l1.454-9.225 1.564-9.906z" />
                                        </svg>
                                    </div>
                                    <div class="payment-method-name">PayPal</div>
                                    <div class="payment-method-desc">Fast & Secure</div>
                                </button>
                            </div>
                        </div>

                        <!-- Stripe Card Form -->
                        <div class="funds-section" id="stripeSection">
                            <h3 class="funds-section-title">
                                <span class="section-icon">🔒</span>
                                Card Information
                            </h3>

                            <form id="stripePaymentForm">
                                <div class="form-group">
                                    <label class="form-label">Card Details</label>
                                    <div id="card-element" class="stripe-card-element">
                                        <!-- Stripe Card Element will be inserted here -->
                                    </div>
                                    <div id="card-errors" class="card-errors"></div>
                                </div>

                                <div class="security-badges">
                                    <div class="security-badge">
                                        <span>🔒</span>
                                        <span>256-bit SSL Encrypted</span>
                                    </div>
                                    <div class="security-badge">
                                        <span>✓</span>
                                        <span>PCI DSS Compliant</span>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- PayPal Container -->
                        <div class="funds-section" id="paypalSection" style="display: none;">
                            <h3 class="funds-section-title">
                                <span class="section-icon">🔒</span>
                                Complete Payment
                            </h3>

                            <div id="paypal-button-container"></div>

                            <div class="security-badges">
                                <div class="security-badge">
                                    <span>🔒</span>
                                    <span>Buyer Protection</span>
                                </div>
                                <div class="security-badge">
                                    <span>✓</span>
                                    <span>Secure Checkout</span>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Summary -->
                        <div class="payment-summary">
                            <div class="summary-row">
                                <span class="summary-label">Amount to Add:</span>
                                <span class="summary-value" id="summaryAmount">$0.00</span>
                            </div>
                            <div class="summary-row">
                                <span class="summary-label">Processing Fee:</span>
                                <span class="summary-value" id="summaryFee">$0.00</span>
                            </div>
                            <div class="summary-row total">
                                <span class="summary-label">Total:</span>
                                <span class="summary-value" id="summaryTotal">$0.00</span>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="form-actions" id="stripeActions">
                            <button type="button" class="btn-secondary" onclick="closeAddFundsModal()">
                                Cancel
                            </button>
                            <button type="button" class="btn-primary" id="submitPaymentBtn"
                                onclick="processStripePayment()" disabled>
                                <span id="paymentBtnText">Add Funds</span>
                                <span id="paymentBtnSpinner" class="spinner" style="display: none;"></span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Campaign Creation Modal -->
        <div class="modal-overlay" id="campaignModal">
            <div class="campaign-modal">
                <div class="modal-header">
                    <button class="modal-close" onclick="closeCampaignModal()">×</button>
                    <h2 class="modal-title">Create New Campaign</h2>
                    <p class="modal-subtitle">Set up your advertising campaign in just a few simple steps</p>
                </div>

                <div class="modal-content">
                    <form id="campaignForm">
                        <!-- Basic Information -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon">📋</span>
                                Campaign Details
                            </h3>

                            <div class="form-group">
                                <label class="form-label">Campaign Name *</label>
                                <input type="text" class="form-input" name="campaignName"
                                    placeholder="Enter campaign name" required>
                            </div>

                            <!-- UPDATED: Multiple URLs Section -->
                            <div class="form-group">
                                <label class="form-label">Landing Page URLs *</label>
                                <div id="urlsContainer">
                                    <div class="url-input-group">
                                        <input type="text" class="form-input url-input"
                                            placeholder="website.com, www.website.com, https://website.com"
                                            onchange="validateAndNormalizeURL(this)">
                                        <button type="button" class="btn-icon" onclick="removeURLInput(this)"
                                            style="display: none;">
                                            🗑️
                                        </button>
                                    </div>
                                </div>
                                <button type="button" class="btn-secondary-small" onclick="addURLInput()"
                                    style="margin-top: 12px;">
                                    ➕ Add Another URL
                                </button>
                                <span class="form-hint">You can add multiple landing page URLs. Pricing adjusts per
                                    URL.</span>
                                <div id="urlError"
                                    style="color: #dc2626; font-size: 13px; margin-top: 8px; display: none;"></div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Campaign Type *</label>
                                <select class="form-input form-select" name="campaignType" required>
                                    <option value="">Select campaign type</option>
                                    <option value="cpc">CPC - Cost Per Click</option>
                                    <option value="cpm">CPM - Cost Per Mille</option>
                                    <option value="cpa">CPA - Cost Per Action</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Campaign Description</label>
                                <textarea class="form-input form-textarea" name="description"
                                    placeholder="Describe your campaign objectives..."></textarea>
                            </div>
                        </div>

                        <!-- UPDATED: Traffic Selection with new packages -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon">🚀</span>
                                Select Traffic Package
                            </h3>

                            <div class="traffic-packages">
                                <!-- 5K Package -->
                                <div class="traffic-package" data-amount="5000" data-cpm="18"
                                    onclick="selectPackage(this)">
                                    <div class="package-amount">5K</div>
                                    <div class="package-price">$90</div>
                                    <div class="package-cpm">$18.00 CPM</div>
                                    <div class="package-features">
                                        <div class="package-feature">
                                            <span class="feature-check">✓</span>
                                            <span>Basic targeting</span>
                                        </div>
                                        <div class="package-feature">
                                            <span class="feature-check">✓</span>
                                            <span>Mobile & Desktop</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- 10K Package - Most Popular -->
                                <div class="traffic-package popular" data-amount="10000" data-cpm="15"
                                    onclick="selectPackage(this)">
                                    <div class="package-amount">10K</div>
                                    <div class="package-price">$150</div>
                                    <div class="package-cpm">$15.00 CPM</div>
                                    <div class="package-features">
                                        <div class="package-feature">
                                            <span class="feature-check">✓</span>
                                            <span>Advanced targeting</span>
                                        </div>
                                        <div class="package-feature">
                                            <span class="feature-check">✓</span>
                                            <span>Priority support</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- 20K Package -->
                                <div class="traffic-package" data-amount="20000" data-cpm="12"
                                    onclick="selectPackage(this)">
                                    <div class="package-amount">20K</div>
                                    <div class="package-price">$240</div>
                                    <div class="package-cpm">$12.00 CPM</div>
                                    <div class="package-features">
                                        <div class="package-feature">
                                            <span class="feature-check">✓</span>
                                            <span>Premium targeting</span>
                                        </div>
                                        <div class="package-feature">
                                            <span class="feature-check">✓</span>
                                            <span>Dedicated manager</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Custom Package -->
                                <div class="traffic-package" data-amount="custom" data-cpm="0"
                                    onclick="selectPackage(this)">
                                    <div class="package-amount">Custom</div>
                                    <div class="package-price">Custom</div>
                                    <div class="package-cpm">Tiered CPM</div>
                                    <div class="package-features">
                                        <div class="package-feature">
                                            <span class="feature-check">✓</span>
                                            <span>Custom solution</span>
                                        </div>
                                        <div class="package-feature">
                                            <span class="feature-check">✓</span>
                                            <span>Flexible pricing</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- UPDATED: Custom Traffic Input with tiered pricing info -->
                            <div class="custom-traffic" id="customTrafficSection">
                                <div class="traffic-calculator">
                                    <div class="form-group">
                                        <label class="form-label">Traffic Amount</label>
                                        <input type="number" class="form-input" id="customAmount"
                                            placeholder="Enter impressions" min="1000" step="1000"
                                            oninput="calculateCustomPrice()">
                                    </div>
                                    <div style="text-align: center; color: #64748b; font-size: 24px;">×</div>
                                    <div class="calc-result">
                                        <div class="calc-label">Estimated Cost</div>
                                        <div class="calc-value" id="customPrice">$0</div>
                                        <div class="calc-label" style="font-size: 11px; margin-top: 4px;"
                                            id="customCPM">CPM: $0</div>
                                    </div>
                                </div>
                                <div
                                    style="background: rgba(45, 78, 245, 0.05); padding: 16px; border-radius: 12px; margin-top: 16px;">
                                    <p style="font-size: 13px; font-weight: 600; color: #171C6B; margin-bottom: 8px;">📊
                                        Tiered CPM Pricing:</p>
                                    <p style="font-size: 13px; color: #64748b; margin-bottom: 4px;">• 0 - 5,000:
                                        <strong>$18.00 CPM</strong>
                                    </p>
                                    <p style="font-size: 13px; color: #64748b; margin-bottom: 4px;">• 5,001 - 10,000:
                                        <strong>$15.00 CPM</strong>
                                    </p>
                                    <p style="font-size: 13px; color: #64748b;">• 10,000+: <strong>$12.00 CPM</strong>
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Targeting Options -->
                        <div class="form-section">
                            <h3 class="section-title-modal">
                                <span class="section-icon">🎯</span>
                                Targeting Options
                            </h3>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                <div class="form-group">
                                    <label class="form-label">Target Countries</label>
                                    <select class="form-input form-select" name="targetCountries">
                                        <option value="">All Countries</option>
                                        <option value="us">United States</option>
                                        <option value="uk">United Kingdom</option>
                                        <option value="ca">Canada</option>
                                        <option value="au">Australia</option>
                                        <option value="de">Germany</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Device Type</label>
                                    <select class="form-input form-select" name="deviceType">
                                        <option value="all">All Devices</option>
                                        <option value="mobile">Mobile Only</option>
                                        <option value="desktop">Desktop Only</option>
                                        <option value="tablet">Tablet Only</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
    <label class="form-label">Campaign Duration</label>
    <select class="form-input form-select" name="campaignDuration" onchange="updateSummary()">
        <option value="7">7 Days</option>
        <option value="14">14 Days</option>
        <option value="30" selected>30 Days</option>
        <option value="60">60 Days</option>
        <option value="custom">Custom Duration</option>
    </select>
</div>
                        </div>

                        <!-- UPDATED: Campaign Summary with URL count -->
                        <!-- Campaign Summary -->
<div class="campaign-summary">
    <h3 class="summary-title">Campaign Summary</h3>
    <div class="summary-row">
        <span class="summary-label">Selected Package:</span>
        <span class="summary-value" id="summaryPackage">Please select a package</span>
    </div>
    <div class="summary-row">
        <span class="summary-label">Traffic Amount:</span>
        <span class="summary-value" id="summaryAmount">0 impressions</span>
    </div>
    <div class="summary-row">
        <span class="summary-label">Number of URLs:</span>
        <span class="summary-value" id="summaryURLCount">1 URL</span>
    </div>
    <div class="summary-row">
        <span class="summary-label">Cost per URL:</span>
        <span class="summary-value" id="summaryCostPerURL">$0.00</span>
    </div>
    <div class="summary-row">
        <span class="summary-label">Campaign Duration:</span>
        <span class="summary-value" id="summaryDuration">30 days</span>
    </div>
    <div class="summary-row">
        <span class="summary-label">Total Investment:</span>
        <span class="summary-value" id="summaryTotal">$0.00</span>
    </div>
</div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn-secondary" onclick="closeCampaignModal()">
                                Cancel
                            </button>
                            <button type="submit" class="btn-primary" disabled id="submitBtn">
                                <span id="submitBtnText">Create Campaign</span>
                                <span id="submitBtnSpinner" class="spinner" style="display: none;"></span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_BASE = window.location.origin + '/api';

        // Global variables
        let selectedPackage = null;
        let campaigns = [];
        let userStats = {};
        let currentUser = null;
        let authToken = null;
        let campaignURLs = [];
        // Initialize application
        document.addEventListener('DOMContentLoaded', function () {
            initializeApp();
        });

        async function initializeApp() {
            // Check authentication first
            const isAuthenticated = await checkAuthentication();

            if (!isAuthenticated) {
                redirectToLogin();
                return;
            }

            // Hide auth check and show dashboard
            document.getElementById('authCheck').style.display = 'none';
            document.getElementById('mainDashboard').style.display = 'block';

            // Initialize dashboard
            await loadUserStats();
            await loadCampaigns();
            initializeNavigation();
            initializeAnimations();
            updateUserInterface();
            setGreeting();
        }

        // Authentication Functions
        async function checkAuthentication() {
            try {
                authToken = localStorage.getItem('authToken');
                const userData = localStorage.getItem('userData');

                if (!authToken || !userData) {
                    return false;
                }

                currentUser = JSON.parse(userData);

                // Verify token with server
                const response = await apiCall('/auth/me');
                if (response.success) {
                    currentUser = response.user;
                    localStorage.setItem('userData', JSON.stringify(currentUser));
                    return true;
                }

                return false;
            } catch (error) {
                console.error('Authentication check failed:', error);
                // Clear invalid auth data
                localStorage.removeItem('authToken');
                localStorage.removeItem('userData');
                return false;
            }
        }
        function validateAndNormalizeURL(input) {
            let url = input.value.trim();

            if (!url) {
                input.classList.remove('valid', 'invalid');
                updateSummary();
                return null;
            }

            // Remove any existing protocol
            url = url.replace(/^(https?:\/\/)?(www\.)?/, '');

            // Basic domain validation
            const domainPattern = /^[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?(\/.*)?$/;

            if (!domainPattern.test(url)) {
                input.classList.add('invalid');
                input.classList.remove('valid');
                document.getElementById('urlError').textContent = 'Invalid URL format. Please enter a valid domain.';
                document.getElementById('urlError').style.display = 'block';
                updateSummary();
                return null;
            }

            // Normalize URL - add https://
            const normalizedURL = 'https://' + url;

            // Update input with normalized URL
            input.value = normalizedURL;
            input.classList.add('valid');
            input.classList.remove('invalid');
            document.getElementById('urlError').style.display = 'none';

            updateSummary();
            return normalizedURL;
        }
        function addURLInput() {
            const container = document.getElementById('urlsContainer');
            const urlInputGroup = document.createElement('div');
            urlInputGroup.className = 'url-input-group';
            urlInputGroup.innerHTML = `
        <input type="text" class="form-input url-input" 
               placeholder="website.com, www.website.com, https://website.com" 
               onchange="validateAndNormalizeURL(this)">
        <button type="button" class="btn-icon" onclick="removeURLInput(this)">
            🗑️
        </button>
    `;
            container.appendChild(urlInputGroup);

            // Show remove buttons if more than 1 URL
            updateRemoveButtons();
            updateCampaignURLs();
            updateSummary();
        }

        function redirectToLogin() {
            showToast('Authentication Required', 'Please log in to access the dashboard', 'error');
            setTimeout(() => {
                window.location.href = '/';
            }, 2000);
        }

        function updateUserInterface() {
            if (!currentUser) return;

            // Update user info in header
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('welcomeUserName').textContent = currentUser.name.split(' ')[0];
            document.getElementById('userBalance').textContent = `Balance: $${(currentUser.balance || 0).toFixed(2)} USD`;

            // Update user avatar (first letter of name)
            const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
            document.getElementById('userAvatar').textContent = initials;
        }

        function setGreeting() {
            const hour = new Date().getHours();
            let greeting = 'Good evening';

            if (hour < 12) {
                greeting = 'Good morning';
            } else if (hour < 18) {
                greeting = 'Good afternoon';
            }

            document.getElementById('greeting').textContent = greeting;
        }
        function removeURLInput(button) {
            const container = document.getElementById('urlsContainer');
            const urlGroup = button.parentElement;

            // Don't remove if it's the last one
            if (container.children.length > 1) {
                urlGroup.remove();
                updateRemoveButtons();
                updateCampaignURLs();
                updateSummary();
            }
        }
        function updateRemoveButtons() {
            const container = document.getElementById('urlsContainer');
            const removeButtons = container.querySelectorAll('.btn-icon');

            if (container.children.length === 1) {
                removeButtons.forEach(btn => btn.style.display = 'none');
            } else {
                removeButtons.forEach(btn => btn.style.display = 'block');
            }
        }
        function updateCampaignURLs() {
    const urlInputs = document.querySelectorAll('.url-input');
    const validUrls = [];
    
    urlInputs.forEach(input => {
        const url = input.value.trim();
        if (url && input.classList.contains('valid')) {
            validUrls.push(url);
        }
    });

    // Remove duplicates
    campaignURLs = [...new Set(validUrls)];
    
    console.log('Updated campaign URLs:', campaignURLs);
    
    return campaignURLs;
}


        // API Functions with Authentication
        async function apiCall(endpoint, options = {}) {
            try {
                const headers = {
                    'Content-Type': 'application/json',
                    ...options.headers
                };

                // Add authorization header if token exists
                if (authToken) {
                    headers['Authorization'] = `Bearer ${authToken}`;
                }

                const response = await fetch(`${API_BASE}${endpoint}`, {
                    headers,
                    ...options
                });

                if (response.status === 401) {
                    // Token expired or invalid
                    localStorage.removeItem('authToken');
                    localStorage.removeItem('userData');
                    redirectToLogin();
                    throw new Error('Authentication expired');
                }

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                return await response.json();
            } catch (error) {
                console.error('API call failed:', error);
                if (error.message !== 'Authentication expired') {
                    showToast('API Error', 'Failed to communicate with server', 'error');
                }
                throw error;
            }
        }

        async function loadUserStats() {
            try {
                const response = await apiCall('/user/stats');
                userStats = response;
                updateStatsDisplay(response);
            } catch (error) {
                console.error('Failed to load user stats:', error);
            }
        }

        function updateStatsDisplay(stats) {
            document.getElementById('activeCampaigns').textContent = stats.activeCampaigns || 0;
            document.getElementById('totalImpressions').textContent = stats.totalImpressions?.toLocaleString() || '0';
            document.getElementById('totalClicks').textContent = stats.totalClicks?.toLocaleString() || '0';
            document.getElementById('totalInvestment').textContent = `$${stats.totalSpent || '0.00'}`;
            document.getElementById('avgCTR').textContent = stats.avgCTR || '0.00%';
        }

        async function loadCampaigns() {
            const campaignsLoading = document.getElementById('campaignsLoading');
            const noCampaigns = document.getElementById('noCampaigns');
            const campaignsList = document.getElementById('campaignsList');

            campaignsLoading.style.display = 'block';
            noCampaigns.style.display = 'none';
            campaignsList.innerHTML = '';

            try {
                const response = await apiCall('/campaigns');
                campaigns = response.campaigns || [];

                campaignsLoading.style.display = 'none';

                if (campaigns.length === 0) {
                    noCampaigns.style.display = 'block';
                } else {
                    displayCampaigns(campaigns);
                }
            } catch (error) {
                campaignsLoading.style.display = 'none';
                console.error('Failed to load campaigns:', error);
            }
        }

        function displayCampaigns(campaignList) {
            const campaignsList = document.getElementById('campaignsList');
            campaignsList.innerHTML = '';

            campaignList.forEach(campaign => {
                const campaignCard = createCampaignCard(campaign);
                campaignsList.appendChild(campaignCard);
            });
        }

        function createCampaignCard(campaign) {
    const card = document.createElement('div');
    card.className = 'campaign-card';

    const statusClass = `status-${campaign.status}`;
    const statusText = campaign.status.charAt(0).toUpperCase() + campaign.status.slice(1);

    // Handle multiple URLs display
    let urlsDisplay = '';
    if (campaign.landingUrls && campaign.landingUrls.length > 0) {
        if (campaign.landingUrls.length === 1) {
            // Single URL - display normally
            urlsDisplay = `<a href="${campaign.landingUrls[0]}" target="_blank" class="campaign-url">${campaign.landingUrls[0]}</a>`;
        } else {
            // Multiple URLs - display with hover tooltip
            urlsDisplay = `
                <div class="campaign-urls">
                    <span class="campaign-url">${campaign.landingUrls.length} URLs (hover to view)</span>
                    <div class="campaign-urls-tooltip">
                        ${campaign.landingUrls.map(url => 
                            `<a href="${url}" target="_blank">${url}</a>`
                        ).join('')}
                    </div>
                </div>
            `;
        }
    } else {
        urlsDisplay = '<span class="campaign-url" style="color: #94a3b8;">No URL specified</span>';
    }

    card.innerHTML = `
        <div class="campaign-header">
            <div>
                <div class="campaign-name">${campaign.campaignName}</div>
                ${urlsDisplay}
            </div>
            <div class="status-badge ${statusClass}">${statusText}</div>
        </div>
        
        <div class="campaign-stats">
            <div class="stat-box">
                <div class="stat-box-value">${campaign.stats.impressions.toLocaleString()}</div>
                <div class="stat-box-label">Impressions</div>
            </div>
            <div class="stat-box">
                <div class="stat-box-value">${campaign.stats.clicks.toLocaleString()}</div>
                <div class="stat-box-label">Clicks</div>
            </div>
            <div class="stat-box">
                <div class="stat-box-value">$${campaign.stats.spent.toFixed(2)}</div>
                <div class="stat-box-label">Spent</div>
            </div>
            <div class="stat-box">
                <div class="stat-box-value">${campaign.stats.ctr}%</div>
                <div class="stat-box-label">CTR</div>
            </div>
        </div>
        
        <div class="campaign-actions">
            <button class="action-btn" onclick="viewCampaign('${campaign._id}')">View</button>
            ${campaign.status === 'active' ?
                `<button class="action-btn" onclick="pauseCampaign('${campaign._id}')">Pause</button>` :
                campaign.status === 'paused' ?
                    `<button class="action-btn" onclick="resumeCampaign('${campaign._id}')">Resume</button>` : ''
            }
            <button class="action-btn danger" onclick="deleteCampaign('${campaign._id}')">Delete</button>
        </div>
    `;

    return card;
}
        async function createCampaign(campaignData) {
            try {
                const response = await apiCall('/campaigns', {
                    method: 'POST',
                    body: JSON.stringify(campaignData)
                });

                if (response.success) {
                    showToast('Success!', 'Campaign created successfully and will be activated shortly.', 'success');
                    await loadUserStats();
                    await loadCampaigns();
                    return response;
                }
            } catch (error) {
                showToast('Error', 'Failed to create campaign. Please try again.', 'error');
                throw error;
            }
        }

        async function updateCampaignStatus(campaignId, status) {
            try {
                const response = await apiCall(`/campaigns/${campaignId}/status`, {
                    method: 'PATCH',
                    body: JSON.stringify({ status })
                });

                if (response.success) {
                    showToast('Success!', `Campaign ${status} successfully.`, 'success');
                    await loadUserStats();
                    await loadCampaigns();
                }
            } catch (error) {
                showToast('Error', `Failed to ${status} campaign.`, 'error');
            }
        }

        async function removeCampaign(campaignId) {
            try {
                const response = await apiCall(`/campaigns/${campaignId}`, {
                    method: 'DELETE'
                });

                if (response.success) {
                    showToast('Success!', 'Campaign deleted successfully.', 'success');
                    await loadUserStats();
                    await loadCampaigns();
                }
            } catch (error) {
                showToast('Error', 'Failed to delete campaign.', 'error');
            }
        }

        // User menu functions
        function toggleUserMenu() {
            const menu = document.getElementById('userDropdownMenu');
            menu.classList.toggle('active');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function (e) {
            const dropdown = document.querySelector('.user-dropdown');
            const menu = document.getElementById('userDropdownMenu');

            if (!dropdown.contains(e.target)) {
                menu.classList.remove('active');
            }
        });

        async function logout() {
            try {
                await apiCall('/auth/logout', { method: 'POST' });
            } catch (error) {
                console.error('Logout API call failed:', error);
            }

            // Clear local storage
            localStorage.removeItem('authToken');
            localStorage.removeItem('userData');

            // Show logout message and redirect
            showToast('Logged Out', 'You have been successfully logged out.', 'success');

            setTimeout(() => {
                window.location.href = '/';
            }, 1500);
        }

        // Campaign Actions
        async function viewCampaign(campaignId) {
            const campaign = campaigns.find(c => c._id === campaignId);

            if (!campaign) {
                showToast('Error', 'Campaign not found', 'error');
                return;
            }

            // Format URLs for display
            let urlsDisplay = '';
            if (campaign.landingUrls && campaign.landingUrls.length > 0) {
                urlsDisplay = campaign.landingUrls.map((url, index) =>
                    `${index + 1}. ${url}`
                ).join('\n');
            } else {
                urlsDisplay = 'No URLs specified';
            }

            // Format package details
            const packageInfo = campaign.trafficPackage || {};
            const impressionsPerURL = packageInfo.impressions || 0;
            const totalImpressions = impressionsPerURL * (packageInfo.urlCount || 1);
            const pricePerURL = packageInfo.pricePerURL || 0;
            const totalPrice = packageInfo.totalPrice || 0;

            // Create detailed view
            const details = `
📊 CAMPAIGN DETAILS

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📌 BASIC INFORMATION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Campaign Name: ${campaign.campaignName}
Type: ${campaign.campaignType.toUpperCase()}
Status: ${campaign.status.charAt(0).toUpperCase() + campaign.status.slice(1)}
Created: ${new Date(campaign.createdAt).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            })}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔗 LANDING PAGE URLs (${campaign.landingUrls?.length || 0})
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

${urlsDisplay}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📦 TRAFFIC PACKAGE
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Package Type: ${packageInfo.amount === 'custom' ? 'Custom Package' : `${(impressionsPerURL / 1000)}K Package`}
Impressions per URL: ${impressionsPerURL.toLocaleString()}
Total Impressions: ${totalImpressions.toLocaleString()}
Number of URLs: ${packageInfo.urlCount || 1}
CPM Rate: $${(packageInfo.cpm || 0).toFixed(2)}
Cost per URL: $${pricePerURL.toFixed(2)}
Total Investment: $${totalPrice.toFixed(2)}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 TARGETING
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Countries: ${campaign.targeting?.targetCountries || 'All Countries'}
Device Type: ${campaign.targeting?.deviceType || 'All Devices'}
Duration: ${campaign.targeting?.campaignDuration || '30'} days

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📈 PERFORMANCE STATISTICS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Impressions: ${campaign.stats.impressions.toLocaleString()}
Clicks: ${campaign.stats.clicks.toLocaleString()}
CTR: ${campaign.stats.ctr}%
Spent: $${campaign.stats.spent.toFixed(2)}
Remaining Budget: $${(totalPrice - campaign.stats.spent).toFixed(2)}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 DESCRIPTION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

${campaign.description || 'No description provided'}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    `.trim();

            alert(details);
        }


        async function pauseCampaign(campaignId) {
            if (confirm('Are you sure you want to pause this campaign?')) {
                await updateCampaignStatus(campaignId, 'paused');
            }
        }
        async function viewCampaignModal(campaignId) {
            const campaign = campaigns.find(c => c._id === campaignId);

            if (!campaign) {
                showToast('Error', 'Campaign not found', 'error');
                return;
            }

            // Create modal HTML
            const packageInfo = campaign.trafficPackage || {};
            const impressionsPerURL = packageInfo.impressions || 0;
            const totalImpressions = impressionsPerURL * (packageInfo.urlCount || 1);
            const pricePerURL = packageInfo.pricePerURL || 0;
            const totalPrice = packageInfo.totalPrice || 0;

            let urlsList = '';
            if (campaign.landingUrls && campaign.landingUrls.length > 0) {
                urlsList = campaign.landingUrls.map((url, index) =>
                    `<li><a href="${url}" target="_blank">${url}</a></li>`
                ).join('');
            } else {
                urlsList = '<li>No URLs specified</li>';
            }

            const modalHTML = `
        <div class="modal-overlay active" id="viewCampaignModal" onclick="closeViewCampaignModal(event)">
            <div class="campaign-modal campaign-details-modal" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <button class="modal-close" onclick="closeViewCampaignModal()">×</button>
                    <h2 class="modal-title">${campaign.campaignName}</h2>
                    <p class="modal-subtitle">Campaign Details</p>
                </div>
                
                <div class="modal-content" style="max-height: 60vh; overflow-y: auto;">
                    <div class="settings-card" style="margin-bottom: 16px;">
                        <div class="settings-card-header">
                            <h3 class="settings-card-title">Basic Information</h3>
                        </div>
                        <div class="settings-card-body">
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="info-label">Campaign Type</span>
                                    <span class="info-value">${campaign.campaignType.toUpperCase()}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Status</span>
                                    <span class="info-value">
                                        <span class="status-badge status-${campaign.status}">
                                            ${campaign.status.charAt(0).toUpperCase() + campaign.status.slice(1)}
                                        </span>
                                    </span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Created</span>
                                    <span class="info-value">${new Date(campaign.createdAt).toLocaleDateString()}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Duration</span>
                                    <span class="info-value">${campaign.targeting?.campaignDuration || '30'} days</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-card" style="margin-bottom: 16px;">
                        <div class="settings-card-header">
                            <h3 class="settings-card-title">Landing Page URLs (${campaign.landingUrls?.length || 0})</h3>
                        </div>
                        <div class="settings-card-body">
                            <ul class="campaign-urls-list">${urlsList}</ul>
                        </div>
                    </div>
                    
                    <div class="settings-card" style="margin-bottom: 16px;">
                        <div class="settings-card-header">
                            <h3 class="settings-card-title">Traffic Package</h3>
                        </div>
                        <div class="settings-card-body">
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="info-label">Package Type</span>
                                    <span class="info-value">${packageInfo.amount === 'custom' ? 'Custom' : `${(impressionsPerURL / 1000)}K`}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Impressions per URL</span>
                                    <span class="info-value">${impressionsPerURL.toLocaleString()}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Total Impressions</span>
                                    <span class="info-value">${totalImpressions.toLocaleString()}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">CPM Rate</span>
                                    <span class="info-value">$${(packageInfo.cpm || 0).toFixed(2)}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Cost per URL</span>
                                    <span class="info-value">$${pricePerURL.toFixed(2)}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Total Investment</span>
                                    <span class="info-value">$${totalPrice.toFixed(2)}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-card" style="margin-bottom: 16px;">
                        <div class="settings-card-header">
                            <h3 class="settings-card-title">Performance</h3>
                        </div>
                        <div class="settings-card-body">
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="info-label">Impressions</span>
                                    <span class="info-value">${campaign.stats.impressions.toLocaleString()}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Clicks</span>
                                    <span class="info-value">${campaign.stats.clicks.toLocaleString()}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">CTR</span>
                                    <span class="info-value">${campaign.stats.ctr}%</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Spent</span>
                                    <span class="info-value">$${campaign.stats.spent.toFixed(2)}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    ${campaign.description ? `
                    <div class="settings-card">
                        <div class="settings-card-header">
                            <h3 class="settings-card-title">Description</h3>
                        </div>
                        <div class="settings-card-body">
                            <p style="color: #64748b; line-height: 1.6;">${campaign.description}</p>
                        </div>
                    </div>
                    ` : ''}
                </div>
            </div>
        </div>
    `;

            // Remove existing modal if any
            const existingModal = document.getElementById('viewCampaignModal');
            if (existingModal) {
                existingModal.remove();
            }

            // Add modal to page
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            document.body.style.overflow = 'hidden';
        }

        function closeViewCampaignModal(event) {
            if (event && event.target.id !== 'viewCampaignModal') return;

            const modal = document.getElementById('viewCampaignModal');
            if (modal) {
                modal.remove();
                document.body.style.overflow = '';
            }
        }

        // Use the modal version by default
        async function viewCampaign(campaignId) {
            viewCampaignModal(campaignId);
        }

        async function resumeCampaign(campaignId) {
            await updateCampaignStatus(campaignId, 'active');
        }

        async function deleteCampaign(campaignId) {
            if (confirm('Are you sure you want to delete this campaign? This action cannot be undone.')) {
                await removeCampaign(campaignId);
            }
        }

        async function refreshCampaigns() {
            await loadCampaigns();
            showToast('Refreshed!', 'Campaigns data has been updated.', 'success');
        }

        // Navigation
        function initializeNavigation() {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function () {
                    switchTab(this.dataset.tab);
                });
            });
        }

        function switchTab(tabName) {
            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            const activeTab = document.querySelector(`[data-tab="${tabName}"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }

            // Show/hide sections
            document.getElementById('dashboard-section').style.display = tabName === 'dashboard' ? 'block' : 'none';
            document.getElementById('my-campaigns-section').style.display = tabName === 'my-campaigns' ? 'block' : 'none';
            document.getElementById('analytics-section').style.display = tabName === 'analytics' ? 'block' : 'none';
            document.getElementById('settings-section').style.display = tabName === 'settings' ? 'block' : 'none';

            // Load data when switching tabs
            if (tabName === 'my-campaigns') {
                loadCampaigns();
            } else if (tabName === 'analytics') {
                loadAnalytics();
            } else if (tabName === 'settings') {
                loadSettingsData();
            }
        }

        // Campaign Modal Functions
       function openCampaignModal() {
    document.getElementById('campaignModal').classList.add('active');
    document.body.style.overflow = 'hidden';
    
    // Trigger initial summary update
    setTimeout(() => {
        updateSummary();
    }, 100);
}

        function closeCampaignModal() {
    document.getElementById('campaignModal').classList.remove('active');
    document.body.style.overflow = '';

    // Reset form
    document.getElementById('campaignForm').reset();
    selectedPackage = null;
    campaignURLs = [];

    // Reset URL inputs
    const container = document.getElementById('urlsContainer');
    container.innerHTML = `
        <div class="url-input-group">
            <input type="text" class="form-input url-input" 
                   placeholder="website.com, www.website.com, https://website.com" 
                   onchange="validateAndNormalizeURL(this)">
            <button type="button" class="btn-icon" onclick="removeURLInput(this)" style="display: none;">
                🗑️
            </button>
        </div>
    `;

    document.querySelectorAll('.traffic-package').forEach(pkg => pkg.classList.remove('selected'));
    document.getElementById('customTrafficSection').classList.remove('active');
    document.getElementById('customAmount').value = '';
    document.getElementById('urlError').style.display = 'none';

    updateSummary();

    // Reset submit button
    const submitBtn = document.getElementById('submitBtn');
    const submitBtnText = document.getElementById('submitBtnText');
    const submitBtnSpinner = document.getElementById('submitBtnSpinner');
    submitBtn.disabled = true;
    submitBtnText.style.display = 'inline';
    submitBtnSpinner.style.display = 'none';
}

        function selectPackage(element) {
    // Remove previous selection
    document.querySelectorAll('.traffic-package').forEach(pkg => pkg.classList.remove('selected'));

    // Select current package
    element.classList.add('selected');

    const amount = element.dataset.amount;
    const cpm = parseFloat(element.dataset.cpm);

    console.log('Selected package - amount:', amount, 'cpm:', cpm);

    if (amount === 'custom') {
        selectedPackage = { 
            amount: 'custom', 
            cpm: 0, 
            price: 0,
            impressions: 0,
            customAmount: 0,
            avgCPM: 0
        };
        document.getElementById('customTrafficSection').classList.add('active');
        
        // Check if there's already a value in the input
        const customInput = document.getElementById('customAmount');
        if (customInput.value) {
            calculateCustomPrice();
        } else {
            customInput.focus();
            updateSummary();
        }
    } else {
        const impressions = parseInt(amount);
        const price = (impressions / 1000) * cpm;

        selectedPackage = {
            amount: amount,
            impressions: impressions,
            cpm: cpm,
            price: price
        };

        document.getElementById('customTrafficSection').classList.remove('active');
        
        console.log('Selected standard package:', selectedPackage);
        updateSummary();
    }
}

       function calculateCustomPrice() {
    const amountInput = document.getElementById('customAmount');
    const amount = parseInt(amountInput.value) || 0;

    console.log('=== Calculate Custom Price ===');
    console.log('Input amount:', amount);
    console.log('Current selectedPackage:', selectedPackage);

    if (amount < 1000) {
        document.getElementById('customPrice').textContent = '$0';
        document.getElementById('customCPM').textContent = 'CPM: $0';

        if (selectedPackage && selectedPackage.amount === 'custom') {
            selectedPackage.price = 0;
            selectedPackage.customAmount = 0;
            selectedPackage.impressions = 0;
            selectedPackage.avgCPM = 0;
            selectedPackage.cpm = 0;
            
            console.log('Amount < 1000, reset package:', selectedPackage);
        }
        updateSummary();
        return;
    }

    let totalPrice = 0;
    let avgCPM = 0;

    // Tiered pricing calculation
    if (amount <= 5000) {
        totalPrice = (amount / 1000) * 18;
        avgCPM = 18;
    } else if (amount <= 10000) {
        totalPrice = (5000 / 1000) * 18 + ((amount - 5000) / 1000) * 15;
        avgCPM = (totalPrice / amount) * 1000;
    } else {
        totalPrice = (5000 / 1000) * 18 + (5000 / 1000) * 15 + ((amount - 10000) / 1000) * 12;
        avgCPM = (totalPrice / amount) * 1000;
    }

    console.log('Calculated - totalPrice:', totalPrice, 'avgCPM:', avgCPM);

    document.getElementById('customPrice').textContent = `$${totalPrice.toFixed(2)}`;
    document.getElementById('customCPM').textContent = `CPM: $${avgCPM.toFixed(2)}`;

    // Make sure selectedPackage exists and is custom
    if (!selectedPackage || selectedPackage.amount !== 'custom') {
        console.error('selectedPackage is not custom or does not exist!');
        selectedPackage = {
            amount: 'custom',
            cpm: avgCPM,
            price: totalPrice,
            impressions: amount,
            customAmount: amount,
            avgCPM: avgCPM
        };
    } else {
        // Update all properties
        selectedPackage.price = totalPrice;
        selectedPackage.customAmount = amount;
        selectedPackage.impressions = amount;
        selectedPackage.avgCPM = avgCPM;
        selectedPackage.cpm = avgCPM;
    }
    
    console.log('After calculation, selectedPackage:', selectedPackage);
    
    // Force update summary
    updateSummary();
}
     function updateSummary() {
    console.log('=== Update Summary Called ===');
    console.log('selectedPackage:', selectedPackage);
    
    // Use querySelectorAll to get all elements (in case of duplicates)
    const summaryPackageElements = document.querySelectorAll('#summaryPackage, [id="summaryPackage"]');
    const summaryAmountElements = document.querySelectorAll('#summaryAmount, [id="summaryAmount"]');
    const summaryURLCountElements = document.querySelectorAll('#summaryURLCount, [id="summaryURLCount"]');
    const summaryCostPerURLElements = document.querySelectorAll('#summaryCostPerURL, [id="summaryCostPerURL"]');
    const summaryDurationElements = document.querySelectorAll('#summaryDuration, [id="summaryDuration"]');
    const summaryTotalElements = document.querySelectorAll('#summaryTotal, [id="summaryTotal"]');
    const submitBtn = document.getElementById('submitBtn');

    // Log if we found duplicates
    console.log('Found elements:');
    console.log('- summaryAmount elements:', summaryAmountElements.length);
    console.log('- summaryTotal elements:', summaryTotalElements.length);

    // Get campaign duration
    const durationSelect = document.querySelector('select[name="campaignDuration"]');
    const durationValue = durationSelect ? durationSelect.value : '30';
    const durationText = durationValue === 'custom' ? 'Custom' : `${durationValue} days`;
    
    // Update ALL duration elements
    summaryDurationElements.forEach(el => {
        if (el) el.textContent = durationText;
    });

    // Update URL count
    const validURLs = updateCampaignURLs();
    const urlCount = validURLs.length > 0 ? validURLs.length : 1;
    const urlText = `${urlCount} URL${urlCount > 1 ? 's' : ''}`;
    
    // Update ALL URL count elements
    summaryURLCountElements.forEach(el => {
        if (el) el.textContent = urlText;
    });

    if (!selectedPackage) {
        console.log('No package selected');
        summaryPackageElements.forEach(el => { if (el) el.textContent = 'Please select a package'; });
        summaryAmountElements.forEach(el => { if (el) el.textContent = '0 impressions'; });
        summaryCostPerURLElements.forEach(el => { if (el) el.textContent = '$0.00'; });
        summaryTotalElements.forEach(el => { if (el) el.textContent = '$0.00'; });
        if (submitBtn) submitBtn.disabled = true;
        return;
    }

    let impressions = 0;
    let costPerURL = 0;
    let packageName = '';

    if (selectedPackage.amount === 'custom') {
        impressions = selectedPackage.impressions || 0;
        costPerURL = selectedPackage.price || 0;
        packageName = impressions > 0 ? 'Custom Package' : 'Please enter amount';
        
        console.log('Custom package - impressions:', impressions, 'costPerURL:', costPerURL);
    } else {
        impressions = selectedPackage.impressions || 0;
        costPerURL = selectedPackage.price || 0;
        packageName = `${(impressions / 1000).toFixed(0)}K Package`;
        
        console.log('Standard package - impressions:', impressions, 'costPerURL:', costPerURL);
    }

    const totalCost = costPerURL * urlCount;
    const amountText = `${impressions.toLocaleString()} impressions`;
    const costPerURLText = `$${costPerURL.toFixed(2)}`;
    const totalText = `$${totalCost.toFixed(2)}`;

    // Update ALL elements of each type
    summaryPackageElements.forEach(el => {
        if (el) {
            el.textContent = packageName;
            console.log('Updated package element:', el, 'to:', packageName);
        }
    });
    
    summaryAmountElements.forEach(el => {
        if (el) {
            el.textContent = amountText;
            console.log('Updated amount element:', el, 'to:', amountText);
        }
    });
    
    summaryCostPerURLElements.forEach(el => {
        if (el) {
            el.textContent = costPerURLText;
            console.log('Updated cost per URL element:', el, 'to:', costPerURLText);
        }
    });
    
    summaryTotalElements.forEach(el => {
        if (el) {
            el.textContent = totalText;
            console.log('Updated total element:', el, 'to:', totalText);
        }
    });

    console.log('Display updated:');
    console.log('- Package:', packageName);
    console.log('- Amount:', amountText);
    console.log('- Cost per URL:', costPerURLText);
    console.log('- Total:', totalText);

    // Enable button
    const hasValidPackage = impressions >= 1000 && costPerURL > 0;
    const hasValidURL = validURLs.length > 0;
    if (submitBtn) {
        submitBtn.disabled = !(hasValidPackage && hasValidURL);
    }
    
    console.log('Button state - disabled:', submitBtn?.disabled, '(hasValidPackage:', hasValidPackage, 'hasValidURL:', hasValidURL, ')');
}
        // // Form submission
        // document.getElementById('campaignForm').addEventListener('submit', async function (e) {
        //     e.preventDefault();

        //     // Validate URLs
        //     updateCampaignURLs();

        //     if (campaignURLs.length === 0) {
        //         showToast('Error', 'Please enter at least one valid landing page URL', 'error');
        //         return;
        //     }

        //     if (!selectedPackage) {
        //         showToast('Error', 'Please select a traffic package', 'error');
        //         return;
        //     }

        //     const submitBtn = document.getElementById('submitBtn');
        //     const submitBtnText = document.getElementById('submitBtnText');
        //     const submitBtnSpinner = document.getElementById('submitBtnSpinner');

        //     // Show loading state
        //     submitBtn.disabled = true;
        //     submitBtnText.style.display = 'none';
        //     submitBtnSpinner.style.display = 'inline-block';

        //     try {
        //         // Collect form data
        //         const formData = new FormData(this);
        //         const urlCount = campaignURLs.length;
        //         const costPerURL = selectedPackage.price || 0;
        //         const totalCost = costPerURL * urlCount;

        //         const campaignData = {
        //             campaignName: formData.get('campaignName'),
        //             landingUrls: campaignURLs, // Multiple URLs
        //             campaignType: formData.get('campaignType'),
        //             package: {
        //                 amount: selectedPackage.amount,
        //                 impressions: selectedPackage.impressions || selectedPackage.customAmount,
        //                 cpm: selectedPackage.cpm || selectedPackage.avgCPM,
        //                 pricePerURL: costPerURL,
        //                 totalPrice: totalCost,
        //                 urlCount: urlCount
        //             },
        //             description: formData.get('description'),
        //             targetCountries: formData.get('targetCountries'),
        //             deviceType: formData.get('deviceType'),
        //             duration: formData.get('campaignDuration')
        //         };

        //         // Validate required fields
        //         if (!campaignData.campaignName || !campaignData.campaignType) {
        //             showToast('Error', 'Please fill in all required fields', 'error');
        //             return;
        //         }

        //         // Create campaign
        //         await createCampaign(campaignData);
        //         closeCampaignModal();

        //     } catch (error) {
        //         console.error('Campaign creation failed:', error);
        //     } finally {
        //         // Reset loading state
        //         submitBtn.disabled = false;
        //         submitBtnText.style.display = 'inline';
        //         submitBtnSpinner.style.display = 'none';
        //     }
        // });


        // Utility Functions
        function showToast(title, message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-title">${title}</div>
                <div class="toast-message">${message}</div>
            `;

            document.body.appendChild(toast);

            // Show toast
            setTimeout(() => toast.classList.add('show'), 100);

            // Hide toast after 4 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 4000);
        }

        function fillProfile() {
            switchTab('settings');
            switchSettingsTab('profile');
        }

        function topUpAccount() {
            alert('💳 Account Funding\n\nAdd funds securely:\n• Credit/Debit cards\n• Bank transfers\n• Cryptocurrency\n• Minimum $100 deposit');
        }

        function expandHelp(element) {
            const question = element.querySelector('.faq-question').textContent;
            alert(`📚 Knowledge Base\n\n"${question}"\n\nThis would open comprehensive guides, tutorials, and best practices for this topic.`);
        }

        // Initialize animations
        function initializeAnimations() {
            const animateElements = document.querySelectorAll('.animate-in');
            animateElements.forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(30px)';

                setTimeout(() => {
                    el.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, index * 150);
            });
        }

        // Enhanced Navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', function () {
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Close modal on escape key
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                closeCampaignModal();
                document.getElementById('userDropdownMenu').classList.remove('active');
            }
        });

        // Close modal on overlay click
        document.getElementById('campaignModal').addEventListener('click', function (e) {
            if (e.target === this) {
                closeCampaignModal();
            }
        });

        /* ==========================================================================
           MOBILE JAVASCRIPT FUNCTIONALITY
           ========================================================================== */

        // Mobile Navigation System
        function initMobileNavigation() {
            // Create mobile menu elements
            const header = document.querySelector('.header-content');
            const userSection = document.querySelector('.user-section');

            // Add mobile toggle button
            const mobileToggle = document.createElement('button');
            mobileToggle.className = 'mobile-menu-toggle';
            mobileToggle.innerHTML = '☰';
            mobileToggle.setAttribute('aria-label', 'Toggle mobile menu');

            // Insert toggle before user section
            userSection.parentNode.insertBefore(mobileToggle, userSection);

            // Create mobile overlay and menu
            const mobileOverlay = document.createElement('div');
            mobileOverlay.className = 'mobile-nav-overlay';

            const mobileMenu = document.createElement('div');
            mobileMenu.className = 'mobile-nav-menu';

            const closeButton = document.createElement('button');
            closeButton.className = 'mobile-nav-close';
            closeButton.innerHTML = '×';
            closeButton.setAttribute('aria-label', 'Close mobile menu');

            // Advertiser navigation  
            const advertiserNavs = [
                { text: 'Dashboard', active: true, tab: 'dashboard' },
                { text: 'Create Campaign', action: 'campaign' },
                { text: 'My Campaigns', tab: 'my-campaigns' },
                { text: 'Analytics', tab: 'analytics' },
                { text: 'Settings', tab: 'settings' }
            ];

            let menuHTML = '';
            advertiserNavs.forEach(nav => {
                menuHTML += `<a href="#" class="mobile-nav-item ${nav.active ? 'active' : ''}" data-tab="${nav.tab || ''}" data-action="${nav.action || ''}">${nav.text}</a>`;
            });

            mobileMenu.innerHTML = menuHTML;
            mobileMenu.insertBefore(closeButton, mobileMenu.firstChild);

            // Add to DOM
            document.body.appendChild(mobileOverlay);
            document.body.appendChild(mobileMenu);

            // Event listeners
            mobileToggle.addEventListener('click', openMobileMenu);
            closeButton.addEventListener('click', closeMobileMenu);
            mobileOverlay.addEventListener('click', closeMobileMenu);

            // Handle mobile nav item clicks
            const mobileNavItems = document.querySelectorAll('.mobile-nav-item');
            mobileNavItems.forEach(item => {
                item.addEventListener('click', handleMobileNavClick);
            });

            function openMobileMenu() {
                mobileOverlay.classList.add('active');
                mobileMenu.classList.add('active');
                document.body.style.overflow = 'hidden';
                mobileToggle.innerHTML = '×';
            }

            function closeMobileMenu() {
                mobileOverlay.classList.remove('active');
                mobileMenu.classList.remove('active');
                document.body.style.overflow = '';
                mobileToggle.innerHTML = '☰';
            }

            function handleMobileNavClick(e) {
                e.preventDefault();

                // Remove active class from all items
                mobileNavItems.forEach(item => item.classList.remove('active'));
                // Add active class to clicked item
                e.target.classList.add('active');

                // Close menu
                closeMobileMenu();

                // Handle navigation logic
                const tab = e.target.dataset.tab;
                const action = e.target.dataset.action;

                if (action === 'campaign') {
                    openCampaignModal();
                } else if (tab) {
                    switchTab(tab);
                }
            }

            // Handle escape key
            document.addEventListener('keydown', function (e) {
                if (e.key === 'Escape') {
                    closeMobileMenu();
                }
            });

            // Handle window resize
            window.addEventListener('resize', function () {
                if (window.innerWidth > 1024) {
                    closeMobileMenu();
                }
            });
        }

        // Initialize mobile functionality
        function initMobileDashboard() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function () {
                    initMobileNavigation();
                });
            } else {
                initMobileNavigation();
            }
        }

        // Start mobile initialization
        initMobileDashboard();

        // Auto-refresh stats every 30 seconds
        setInterval(async () => {
            try {
                await loadUserStats();
            } catch (error) {
                console.log('Auto-refresh failed:', error.message);
            }
        }, 30000);

        // Check for authentication periodically
        setInterval(async () => {
            try {
                const isAuthenticated = await checkAuthentication();
                if (!isAuthenticated) {
                    showToast('Session Expired', 'Your session has expired. Please log in again.', 'error');
                    setTimeout(() => {
                        redirectToLogin();
                    }, 2000);
                }
            } catch (error) {
                console.log('Auth check failed:', error.message);
            }
        }, 300000); // Check every 5 minutes
        /* ==========================================================================
   ANALYTICS FUNCTIONS
   ========================================================================== */

        let performanceChart = null;
        let deviceChart = null;
        let timeChart = null;

        // Mock data generator for analytics
        function generateAnalyticsData() {
            const activeCampaigns = campaigns.filter(c => c.status === 'active');

            // Calculate real stats from campaigns
            const totalImpressions = campaigns.reduce((sum, c) => sum + (c.stats?.impressions || 0), 0);
            const totalClicks = campaigns.reduce((sum, c) => sum + (c.stats?.clicks || 0), 0);
            const totalSpent = campaigns.reduce((sum, c) => sum + (c.stats?.spent || 0), 0);
            const avgCTR = totalImpressions > 0 ? ((totalClicks / totalImpressions) * 100).toFixed(2) : 0;

            // Generate mock revenue (2-3x of spent for profit simulation)
            const revenue = totalSpent * (2.5 + Math.random() * 0.5);

            return {
                overview: {
                    revenue: revenue,
                    revenueChange: 12.5 + Math.random() * 10,
                    impressions: totalImpressions,
                    impressionsChange: 8.3 + Math.random() * 10,
                    clicks: totalClicks,
                    clicksChange: 15.2 + Math.random() * 10,
                    avgCTR: avgCTR,
                    ctrChange: 5.7 + Math.random() * 5
                },
                performance: generatePerformanceTrend(),
                devices: generateDeviceData(),
                geo: generateGeoData(),
                time: generateTimeData()
            };
        }

        function generatePerformanceTrend() {
            const days = 30;
            const labels = [];
            const impressions = [];
            const clicks = [];
            const revenue = [];

            for (let i = days; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));

                // Generate trending data
                const baseImpressions = 1000 + Math.random() * 500;
                const growth = (days - i) / days; // Growth over time
                impressions.push(Math.floor(baseImpressions * (1 + growth * 0.5)));
                clicks.push(Math.floor(impressions[impressions.length - 1] * (0.02 + Math.random() * 0.01)));
                revenue.push(parseFloat((clicks[clicks.length - 1] * (2 + Math.random() * 1)).toFixed(2)));
            }

            return { labels, impressions, clicks, revenue };
        }

        function generateDeviceData() {
            return {
                labels: ['Mobile', 'Desktop', 'Tablet'],
                data: [55 + Math.random() * 10, 30 + Math.random() * 10, 10 + Math.random() * 5]
            };
        }

        function generateGeoData() {
            const countries = [
                { name: 'United States', code: 'US', flag: '🇺🇸' },
                { name: 'United Kingdom', code: 'GB', flag: '🇬🇧' },
                { name: 'Canada', code: 'CA', flag: '🇨🇦' },
                { name: 'Australia', code: 'AU', flag: '🇦🇺' },
                { name: 'Germany', code: 'DE', flag: '🇩🇪' }
            ];

            return countries.map(country => ({
                ...country,
                impressions: Math.floor(5000 + Math.random() * 10000),
                clicks: Math.floor(100 + Math.random() * 500),
                percentage: 15 + Math.random() * 20
            })).sort((a, b) => b.impressions - a.impressions);
        }

        function generateTimeData() {
            const hours = [];
            const traffic = [];

            for (let i = 0; i < 24; i++) {
                hours.push(`${i}:00`);
                // Simulate peak hours (9-17)
                const isPeak = i >= 9 && i <= 17;
                const base = isPeak ? 800 : 300;
                traffic.push(Math.floor(base + Math.random() * (isPeak ? 400 : 200)));
            }

            return { hours, traffic };
        }

        // Load and display analytics
        async function loadAnalytics() {
            try {
                // Ensure campaigns are loaded
                if (campaigns.length === 0) {
                    await loadCampaigns();
                }

                const analyticsData = generateAnalyticsData();

                // Update overview cards
                updateAnalyticsOverview(analyticsData.overview);

                // Create/update charts
                createPerformanceChart(analyticsData.performance);
                createDeviceChart(analyticsData.devices);
                createTimeChart(analyticsData.time);

                // Update geographic data
                updateGeoList(analyticsData.geo);

                // Update campaign table
                updateCampaignAnalyticsTable();

            } catch (error) {
                console.error('Failed to load analytics:', error);
                showToast('Error', 'Failed to load analytics data', 'error');
            }
        }

        function updateAnalyticsOverview(overview) {
            document.getElementById('analyticsRevenue').textContent = `$${overview.revenue.toFixed(2)}`;
            document.getElementById('revenueChange').textContent = `+${overview.revenueChange.toFixed(1)}%`;

            document.getElementById('analyticsImpressions').textContent = overview.impressions.toLocaleString();
            document.getElementById('impressionsChange').textContent = `+${overview.impressionsChange.toFixed(1)}%`;

            document.getElementById('analyticsClicks').textContent = overview.clicks.toLocaleString();
            document.getElementById('clicksChange').textContent = `+${overview.clicksChange.toFixed(1)}%`;

            document.getElementById('analyticsAvgCTR').textContent = `${overview.avgCTR}%`;
            document.getElementById('ctrChange').textContent = `+${overview.ctrChange.toFixed(1)}%`;
        }

        function createPerformanceChart(data) {
            const ctx = document.getElementById('performanceChart');

            if (performanceChart) {
                performanceChart.destroy();
            }

            performanceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'Impressions',
                            data: data.impressions,
                            borderColor: '#2d4ef5',
                            backgroundColor: 'rgba(45, 78, 245, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Clicks',
                            data: data.clicks,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0,
                            pointHoverRadius: 6
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: { size: 13, weight: '600' }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#171C6B',
                            bodyColor: '#64748b',
                            borderColor: 'rgba(23, 28, 107, 0.1)',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true,
                            callbacks: {
                                label: function (context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(23, 28, 107, 0.05)' },
                            ticks: {
                                font: { size: 12 },
                                color: '#64748b',
                                callback: function (value) {
                                    return value.toLocaleString();
                                }
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: {
                                font: { size: 12 },
                                color: '#64748b',
                                maxRotation: 45,
                                minRotation: 0
                            }
                        }
                    }
                }
            });
        }

        function createDeviceChart(data) {
            const ctx = document.getElementById('deviceChart');

            if (deviceChart) {
                deviceChart.destroy();
            }

            deviceChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: data.labels,
                    datasets: [{
                        data: data.data,
                        backgroundColor: [
                            '#2d4ef5',
                            '#10b981',
                            '#f59e0b'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: { size: 13, weight: '600' }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#171C6B',
                            bodyColor: '#64748b',
                            borderColor: 'rgba(23, 28, 107, 0.1)',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function (context) {
                                    return context.label + ': ' + context.parsed.toFixed(1) + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        function createTimeChart(data) {
            const ctx = document.getElementById('timeChart');

            if (timeChart) {
                timeChart.destroy();
            }

            timeChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.hours,
                    datasets: [{
                        label: 'Traffic',
                        data: data.traffic,
                        backgroundColor: 'rgba(45, 78, 245, 0.8)',
                        borderRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#171C6B',
                            bodyColor: '#64748b',
                            borderColor: 'rgba(23, 28, 107, 0.1)',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function (context) {
                                    return 'Visits: ' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(23, 28, 107, 0.05)' },
                            ticks: {
                                font: { size: 12 },
                                color: '#64748b'
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: {
                                font: { size: 11 },
                                color: '#64748b',
                                maxRotation: 90,
                                minRotation: 45
                            }
                        }
                    }
                }
            });
        }
        function testSummaryUpdate() {
    console.log('=== Testing Summary Update ===');
    console.log('Selected Package:', selectedPackage);
    console.log('Campaign URLs:', campaignURLs);
    
    updateCampaignURLs();
    updateSummary();
    
    console.log('After update - URLs:', campaignURLs);
    console.log('Submit button disabled:', document.getElementById('submitBtn').disabled);
}

        function updateGeoList(geoData) {
            const geoList = document.getElementById('geoList');
            geoList.innerHTML = '';

            geoData.forEach(country => {
                const geoItem = document.createElement('div');
                geoItem.className = 'geo-item';
                geoItem.innerHTML = `
            <div class="geo-flag">${country.flag}</div>
            <div class="geo-details">
                <div class="geo-country">${country.name}</div>
                <div class="geo-stats">${country.impressions.toLocaleString()} impressions • ${country.clicks.toLocaleString()} clicks</div>
            </div>
            <div class="geo-bar">
                <div class="geo-bar-fill" style="width: ${country.percentage}%"></div>
            </div>
        `;
                geoList.appendChild(geoItem);
            });
        }

        function updateCampaignAnalyticsTable() {
            const tableBody = document.getElementById('analyticsTableBody');
            tableBody.innerHTML = '';

            if (campaigns.length === 0) {
                tableBody.innerHTML = `
            <tr>
                <td colspan="8" style="text-align: center; padding: 40px; color: #64748b;">
                    No campaign data available
                </td>
            </tr>
        `;
                return;
            }

            campaigns.forEach(campaign => {
                const impressions = campaign.stats?.impressions || 0;
                const clicks = campaign.stats?.clicks || 0;
                const spent = campaign.stats?.spent || 0;
                const ctr = impressions > 0 ? ((clicks / impressions) * 100).toFixed(2) : '0.00';
                const cpm = impressions > 0 ? ((spent / impressions) * 1000).toFixed(2) : '0.00';
                const cpc = clicks > 0 ? (spent / clicks).toFixed(2) : '0.00';

                const statusClass = `status-${campaign.status}`;
                const statusText = campaign.status.charAt(0).toUpperCase() + campaign.status.slice(1);

                const row = document.createElement('tr');
                row.innerHTML = `
            <td>
                <div class="table-campaign-name">${campaign.campaignName}</div>
                <div class="table-metric-secondary">${campaign.campaignType.toUpperCase()}</div>
            </td>
            <td><span class="status-badge ${statusClass}">${statusText}</span></td>
            <td class="table-metric">${impressions.toLocaleString()}</td>
            <td class="table-metric">${clicks.toLocaleString()}</td>
            <td class="table-metric">${ctr}%</td>
            <td class="table-metric">$${spent.toFixed(2)}</td>
            <td class="table-metric">$${cpm}</td>
            <td class="table-metric">$${cpc}</td>
        `;
                tableBody.appendChild(row);
            });
        }

        function updatePerformanceChart() {
            const period = document.getElementById('performancePeriod').value;
            // In a real app, you would fetch data for the selected period
            // For now, we'll just regenerate with the same data
            const performanceData = generatePerformanceTrend();
            createPerformanceChart(performanceData);
        }

        function exportAnalytics() {
            // Create CSV content
            let csvContent = "Campaign,Status,Impressions,Clicks,CTR,Spent,CPM,CPC\n";

            campaigns.forEach(campaign => {
                const impressions = campaign.stats?.impressions || 0;
                const clicks = campaign.stats?.clicks || 0;
                const spent = campaign.stats?.spent || 0;
                const ctr = impressions > 0 ? ((clicks / impressions) * 100).toFixed(2) : '0.00';
                const cpm = impressions > 0 ? ((spent / impressions) * 1000).toFixed(2) : '0.00';
                const cpc = clicks > 0 ? (spent / clicks).toFixed(2) : '0.00';

                csvContent += `"${campaign.campaignName}",${campaign.status},${impressions},${clicks},${ctr}%,$${spent},$${cpm},$${cpc}\n`;
            });

            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `analytics-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);

            showToast('Success!', 'Analytics data exported successfully', 'success');
        }
        /* ==========================================================================
   SETTINGS FUNCTIONS
   ========================================================================== */

        // Switch between settings tabs
        function switchSettingsTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.settings-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-settings-tab="${tabName}"]`).classList.add('active');

            // Update panels
            document.querySelectorAll('.settings-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.getElementById(`${tabName}-settings`).classList.add('active');

            // Load specific data
            if (tabName === 'profile') {
                loadProfileData();
            } else if (tabName === 'security') {
                loadSecurityData();
            } else if (tabName === 'billing') {
                loadBillingData();
            }
        }

        // Load Settings Data
        function loadSettingsData() {
            if (!currentUser) return;

            // Load profile data
            loadProfileData();
            loadSecurityData();
            loadNotificationSettings();
            loadBillingData();
        }
        function goToProfileSettings() {
            // Close the dropdown menu
            document.getElementById('userDropdownMenu').classList.remove('active');

            // Switch to settings tab and profile section
            switchTab('settings');
            switchSettingsTab('profile');
        }

        function loadProfileData() {
            if (!currentUser) return;

            document.getElementById('profileName').value = currentUser.name || '';
            document.getElementById('profileEmail').value = currentUser.email || '';
            document.getElementById('profileCompany').value = currentUser.profile?.company || '';
            document.getElementById('profilePhone').value = currentUser.profile?.phone || '';
            document.getElementById('profileCountry').value = currentUser.profile?.country || '';

            // Update profile photo
            const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
            document.getElementById('profilePhotoText').textContent = initials;

            // Account info
            document.getElementById('accountType').textContent = currentUser.userType.charAt(0).toUpperCase() + currentUser.userType.slice(1);
            document.getElementById('memberSince').textContent = new Date(currentUser.createdAt).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('lastLogin').textContent = new Date(currentUser.lastLogin).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Update Profile
        async function updateProfile(event) {
            event.preventDefault();

            const submitBtn = event.target.querySelector('button[type="submit"]');
            const saveText = document.getElementById('profileSaveText');
            const saveSpinner = document.getElementById('profileSaveSpinner');

            submitBtn.disabled = true;
            saveText.style.display = 'none';
            saveSpinner.style.display = 'inline-block';

            try {
                const profileData = {
                    name: document.getElementById('profileName').value,
                    company: document.getElementById('profileCompany').value,
                    phone: document.getElementById('profilePhone').value,
                    country: document.getElementById('profileCountry').value
                };

                const response = await apiCall('/auth/profile', {
                    method: 'PUT',
                    body: JSON.stringify(profileData)
                });

                if (response.success) {
                    currentUser = response.user;
                    localStorage.setItem('userData', JSON.stringify(currentUser));
                    updateUserInterface();
                    showToast('Success!', 'Profile updated successfully', 'success');
                }
            } catch (error) {
                showToast('Error', 'Failed to update profile', 'error');
            } finally {
                submitBtn.disabled = false;
                saveText.style.display = 'inline';
                saveSpinner.style.display = 'none';
            }
        }

        function resetProfileForm() {
            loadProfileData();
            showToast('Cancelled', 'Changes have been discarded', 'success');
        }

        function changeProfilePhoto() {
            showToast('Coming Soon', 'Photo upload feature will be available soon', 'success');
        }

        // Security Functions
        function loadSecurityData() {
            // Load active sessions
            const sessionsList = document.getElementById('sessionsList');
            sessionsList.innerHTML = `
        <div class="session-item">
            <div class="session-info">
                <div class="session-device">💻</div>
                <div class="session-details">
                    <h4>Chrome on Windows <span class="session-current">Current</span></h4>
                    <p>Karachi, Pakistan • Last active: Now</p>
                </div>
            </div>
        </div>
        <div class="session-item">
            <div class="session-info">
                <div class="session-device">📱</div>
                <div class="session-details">
                    <h4>Safari on iPhone</h4>
                    <p>Karachi, Pakistan • Last active: 2 hours ago</p>
                </div>
            </div>
            <button class="btn-text danger" onclick="terminateSession('2')">Revoke</button>
        </div>
    `;
        }

        async function changePassword(event) {
            event.preventDefault();

            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            // Validate
            if (newPassword !== confirmPassword) {
                showToast('Error', 'New passwords do not match', 'error');
                return;
            }

            if (newPassword.length < 6) {
                showToast('Error', 'Password must be at least 6 characters', 'error');
                return;
            }

            const submitBtn = event.target.querySelector('button[type="submit"]');
            const saveText = document.getElementById('passwordSaveText');
            const saveSpinner = document.getElementById('passwordSaveSpinner');

            submitBtn.disabled = true;
            saveText.style.display = 'none';
            saveSpinner.style.display = 'inline-block';

            try {
                // Simulate API call (you'd implement this in your backend)
                await new Promise(resolve => setTimeout(resolve, 1500));

                showToast('Success!', 'Password changed successfully', 'success');
                resetPasswordForm();
            } catch (error) {
                showToast('Error', 'Failed to change password', 'error');
            } finally {
                submitBtn.disabled = false;
                saveText.style.display = 'inline';
                saveSpinner.style.display = 'none';
            }
        }

        function resetPasswordForm() {
            document.getElementById('passwordForm').reset();
            document.getElementById('passwordStrengthFill').style.width = '0%';
            document.getElementById('passwordStrengthText').textContent = 'Enter a password';
        }

        // Password strength checker
        document.addEventListener('DOMContentLoaded', function () {
            const newPasswordInput = document.getElementById('newPassword');
            if (newPasswordInput) {
                newPasswordInput.addEventListener('input', function () {
                    const password = this.value;
                    const strengthFill = document.getElementById('passwordStrengthFill');
                    const strengthText = document.getElementById('passwordStrengthText');

                    if (!password) {
                        strengthFill.style.width = '0%';
                        strengthText.textContent = 'Enter a password';
                        return;
                    }

                    let strength = 0;
                    let feedback = [];

                    // Length check
                    if (password.length >= 6) strength += 20;
                    if (password.length >= 8) strength += 10;
                    if (password.length >= 12) strength += 10;

                    // Character variety
                    if (/[a-z]/.test(password)) strength += 15;
                    if (/[A-Z]/.test(password)) strength += 15;
                    if (/[0-9]/.test(password)) strength += 15;
                    if (/[^a-zA-Z0-9]/.test(password)) strength += 15;

                    // Update UI
                    strengthFill.style.width = strength + '%';

                    if (strength < 40) {
                        strengthFill.style.background = '#dc2626';
                        strengthText.textContent = 'Weak password';
                    } else if (strength < 70) {
                        strengthFill.style.background = '#f59e0b';
                        strengthText.textContent = 'Medium strength';
                    } else {
                        strengthFill.style.background = '#10b981';
                        strengthText.textContent = 'Strong password';
                    }
                });
            }
        });

        function toggle2FA(checkbox) {
            if (checkbox.checked) {
                showToast('2FA Enabled', 'Two-factor authentication has been enabled', 'success');
            } else {
                showToast('2FA Disabled', 'Two-factor authentication has been disabled', 'success');
            }
        }

        function terminateSession(sessionId) {
            if (confirm('Are you sure you want to revoke this session?')) {
                showToast('Success!', 'Session terminated successfully', 'success');
                loadSecurityData();
            }
        }

        // Notification Settings
        function loadNotificationSettings() {
            // Load from localStorage or use defaults
            const settings = JSON.parse(localStorage.getItem('notificationSettings') || '{}');

            document.getElementById('notifCampaigns').checked = settings.campaigns !== false;
            document.getElementById('notifPerformance').checked = settings.performance !== false;
            document.getElementById('notifBudget').checked = settings.budget !== false;
            document.getElementById('notifWeekly').checked = settings.weekly || false;
            document.getElementById('notifMarketing').checked = settings.marketing || false;
        }

        function saveNotificationSettings() {
            const settings = {
                campaigns: document.getElementById('notifCampaigns').checked,
                performance: document.getElementById('notifPerformance').checked,
                budget: document.getElementById('notifBudget').checked,
                weekly: document.getElementById('notifWeekly').checked,
                marketing: document.getElementById('notifMarketing').checked
            };

            localStorage.setItem('notificationSettings', JSON.stringify(settings));
            showToast('Saved!', 'Notification preferences updated', 'success');
        }

        function togglePushNotifications(checkbox) {
            if (checkbox.checked) {
                if ('Notification' in window) {
                    Notification.requestPermission().then(permission => {
                        if (permission === 'granted') {
                            showToast('Enabled!', 'Push notifications enabled', 'success');
                        } else {
                            checkbox.checked = false;
                            showToast('Denied', 'Please allow notifications in your browser', 'error');
                        }
                    });
                } else {
                    checkbox.checked = false;
                    showToast('Not Supported', 'Your browser does not support notifications', 'error');
                }
            } else {
                showToast('Disabled', 'Push notifications disabled', 'success');
            }
        }

        // Billing Functions
        function loadBillingData() {
            document.getElementById('settingsBalance').textContent = `$${(currentUser?.balance || 0).toFixed(2)}`;
            document.getElementById('totalSpentBilling').textContent = `$${userStats.totalSpent || '0.00'}`;
            document.getElementById('activeCampaignsBilling').textContent = userStats.activeCampaigns || 0;
        }

        function showAddFundsModal() {
            const amount = prompt('Enter amount to add (minimum $100):');
            if (amount && parseFloat(amount) >= 100) {
                showToast('Processing', 'Redirecting to payment gateway...', 'success');
                setTimeout(() => {
                    showToast('Success!', `$${amount} added to your account`, 'success');
                    // In real app, process payment here
                }, 2000);
            } else if (amount) {
                showToast('Error', 'Minimum deposit amount is $100', 'error');
            }
        }

        function addPaymentMethod() {
            showToast('Coming Soon', 'Payment method management will be available soon', 'success');
        }

        function removePaymentMethod(id) {
            if (confirm('Are you sure you want to remove this payment method?')) {
                showToast('Success!', 'Payment method removed', 'success');
            }
        }

        // API Functions
        function toggleAPIKey(elementId, fullKey) {
            const element = document.getElementById(elementId);
            if (element.textContent.includes('•')) {
                element.textContent = fullKey;
            } else {
                element.textContent = '••••••••••••••••••••••••••••';
            }
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied!', 'API key copied to clipboard', 'success');
            }).catch(() => {
                showToast('Error', 'Failed to copy to clipboard', 'error');
            });
        }

        function generateNewAPIKey() {
            if (confirm('Generate a new API key? This will create a new key for your account.')) {
                const newKey = 'pk_live_' + Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
                showToast('Generated!', 'New API key created successfully', 'success');
            }
        }

        function revokeAPIKey(id) {
            if (confirm('Are you sure you want to revoke this API key? Applications using this key will stop working.')) {
                showToast('Revoked', 'API key has been revoked', 'success');
            }
        }

        function openAPIDoc(docType) {
            const docs = {
                quickstart: 'Quick Start Guide - Learn how to integrate our API in minutes',
                reference: 'API Reference - Complete documentation of all endpoints',
                examples: 'Code Examples - Sample implementations in various languages',
                webhooks: 'Webhooks Guide - Set up real-time event notifications'
            };

            alert(`📚 ${docs[docType]}\n\nThis would open the ${docType} documentation in a new window.`);
        }

        function addWebhook() {
            const url = prompt('Enter webhook URL:');
            if (url) {
                showToast('Success!', 'Webhook endpoint added', 'success');
            }
        }
        /* ==========================================================================
   ADD FUNDS FUNCTIONALITY
   ========================================================================== */

        // Initialize Stripe (use your publishable key)
        const stripe = Stripe('pk_test_51234567890abcdefghijklmnopqrstuvwxyz1234567890'); // Replace with your actual Stripe publishable key
        let cardElement = null;
        let selectedAmount = 0;
        let selectedPaymentMethod = 'stripe';

        // Show Add Funds Modal
        function showAddFundsModal() {
            document.getElementById('addFundsModal').classList.add('active');
            document.body.style.overflow = 'hidden';

            // Initialize Stripe Elements if not already initialized
            if (!cardElement) {
                initializeStripeElements();
            }

            // Reset selections
            selectedAmount = 0;
            selectedPaymentMethod = 'stripe';
            updatePaymentSummary();
        }

        // Close Add Funds Modal
        function closeAddFundsModal() {
            document.getElementById('addFundsModal').classList.remove('active');
            document.body.style.overflow = '';

            // Reset form
            resetAddFundsForm();
        }

        // Initialize Stripe Elements
        function initializeStripeElements() {
            const elements = stripe.elements();

            // Create card element
            cardElement = elements.create('card', {
                style: {
                    base: {
                        fontSize: '16px',
                        color: '#171C6B',
                        fontFamily: '"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',
                        fontWeight: '500',
                        '::placeholder': {
                            color: '#94a3b8',
                        },
                    },
                    invalid: {
                        color: '#dc2626',
                        iconColor: '#dc2626',
                    },
                },
            });

            // Mount card element
            cardElement.mount('#card-element');

            // Handle real-time validation errors
            cardElement.on('change', function (event) {
                const displayError = document.getElementById('card-errors');
                if (event.error) {
                    displayError.textContent = event.error.message;
                } else {
                    displayError.textContent = '';
                }

                // Enable/disable submit button based on card validity
                updateSubmitButton();
            });
        }

        // Select Amount
        function selectAmount(element) {
            // Remove previous selection
            document.querySelectorAll('.amount-card').forEach(card => card.classList.remove('selected'));

            // Select current
            element.classList.add('selected');

            const amount = element.dataset.amount;

            // Show/hide custom input
            const customInput = document.getElementById('customAmountInput');
            if (amount === 'custom') {
                customInput.style.display = 'block';
                selectedAmount = 0;
                document.getElementById('customAmountValue').focus();
            } else {
                customInput.style.display = 'none';
                selectedAmount = parseFloat(amount);
            }

            updatePaymentSummary();
            updateSubmitButton();
        }

        // Validate Custom Amount
        function validateCustomAmount() {
            const input = document.getElementById('customAmountValue');
            const error = document.getElementById('customAmountError');
            const value = parseFloat(input.value);

            if (!value || value < 100) {
                error.textContent = 'Minimum amount is $100';
                error.style.color = '#dc2626';
                selectedAmount = 0;
            } else if (value > 100000) {
                error.textContent = 'Maximum amount is $100,000';
                error.style.color = '#dc2626';
                selectedAmount = 0;
            } else {
                error.textContent = `Amount: $${value.toFixed(2)}`;
                error.style.color = '#059669';
                selectedAmount = value;
            }

            updatePaymentSummary();
            updateSubmitButton();
        }

        // Select Payment Method
        function selectPaymentMethod(element) {
            // Remove previous selection
            document.querySelectorAll('.payment-method-card').forEach(card => card.classList.remove('active'));

            // Select current
            element.classList.add('active');

            selectedPaymentMethod = element.dataset.method;

            // Show/hide payment sections
            if (selectedPaymentMethod === 'stripe') {
                document.getElementById('stripeSection').style.display = 'block';
                document.getElementById('paypalSection').style.display = 'none';
                document.getElementById('stripeActions').style.display = 'flex';
            } else if (selectedPaymentMethod === 'paypal') {
                document.getElementById('stripeSection').style.display = 'none';
                document.getElementById('paypalSection').style.display = 'block';
                document.getElementById('stripeActions').style.display = 'none';

                // Initialize PayPal buttons if amount is selected
                if (selectedAmount >= 100) {
                    initializePayPalButtons();
                }
            }

            updateSubmitButton();
        }

        // Update Payment Summary
        function updatePaymentSummary() {
            const amount = selectedAmount || 0;
            const fee = amount * 0.029 + 0.30; // 2.9% + $0.30 (typical Stripe fee)
            const total = amount + fee;

            document.getElementById('summaryAmount').textContent = `$${amount.toFixed(2)}`;
            document.getElementById('summaryFee').textContent = `$${fee.toFixed(2)}`;
            document.getElementById('summaryTotal').textContent = `$${total.toFixed(2)}`;
        }

        // Update Submit Button State
        function updateSubmitButton() {
            const submitBtn = document.getElementById('submitPaymentBtn');

            if (selectedAmount >= 100 && selectedPaymentMethod === 'stripe') {
                submitBtn.disabled = false;
            } else {
                submitBtn.disabled = true;
            }
        }

        // Process Stripe Payment
        async function processStripePayment() {
            if (selectedAmount < 100) {
                showToast('Error', 'Minimum deposit amount is $100', 'error');
                return;
            }

            const submitBtn = document.getElementById('submitPaymentBtn');
            const btnText = document.getElementById('paymentBtnText');
            const btnSpinner = document.getElementById('paymentBtnSpinner');

            // Show loading state
            submitBtn.disabled = true;
            btnText.style.display = 'none';
            btnSpinner.style.display = 'inline-block';

            try {
                // Create payment intent on your server
                const response = await apiCall('/payments/create-intent', {
                    method: 'POST',
                    body: JSON.stringify({
                        amount: Math.round((selectedAmount + (selectedAmount * 0.029 + 0.30)) * 100), // Convert to cents
                        currency: 'usd',
                        description: 'Account Balance Top-up'
                    })
                });

                if (!response.success) {
                    throw new Error(response.message || 'Failed to create payment intent');
                }

                // Confirm the payment with Stripe
                const { error: stripeError, paymentIntent } = await stripe.confirmCardPayment(
                    response.clientSecret,
                    {
                        payment_method: {
                            card: cardElement,
                            billing_details: {
                                name: currentUser.name,
                                email: currentUser.email,
                            },
                        },
                    }
                );

                if (stripeError) {
                    throw new Error(stripeError.message);
                }

                if (paymentIntent.status === 'succeeded') {
                    // Update balance on server
                    await updateBalanceAfterPayment(selectedAmount, paymentIntent.id, 'stripe');

                    showToast('Success!', `$${selectedAmount.toFixed(2)} added to your account`, 'success');
                    closeAddFundsModal();

                    // Refresh user data
                    await loadUserStats();
                    updateUserInterface();
                    loadBillingData();
                }

            } catch (error) {
                console.error('Payment error:', error);
                showToast('Payment Failed', error.message || 'Please check your card details and try again', 'error');
            } finally {
                submitBtn.disabled = false;
                btnText.style.display = 'inline';
                btnSpinner.style.display = 'none';
            }
        }

        // Initialize PayPal Buttons
        function initializePayPalButtons() {
            // Clear previous buttons
            const container = document.getElementById('paypal-button-container');
            container.innerHTML = '';

            if (!window.paypal) {
                showToast('Error', 'PayPal SDK not loaded', 'error');
                return;
            }

            paypal.Buttons({
                // Set up the transaction
                createOrder: function (data, actions) {
                    const amount = selectedAmount || 0;
                    const fee = amount * 0.029 + 0.30;
                    const total = amount + fee;

                    if (amount < 100) {
                        showToast('Error', 'Minimum deposit amount is $100', 'error');
                        return;
                    }

                    return actions.order.create({
                        purchase_units: [{
                            description: 'TrafficStars Account Balance Top-up',
                            amount: {
                                currency_code: 'USD',
                                value: total.toFixed(2)
                            }
                        }]
                    });
                },

                // Finalize the transaction
                onApprove: async function (data, actions) {
                    try {
                        const order = await actions.order.capture();

                        // Update balance on server
                        await updateBalanceAfterPayment(selectedAmount, order.id, 'paypal');

                        showToast('Success!', `$${selectedAmount.toFixed(2)} added to your account`, 'success');
                        closeAddFundsModal();

                        // Refresh user data
                        await loadUserStats();
                        updateUserInterface();
                        loadBillingData();

                    } catch (error) {
                        console.error('PayPal capture error:', error);
                        showToast('Payment Failed', 'Failed to process PayPal payment', 'error');
                    }
                },

                onError: function (err) {
                    console.error('PayPal error:', err);
                    showToast('Payment Failed', 'PayPal payment was not completed', 'error');
                },

                onCancel: function (data) {
                    showToast('Cancelled', 'PayPal payment was cancelled', 'success');
                },

                style: {
                    layout: 'vertical',
                    color: 'blue',
                    shape: 'rect',
                    label: 'pay',
                    height: 45
                }
            }).render('#paypal-button-container');
        }

        // Update Balance After Payment
        async function updateBalanceAfterPayment(amount, transactionId, method) {
            try {
                const response = await apiCall('/payments/confirm', {
                    method: 'POST',
                    body: JSON.stringify({
                        amount: amount,
                        transactionId: transactionId,
                        paymentMethod: method
                    })
                });

                if (response.success) {
                    // Update local user data
                    currentUser.balance = response.newBalance;
                    localStorage.setItem('userData', JSON.stringify(currentUser));

                    return response;
                } else {
                    throw new Error(response.message || 'Failed to update balance');
                }
            } catch (error) {
                console.error('Balance update error:', error);
                // Don't throw - payment succeeded but balance update failed
                // Show warning instead
                showToast('Warning', 'Payment successful but balance update delayed. Please refresh.', 'error');
            }
        }

        // Reset Add Funds Form
        function resetAddFundsForm() {
            // Clear card element
            if (cardElement) {
                cardElement.clear();
            }

            // Reset selections
            document.querySelectorAll('.amount-card').forEach(card => card.classList.remove('selected'));
            document.querySelectorAll('.payment-method-card').forEach(card => card.classList.remove('active'));
            document.querySelector('[data-method="stripe"]').classList.add('active');

            // Hide custom input
            document.getElementById('customAmountInput').style.display = 'none';
            document.getElementById('customAmountValue').value = '';
            document.getElementById('customAmountError').textContent = '';

            // Reset amounts
            selectedAmount = 0;
            selectedPaymentMethod = 'stripe';
            updatePaymentSummary();

            // Show stripe section
            document.getElementById('stripeSection').style.display = 'block';
            document.getElementById('paypalSection').style.display = 'none';
            document.getElementById('stripeActions').style.display = 'flex';

            // Clear errors
            document.getElementById('card-errors').textContent = '';

            // Disable submit button
            document.getElementById('submitPaymentBtn').disabled = true;
        }

        // Close modal on escape key
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                const addFundsModal = document.getElementById('addFundsModal');
                if (addFundsModal && addFundsModal.classList.contains('active')) {
                    closeAddFundsModal();
                }
            }
        });
        document.addEventListener('DOMContentLoaded', function() {
    const campaignForm = document.getElementById('campaignForm');
    
    if (campaignForm) {
        campaignForm.addEventListener('submit', async function (e) {
            e.preventDefault();
            
            // Validate URLs
            updateCampaignURLs();
            
            if (campaignURLs.length === 0) {
                showToast('Error', 'Please enter at least one valid landing page URL', 'error');
                return;
            }
            
            if (!selectedPackage || !selectedPackage.price) {
                showToast('Error', 'Please select a traffic package', 'error');
                return;
            }
            
            // Additional validation for custom package
            if (selectedPackage.amount === 'custom') {
                if (!selectedPackage.impressions || selectedPackage.impressions < 1000) {
                    showToast('Error', 'Minimum custom amount is 1,000 impressions', 'error');
                    return;
                }
            }
            
            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            const submitBtnSpinner = document.getElementById('submitBtnSpinner');
            
            // Show loading state
            submitBtn.disabled = true;
            submitBtnText.style.display = 'none';
            submitBtnSpinner.style.display = 'inline-block';
            
            try {
                // Collect form data
                const formData = new FormData(this);
                const urlCount = campaignURLs.length;
                const costPerURL = selectedPackage.price || 0;
                const totalCost = costPerURL * urlCount;
                
                const campaignData = {
                    campaignName: formData.get('campaignName'),
                    landingUrls: campaignURLs,
                    campaignType: formData.get('campaignType'),
                    package: {
                        amount: selectedPackage.amount,
                        impressions: selectedPackage.impressions || 0,
                        cpm: selectedPackage.cpm || 0,
                        pricePerURL: costPerURL,
                        totalPrice: totalCost,
                        urlCount: urlCount
                    },
                    description: formData.get('description') || '',
                    targetCountries: formData.get('targetCountries') || '',
                    deviceType: formData.get('deviceType') || 'all',
                    duration: formData.get('campaignDuration') || '30'
                };
                
                // Validate required fields
                if (!campaignData.campaignName || !campaignData.campaignType) {
                    showToast('Error', 'Please fill in all required fields', 'error');
                    return;
                }
                
                console.log('Creating campaign with data:', campaignData);
                
                // Create campaign
                await createCampaign(campaignData);
                closeCampaignModal();
                
            } catch (error) {
                console.error('Campaign creation failed:', error);
                showToast('Error', error.message || 'Failed to create campaign', 'error');
            } finally {
                // Reset loading state
                submitBtn.disabled = false;
                submitBtnText.style.display = 'inline';
                submitBtnSpinner.style.display = 'none';
            }
        });
    }
});

        // Close modal on overlay click
        document.getElementById('addFundsModal')?.addEventListener('click', function (e) {
            if (e.target === this) {
                closeAddFundsModal();
            }
        });
    </script>
</body>

</html>